---
layout: page-fullwidth
title: "The fplot program"
permalink: "/docs/misc/fplot/"
header: no
---
_____________________________________________________________


### _Purpose_
{:.no_toc}

**fplot**{: style="color: blue"} is a general purpose plotting package, with functionality roughly similar to **gnuplot**{: style="color: blue"}.
**fplot**{: style="color: blue"} has its particular strengths and weaknesses; for the Questaal suite it is particularly useful because
it synchronises smoothly with other Questaal executables such as [**plbnds**{: style="color: blue"}](/docs/misc/plbnds)
and [**pldos**{: style="color: blue"}](/docs/misc/pldos/).

Also **fplot**{: style="color: blue"} provides some functionality not readily obtained in **gnuplot**{: style="color: blue"}, e.g.
to determine cyclotron masses, drawing [energy bands with color weights](/docs/misc/plbnds/#example-3), and taking advantage
of the [programming language features](/docs/input/preprocessor) of the Questaal suite.

Tutorials that draw bands or densities-of-states use **fplot**{: style="color: blue"} to build figures.
But [**plbnds**{: style="color: blue"}](/docs/misc/plbnds) and [**pldos**{: style="color: blue"}](/docs/misc/pldos/) will render data generated by
Questaal codes into easily read files, for use by any graphics package.

_____________________________________________________________

### _Table of Contents_
{:.no_toc}
*  Auto generated table of contents
{:toc}

_____________________________________________________________

### _Preliminaries_

**fplot**{: style="color: blue"} is required and is assumed to be in your path.
You will also need a postscript viewer.  This document assumes you are using the apple-style **open**{: style="color: blue"} command to view postscript files.

This manual is written for fplot version 3.50.  To see what version you are using, do:

    $ fplot --version

_____________________________________________________________

### 1. _Introduction_

**fplot**{: style="color: blue"} is mainly designed to draw _xy_ data; it has some capability for contour plots and a very limited ability
for 3D graphics.

**fplot**{: style="color: blue"} is command-line driven and can efficiently generate figures from command-line arguments.  It can also read
arguments from a file script; this is necessary if the figure is complex.  **fplot**{: style="color: blue"} can make full use of the programming
language capability it has for reading input files, both in the script and in data files.

Other programs, especially [plbnds](/docs/misc/plbnds/) and [pldos](/docs/misc/pldos/), make **fplot**{: style="color: blue"}
scripts to make the process of drawing high quality figures of bands very easy and efficient,
with the capability of refining the figure by tuning the autogenerated plotting script.

**fplot**{: style="color: blue"}  will print a synopsis of the commands it knows about by typing

    $ fplot --h

### 2. _Examples_

Section 3 explains the commands **fplot**{: style="color: blue"} will accept.
This section develops a couple of examples to give you an intuitive feel of how the code operates and to set many of the settings you
typically want to control yourself.

#### Example 2.1. &nbsp; plot $$y=20\,x^2\exp(-4x)$$
{::comment}
/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x
{:/comment}

The following will plot this function in the interval (0,2), with the abscissa spaced in intervals of 0.02:

    $ fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02
    $ open fplot.ps

<div onclick="elm = document.getElementById('fig1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig1">{:/}
![Example 2.1](https://lordcephei.github.io/assets/img/fplot1.svg)
{::nomarkdown}</div>{:/}

Some useful points to note:

+ A square box is drawn around the figure.  You can select the width and height of the box; see `-frme` below, or try
  `$ fplot -frme .1,.9,.3,.7 -ord ...`
+ For log scales modify `-frme` with `:lx` or `:ly` or both, e.g.
  `$ fplot -frme:ly 0,1,0,1 -ord ...`
+ By default all four edges of the box are drawn.  You can draw any combination of the four (`-frmt`) or shade the box; e.g.
  `$ fplot -frmt th=6,1,1 -ord ...`  or  `fplot -frmt col=.8,.9,.9,th=0 -ord ...`
+ You can also draw the abscissa and ordinate through some middle point (`-frme:xor` and `-frme:yab`), e.g.
  `$ fplot -frme:xor=.5:yab=.675 0,1,0,1 -ord ...`
+ You have considerable flexibility in controlling major and minor tic marks on the abscissa and ordinate (`-tmx` and `-tmy`), e.g.
  `$ fplot -tmx '.25;1~.02' -tmy '.1:5' -ord ...`
+ There is considerable flexibility in controlling the tic mark numbering, font (`-font`)
  and format (`-fmtnx` and `-fmtny`) of the numbers, whether they are suppressed (`-noxn` and `-noyn`) and where they are placed (`-xn` and `-yn`)
  `$ fplot '-fmtnx:%;2,2d' -fmtny:%e -ord ...`
+ You can control many aspects of the line type (`-lt`), e.g.
  `$ fplot -lt 3,bold=4,col=1,0,0 -ord ...`
+ The abscissa ranges from -0.1 to 2.1; the ordinate from -0.033 to +0.71. They were found automatically by finding the largest and smallest
  values in the frame, and padding the range by 10%.  You can specify the padding (`-pad`) and/or the bounds (`-x` and `-y`), e.g.
  `$ fplot -x .2,.3 -y .3,.6 -p0 -ord ...`

#### Example 2.2. &nbsp; _Charge density contours in Cr_
{::comment}
/docs/misc/fplot/#example-22-nbsp-charge-density-contours-in-cr
{:/comment}

It is usually more convenient to make scripts for fplot, especially when the figure is complex.
This figure shows a contour plot of the charge density of the Cr charge density in (100), (011) plane,
with quality almost good enough for publication in a journal.

In this example commands are read from script _fplot.cr_{: style="color: green"}.
To make this plot you will need to copy the already-prepared charge density contour file [chgd.cr](../../../assets/download/inputfiles/chgd.cr) to your working directory,
and cut and paste the script in the box below to _plot.cr_{: style="color: green"}.

~~~
fplot
  -frme 0,0.5,0,sqrt(0.5) -tmx '1;0' -tmy '1;0' -noxn -noyn
  -x 0,1 -y 0,1
  -con .045,.055 -lt 2,bold=3,col=.4,0,0 chgd.cr
  -con .065,.075 -lt 3,bold=4,col=0,0,0 chgd.cr
  -font h13
  -lblu 0.17,0.556 cc '45'
  -lblu 0.28,0.355 cc '55'
  -font t14
  -lblu .5,-.02 cd 'Charge density in bcc Chromium (10^\{-3} a.u.)'
~~~

Run **fplot**{: style="color: blue"} with

    $ fplot -f plot.cr

<div onclick="elm = document.getElementById('fig2'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig2">{:/}
![Example 2.2](https://lordcephei.github.io/assets/img/fplot2.svg)
{::nomarkdown}</div>{:/}

+ Argument `-f` tells **fplot**{: style="color: blue"} that the next argument
  _fplot.cr_{: style="color: green"} is not a command but a file containing a script.
+ The script file is read through the preprocessor before parsing.  In this case there are no preprocessor directives.
+ Commands inside a script work almost exactly as they do on the command line.
  However, in scripts you have to use **\\{...}** for curly brackets, since a simple **{...}**
  will interpreted by the preprocessor as expressions.  Curly brackets can specify superscripts and subscripts, Greek, bold, italic and symbol fonts.
+ **fplot**{: style="color: blue"} draws constant-density contours at 0.045 and 0.055 because of `-con .045,.055`.
  By splitting up the four contours into a pair of `-con` commands, distinct colours and line types can be drawn.
+ Data is read from _chgd.cr_{: style="color: green"}, which must contain _xy_ data. **fplot**{: style="color: blue"} must be
  told how many rows or columns the data has; here it is specified in the first line of _chgd.cr_{: style="color: green"}.
+ Two of the contour values are labelled (`-lblu`) using Helvetica 13pt font; the figure label uses a 14pt Roman font

_____________________________________________________________

### 3. _fplot manual_
{::comment}
/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x
{:/comment}

This manual is written for fplot version 3.50.

Usage:

<pre>
fplot [-INIT-switches] [-FORMAT-switches] [-DATA-switches] <i>data-file</i> ...
</pre>


**INIT** switches must occur first:

+ **\-\-h | \-\-help**\\
  prints out a help message and exits.
+ **-rot**\\
  rotates frame 90 degrees
+ **-pr#**\\
  set the output verbosity to #
+ **-disp[:lus]**\\
  displays picture in a subshell.
  Option :l or :u or :s draws in landscape, upside-down, seascape.\\
  _Note:_{: style="color: red"} to use this feature you must compile
  **fplot**{: style="color: blue"} with a viewer available your machine.\\
  Customize string **dispfn** near the beginning of **fplot.f**.
+ **-plaintext**\\
  strings have no non-ASCII characters (superscripts, subscripts, etc).
+ **-f <i>script-file</i>**\\
  read remaining arguments from file <i>script-file</i>

**FORMAT** switches govern frame layout and labels:

_Note:_{: style="color: red"} by default, **fplot**{: style="color: blue"} draws a frame around the figure
with tic marks and numbering (see [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x)).
These defaults can be modified with the following switches.

{::comment}

+ **-frme[:lx|:ly|:lxy][:theta=#][:xor=#][:yab=#] &nbsp;_l_,_r_,_b_,_t_**\\
  starts a new frame, in box.  _l_,_r_,_b_,_t_ are left, right, bottom, top in "graphics units."\\
  _Note:_{: style="color: red"} "graphics units" are designed so that 0,1,0,1 makes a square
  box with that fits on a sheet of A4 or American size paper with comfortable margins.


{::nomarkdown}<div>{:/}

&nbsp; Option | Function
&nbsp; :lx       |
&nbsp; :ly       |
&nbsp; :lxy      |
&nbsp; :xor=#    |
&nbsp; :yab=#    |
&nbsp; :theta=#  |

{::nomarkdown}</div>{:/}

{:/comment}

+ **-frme[:lx|:ly|:lxy][:theta=#][:xor=#][:yab=#] &nbsp;_l_,_r_,_b_,_t_**\\
  starts a new frame, in box.  _l_,_r_,_b_,_t_ are left, right, bottom, top in "graphics units."\\
  _Note:_{: style="color: red"} "graphics units" are designed so that 0,1,0,1 makes a square
  box with that fits on a sheet of A4 or American size paper with comfortable margins.
  Options:\\
  + **:lx**          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; draw abscissa on a logarithmic scale.
  + **:ly**          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; draw ordinate on a logarithmic scale.
  + **:lxy**         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       draw both abscissa and ordinate on a logarithmic scale.
  + **:xor=#**       &nbsp;&nbsp;&nbsp;&nbsp;                   draw vertical axis at x=#.
  + **:yab=#**       &nbsp;&nbsp;&nbsp;&nbsp;                   draw horizontal axis at y=#.
  + **:theta=#**     angle between abscissa and ordinate (radians)<br/>

+  -x <i>x</i><sub>1</sub>,<i>x</i><sub>2</sub> \\
    specifies range in abscissa : <i>x</i><sub>1</sub> = left edge, <i>x</i><sub>2</sub> = right edge.\\
    If this switch is not supplied, **fplot**{: style="color: blue"} will make an initial pass through all the data in this frame to determine
    the smallest and largest value to be plotted, and use these numbers for <i>x</i><sub>1</sub> and <i>x</i><sub>2</sub>.
+  -y <i>y</i><sub>1</sub>,<i>y</i><sub>2</sub>\\
    specifies range in ordinate : <i>y</i><sub>1</sub> = bottom edge, <i>x</i><sub>2</sub> = top edge.\\
    If this switch is not supplied, **fplot**{: style="color: blue"} will make an initial pass through all the data in this frame to determine
    the smallest and largest value to be plotted, and use these numbers for <i>y</i><sub>1</sub> and <i>y</i><sub>2</sub>.
+  -p# pads frame boundary
   _Note:_{: style="color: red"} boundaries are stretched by a padding factor, which is 0.1 by default.
    Use `-p0` to suppress padding.


... finish ... when reading data from a file
+ Data is read from _chgd.cr_{: style="color: green"}.  It contains 101 rows and 101 columns; but this is not evident from the file itself.
  The script tells **fplot**{: style="color: blue"} that the file contains 101 columns with `nc -101`; it works out the number of rows from
  the file contents.

_____________________________________________________________

### 4. _Other resources_

See the [plbnds](/docs/misc/plbnds/) and [pldos](/docs/misc/pldos/) manuals.
