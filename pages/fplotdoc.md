---
layout: page-fullwidth
title: "The fplot tool"
permalink: "/docs/misc/fplot/"
header: no
---
_____________________________________________________________


### _Purpose_
{:.no_toc}

**fplot**{: style="color: blue"} is a general purpose plotting package, with functionality roughly similar to **gnuplot**{: style="color: blue"}.
It is a command-line driven tool; you can also supply instructions in a script file.
**fplot**{: style="color: blue"} has its particular strengths and weaknesses, but for the Questaal suite it is particularly useful because
it synchronises smoothly with other Questaal executables such as [**plbnds**{: style="color: blue"}](/docs/misc/plbnds)
and [**pldos**{: style="color: blue"}](/docs/misc/pldos/), and shares a common [data file structure](/docs/misc/fplot/#structure-of-data-files).

Also **fplot**{: style="color: blue"} provides some functionality not readily obtained in **gnuplot**{: style="color: blue"}, e.g.
to determine cyclotron masses, drawing [energy bands with color weights](/docs/misc/plbnds/#example-3), and taking advantage
of the [programming language features](/docs/input/preprocessor) of the Questaal suite.

Tutorials that draw bands or densities-of-states use **fplot**{: style="color: blue"} to build figures.
But [**plbnds**{: style="color: blue"}](/docs/misc/plbnds) and [**pldos**{: style="color: blue"}](/docs/misc/pldos/) will render data generated by
Questaal codes into easy-to-read files [with a simple data format](/docs/misc/fplot/#structure-of-data-files), for use by any graphics package.

_____________________________________________________________

### _Table of Contents_
{:.no_toc}
*  Auto generated table of contents
{:toc}
{::comment}
/docs/misc/fplot/#table-of-contents
{:/comment}

_____________________________________________________________

### _Preliminaries_

**fplot**{: style="color: blue"} is required and is assumed to be in your path.
You will also need a postscript viewer.  This document assumes you are using the apple-style **open**{: style="color: blue"} command to view postscript files.

This manual is written for fplot version 3.50.  To see what version you are using, do:

    $ fplot --version

The final example, [adapting postscript files to other formats]
/docs/misc/fplot/#adapting-postscript-coordinates

_____________________________________________________________

### 1. _Introduction_

**fplot**{: style="color: blue"} is mainly designed to draw _xy_ data; it has some capability for contour plots and a very limited ability
for 3D graphics.

**fplot**{: style="color: blue"} is command-line driven and can efficiently generate figures from command-line arguments.  It can also read
arguments from a file script; this is necessary if the figure is complex.  **fplot**{: style="color: blue"} can make full use of the
[programming language capability](/docs/input/preprocessor) it has for reading input files, in both the script and the data files.

Other programs, especially [plbnds](/docs/misc/plbnds/) and [pldos](/docs/misc/pldos/), make **fplot**{: style="color: blue"}
scripts to make the process of drawing high quality figures of bands very easy and efficient,
with the capability of refining the figure by tuning the autogenerated plotting script.

**fplot**{: style="color: blue"}  will print a synopsis of the command it provides by typing

    $ fplot --h

### 2. _Examples_

This section develops a few examples to provide an intuitive feel for how the tool operates and to illustrate some features.
A systematic description of **fplot**{: style="color: blue"}'s features and arguments is given in the [manual](/docs/misc/fplot/#fplot-manual),
Section 3.

#### Example 2.1. &nbsp; plot &nbsp; $$y=20\,x^2\exp(-4x)$$
{::comment}
/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x
{:/comment}

The following will plot this function in the interval (0,2), with the abscissa spaced in intervals of 0.02:

    $ fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02
    $ open fplot.ps

<div onclick="elm = document.getElementById('fig1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to view the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig1">{:/}
![Example 2.1](https://lordcephei.github.io/assets/img/fplot1.svg)
{::nomarkdown}</div>{:/}

_Notes:_{: style="color: red"}

+ A square box is drawn around the figure.  You can select the width and height of the box; see the [Frames Exercise](/docs/misc/fplot/#things-about-frames) or try\\
  `$ fplot -frme .1,.9,.3,.7 -ord ...`
+ The abscissa ranges from &minus;0.1 to 2.1; the ordinate from &minus;0.033 to +0.71. They were determined automatically by finding the largest and smallest
  values in the frame, and padding the bounds by 10%.  You can [set the bounds](/docs/misc/fplot/#format-switches) (**-x** and/or **-y**) and
  [specify the padding](/docs/misc/fplot/#format-switches) (**-pad**), e.g.\\
  `$ fplot -x .2,.3 -y .3,.6 -p0 -ord ...`
+ For log scales, modify [**-frme**](/docs/misc/fplot/#format-switches) with **:lx** or **:ly** or **:lxy**, e.g.\\
  `$ fplot -frme:ly 0,1,0,1 -ord ...`
+ There is a great deal of flexibility in how the [frame is drawn](/docs/misc/fplot/#format-switches).  See the [Frames Exercise](/docs/misc/fplot/#things-about-frames) for illustrations of the following:
  + By default all four edges of the box are drawn.  You can draw any combination of the four (**-frmt**).
    Or you can draw the abscissa and ordinate through some middle point (**-frme:xor** and **-frme:yab**)
  + You can shade the box (**-frme:col=#,#,#**) or suppress filling (**-frme:nofill**)
  + There is considerable flexibility in controlling size, color, positioning of major and minor tic marks (**-tmx** and **-tmy**),\\
    and in tic mark numbering (**-noxn** and **-noyn** and **-xn** and **-yn**), and formatting (**-fmtnx** and **-fmtny**), e.g.\\
  `$ fplot '-fmtnx:%;2,2d' -fmtny:%e -ord ...`
+ You can control many aspects of the curve's [line type](/docs/misc/fplot/#data-switches) (**-lt**); see [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp).
+ There is a great deal of flexibility in making labels.  See the [Labels exercise](/docs/misc/fplot/#fun-with-labels) for illustrations.\\
  The following will make a label &nbsp;&Delta;<i>k</i><sub>&perp;</sub>/<i>k</i><sub>0</sub> centered at (1.2,0.5).
  The Greek and italic symbols, subscripts and special character &perp; are accomplished through curly brackets **{...}**:
  <pre>$ fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02 -lbl 1.2,0.5 cc '~{D}&{k}_{~&#123;&#123;\136&#125;&#125;}/&{k}_{0}'</pre>

#### Example 2.2. &nbsp; Reading fplot commands from a script file
{::comment}
/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file
{:/comment}

Except for very simple cases, figures are too involved to invoked entirely from a command line.
Usually commands are read from an input file (script file).

The following example presents a graphical solution to the Schrodinger equation for a particle in a box of width _L_ and potential depth <i>V<sub>0</sub></i>.
The quantization condition for wave number _k_ reads:

$$ \frac{\mathrm{cos}^2kL}{k^2L^2} = \frac{\hbar ^2}{2mV_0L^2} \quad\quad\quad\quad (1) $$

It is a nonlinear equation in _k_ which must be solved numerically or graphically.  The latter is accomplished by drawing the left and right sides of Eq. (1)
and finding points where the curves intersect.  It is convenient to work with the dimensionless parameter _x_=_kL_ and treat the right hand site as a dimensionless constant.

Cut and paste the contents of the box below into script file _plot.box_{: style="color: green"}.

~~~
fplot
  -frme 0,1,0,0.5 -frmt th=3,1,1 -tmx 1:1;.04 -tmy 0;0 -noyn -noxn -p0
  -lt 1,bold=5,col=0,.3,.8 -ord cos(x)*cos(x)/x/x -tp 1.1:15:.01
  -lt 2,bold=4,col=.8,.3,.0 -ord .015 -tp 1,10
  -lbl 15,-.0005 cc x
~~~

<div onclick="elm = document.getElementById('figb'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="figb">{:/}
![Particle in a Box Example](https://lordcephei.github.io/assets/img/box.svg)
{::nomarkdown}</div>{:/}

~~~
$ fplot -f plot.box
$ open fplot.ps
~~~

_Notes:_{: style="color: red"}

+ The script file must contain a line beginning with [**fplot** in the first column](/docs/misc/fplot/#on-the-differences-between-instructions-in-a-script-file-and-on-the-command-line).
  Indentation of the lines following **fplot** is syntactically significant: instructions end when a nonblank character appears in the first column.
+ The script file is read through the [file preprocessor](/docs/input/preprocessor/).  Instructions read through a file may
  [differ slightly](/docs/misc/fplot/#on-the-differences-between-instructions-in-a-script-file-and-on-the-command-line) from command-line
  switches.
+ Multiple _xy_ curves are drawn by stringing together [(**DATA-switches data-file**)](/docs/misc/fplot/#data-switches-draw-one-or-more-families-of-xy-data) pairs.\\
  In this case the left hand side of Eq.(1) is drawn in blue-green ([**col=0,0.3,0.8**](/docs/misc/fplot/#color-specification)),
  followed by a reddish dashed horizontal line at _y_=0.015.
  (There are five solutions where the two curves intersect.  As <i>V<sub>0</sub></i> increases the rhs becomes smaller and more solutions appear).
+ [Tic marks](/docs/misc/fplot/#format-switches) on the _x_ axis are all the same size while those on the _y_ axis are suppressed.

#### Example 2.3. &nbsp; _Charge density contours in Cr_
{::comment}
/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr
{:/comment}

Th figure in this example shows a contour plot of the charge density of the Cr charge density in (100), (011) plane.

Commands are read from script _plot.cr_{: style="color: green"}.
To make this plot you will need to copy the already-prepared charge density contour file [chgd.cr](../../../assets/download/inputfiles/chgd.cr) to your working directory,
and cut and paste the script in the box below to _plot.cr_{: style="color: green"}.

~~~
fplot
  -frme 0,0.5,0,sqrt(0.5) -tmx '1;0' -tmy '1;0' -noxn -noyn
  -x 0,1 -y 0,1
  -con .045,.055 -lt 2,bold=3,col=.4,0,0 chgd.cr
  -con .065,.075 -lt 3,bold=4,col=0.,0,0 chgd.cr
  -font h13
  -lbl 0.17,0.556 cc '45'
  -lbl 0.28,0.355 cc '55'
  -font t16
  -lbl .5,1.02 cu 'Charge density in bcc Chromium (10^\{-3} a.u.)'
~~~

<div onclick="elm = document.getElementById('fig2'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig2">{:/}
![Example 2.3](https://lordcephei.github.io/assets/img/contours-cr.svg)
{::nomarkdown}</div>{:/}

    $ fplot -f plot.cr
    $ open fplot.ps

_Notes:_{: style="color: red"}

+ `fplot -f` tells **fplot**{: style="color: blue"} that the next argument
  _plot.cr_{: style="color: green"} is a file containing a script.
+ The script file is read through the [preprocessor](/docs/misc/fplot/#file-preprocessor) before parsing.  Commands inside a script work
  similarly to the instructions on command line, but there are
  [small differences](/docs/misc/fplot/#on-the-differences-between-instructions-in-a-script-file-and-on-the-command-line).
  In scripts you must use &nbsp;**\\{...}**&nbsp; for curly brackets.
+ **fplot**{: style="color: blue"} draws constant-density contours at 0.045 and 0.055 because of **-con .045,.055**.
  By splitting up the four contours into a pair of **-con** commands, distinct colours and line types can be drawn.
+ Data is read from _chgd.cr_{: style="color: green"}, which must contain _xy_ data.  **fplot**{: style="color: blue"} must be told how many
  rows or columns the data has; here it is specified in the first line of _chgd.cr_{: style="color: green"}. It can be indicated in other ways,
  as explained [here](/docs/misc/fplot/#structure-of-data-files).
+ Two of the contours are labelled (**-lblu**) with Helvetica 13pt font; the title uses 16pt Roman font.

#### Example 2.4. &nbsp; _Mobility in TlInP_
{::comment}
/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp
{:/comment}

This example shows how to use a log scale, customize positioning of tic marks and labelling, use a polynomial to interpolate discrete data, and add a key.

The figure drawn below depicts the predicted mobility of Tl<sub>1-<i>x</i></sub>In<sub><i>x</i></sub>P alloy.
It was adapted from a figure published in this [1994 paper](http://scitation.aip.org/content/aip/journal/apl/65/21/10.1063/1.112567),
which proposed Tl<sub>1-<i>x</i></sub>In<sub><i>x</i></sub>P and Tl<sub>1-<i>x</i></sub>In<sub><i>x</i></sub>As as infrared detector materials.

To make this figure, copy calculated mobililties from file [mobility.tlinp](../../../assets/download/inputfiles/mobility.tlinp){:
style="color: green"} to your working directory, and cut and paste the script in the box below to _plot.mobility_{: style="color: green"}.

~~~
fplot
  -frme:ly .13,.52,.96,1.42 -frmt th=3,1,2 -x 0,300 -y .27,5 -p0 -1p -yn:r
  -font t18
  -lbl 310,4.0:0 rc "~\{m}"
  -lbl 250,.21 rc "T(K)"
  -font t16
  -tmx 1@5,0,100,200 -tmy '1:1@2'
  -k 90,3,.25
  -l0 In_\{1-x}Tl_\{x}P  -lt 2,bold=3,col=.6,.3,.3,1,.5,.2,.5  -ord x2/1e5 -itrp 10,300,5,1,4 mobility.tlinp
  -l0 In_\{1-x}Tl_\{x}As -lt 2,bold=3,col=.3,.6,.3,1.5,.5      -ord x3/1e5 -itrp 10,300,5,1,4 mobility.tlinp
  -l0 Hg_\{x}Cd_\{1-x}Te -lt 1,bold=3,col=.3,.3,.6             -ord x5/1e5 -itrp 10,300,5,0,4 mobility.tlinp
~~~

<div onclick="elm = document.getElementById('fig4'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig4">{:/}
![Example 2.4](https://lordcephei.github.io/assets/img/mobility-tlinp.svg)
{::nomarkdown}</div>{:/}

    $ fplot -f plot.mobility
    $ open fplot.ps

_Notes on [frame formatting switches](/docs/misc/fplot/#format-switches-govern-frame-layout-and-labels):_{: style="color: red"}

+ **-frme:ly** tells **fplot**{: style="color: blue"} to use a log scale for the _y_ axis.
+ **-frmt th=3,1,2** creates a frame with axes on the bottom and right sides.
+ **-x 0,300** and **-y .27,5** set the user's units that bound the figure.
+ **-p0** suppresses padding of the frame (increasing the range of _x_ and _y_).
+ **-1p** terminates the first pass (two passes are made for each frame to determine bounds of plot).
+ **-yn:r** causes the figure numbering to appear on the right side.
+ **-font t18** causes the labels to be written in 18 points Times Roman font.
+ **-lbl 310,4.0:0 rc "~\{m}"** and **-lbl 250,.21 rc "T(K)"** generate the axes labels.
+ **-font t16** sets the font for subsequent labels.
+ **-tmx 1@5,0,100,200**
  + **@5,#,...**   user chooses the position of tic marks.\\
    Append a list of numbers where you want tics to appear (**0**, **100**, **200** in this case).
  + The **1** in **1@5**, which normally specifies the spacing between tic marks, is not relevant for mode **5**.
+ **-k 90,3,.25** sets up initial parameters for the key. **90,3** are the _x,y_ coordinates; **0.25** is the _y_ spacing between entries.
+ **-tmy 1:1@2**
  + **:1** specifies that every tic mark is labelled.
    **@2** specifies a 'medium' log scale with marks at 1,2,5.\\
    The initial **1:** is needed for the syntax but has no effect for log scales.

_Notes on [data switches](/docs/misc/fplot/#data-switches-draw-one-or-more-families-of-xy-data):_{: style="color: red"}

+ **-l0 In_\{1-x}Tl_\{x}P** supplies a key corresponding to next set of data.
+ **-lt 2,bold=3,1,.5,.2,.5** specifies a [dot-dashed line](/docs/misc/fplot/#dot-dashed-lines).
+ **-ord x2/1e5**          maps the ordinate to a new number (simple scaling in this case).
+ **-itrp 10,300,5,1,4**  causes the data to be interpolated to a uniform mesh on the _x_ axis.
  + Interpolated points span (<b>10</b>,<b>300</b>), and are spaced by **5** points.
  + The fourth argument (**1**) specifies interpolation by a rational function.
  + the final argument (**4)** specifies that a fourth order polynomial be used.
+ Three data sets are drawn, each with its own line type and key label.  The third set is interpolated with an ordinary polynomial.

_____________________________________________________________

### 3. _fplot manual_
{::comment}
/docs/misc/fplot/#fplot-manual
{:/comment}

This manual is written for fplot version 3.50.

Usage:

<pre>
fplot [-INIT-switches] [-FORMAT-switches] [-DATA-switches] <i>data-file</i> ...
</pre>


#### **INIT** switches must occur first
{::comment}
/docs/misc/fplot/#init-switches-must-occur-first
{:/comment}

+ **\-\-h | \-\-help**\\
  print out a help message and exits.
+ **-rot**\\
  rotate figure 90 by degrees
+ **-pr#**\\
  set the standard output verbosity to #
+ **-disp[:lus]**\\
  display picture in a subshell.
  Option :l or :u or :s draws in landscape, upside-down, seascape.\\
  _Note:_{: style="color: red"} to use this feature you must compile
  **fplot**{: style="color: blue"} with a viewer available on your machine.\\
  Customize string **dispfn** near the beginning of _fplot.f_{: style="color: green"}.
+ **-plaintext**\\
  assume strings have no non-ASCII characters (superscripts, subscripts, etc).
+ **-f <i>script-file</i>**\\
  read remaining arguments from input file <b><i>script-file</i></b>.\\
  **fplot**{: style="color: blue"} will skip over lines until it finds one beginning with **fplot** in the first column.
  It will begin to parse arguments as though they are read from the command-line until a line begins
  with a character in the first column, or the number of lines is exhausted.
  See [here](/docs/misc/fplot/#on-the-differences-between-switches-in-a-script-file-and-on-the-command-line)
  Note also that the script file is [run through the file preprocessor](/docs/misc/fplot/#file-preprocessor) before parsing.
  See, e.g. [Example 2.2](/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file).
+ **-shftm=_x_,_y_** shifts the entire figure by constant (**_x_**,**_y_**), in [medium units](/docs/misc/fplot/#graphics-units-and-medium-units) (points).\\
  This is useful for converting to other formats; see the [Postscript Conversion Exercise](/docs/misc/fplot/#adapting-postscript-files-to-other-formats).

#### **FORMAT** switches govern frame layout and labels
{::comment}
/docs/misc/fplot/#format-switches-govern-frame-layout-and-labels
{:/comment}

<br>_Notes:_{: style="color: red"}

1. A figure is comprised of one or more frames. Each new frame overlays anything below it.
2. By default, **fplot**{: style="color: blue"} draws a frame around the figure
   with tic marks and numbering (see [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x)).
   These defaults can be modified with the switches in this section.
3. Some switches in this and later sections specify colors through, **col=_r_,_g_,_b_**
   ([RBG](/docs/misc/fplot/#color-specification) conventions red,green,blue)
4. The [Frames Exercise](/docs/misc/fplot/#things-about-frames) illustrates most of the instructions in this section.

##### _FORMAT switches_
{::comment}
/docs/misc/fplot/#format-switches
{:/comment}

+ **-frme[:lx|:ly|:lxy][:xor=#][:yab=#][:nofill][:col=#,#,#,][:theta=#][:font=_font_] &nbsp;_l_,_r_,_b_,_t_**\\
  starts a new frame, in box.  **_l_,_r_,_b_,_t_** are left, right, bottom, top, &nbsp; in [graphics units](/docs/misc/fplot/#graphics-units-and-medium-units)\\
  Options to **-frme** are:\\
  + **lx**           &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; draw abscissa on a logarithmic scale.
  + **ly**           &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; draw ordinate on a logarithmic scale.
  + **lxy**          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           draw both abscissa and ordinate on a logarithmic scale.
  + **xor=#**        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   draw vertical axis at x=#.
  + **yab=#**        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   draw horizontal axis at y=#.
  + **nofill**       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                   draw both abscissa and ordinate on a logarithmic scale.
  + **col=#,#,#**    &nbsp; Fill frame with color #,#,# (**_r_,_g_,_b_** [color specification](/docs/misc/fplot/#color-specification)).
  + **theta=#**      &nbsp;&nbsp;&nbsp; angle between abscissa and ordinate (in radians)<br/>
  + **font=_font_**  &nbsp; Font for axis numbering and labels.

<i> </i>

+ **-frmt &nbsp; [col=_r_,_g_,_b_,][th=#1[,#2,#3]]**\\
  Sets parameters governing the lines composing the frame.
  + **col=_r_,_g_,_b_** specify the line color for the frame ([RBG](/docs/misc/fplot/#color-specification) conventions red,green,blue)
  + **th=#1[,#2,#3]** specifies the line thickness and which lines are drawn:\\
    **#1**&nbsp; sets line thickness. &nbsp; &minus;1 draws no frame.  &nbsp; Default value is 3.\\
    **#2**&nbsp; set to:&nbsp;  **0** for top and bottom;&nbsp; **1** for bottom only;&nbsp; **2** for top only;&nbsp; **3** for neither.\\
    **#3**&nbsp; set to:&nbsp;  **0** for left and right;&nbsp; **1** for left only;&nbsp; **2** for right only;&nbsp; **3** for neither.

<i> </i>

+ **-tmx** \| **-tmy &nbsp; _spacing_[:_mt_][,_pos_][;_rmt_][~_rmnt_][@_mode_]**\\
  tic mark specification and attributes.
  + **_spacing_**  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                  spacing between tics (spacing may be modified by **@mode**, below)
  + **\:_mt_**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no. number of tics per major tic
  + **,_pos_**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 specify position of major tic
  + **;_rmt_**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 size of major tic
  + **\~_rmnt_**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                             size of minor tic, as a fraction of major tic size
  + **@_mode_**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                             special tic mark placement modes\\
    @1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  "fine grained" log scale: tics put at at 1,2,3,4,5,6,7,8,9 &times; 10</sup>integer</sup>\\
    @2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  "medium grained" log scale: tics put at at 1,2,5 &times; 10</sup>integer</sup>\\
    @3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  "coarse grained" log scale: tics put at at 1 &times; 10</sup>integer</sup>\\
    @5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  tic marks selected by the user.  Specify a list of points after the @5 indicating where the marks should go.

  [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp) uses medium grained and user-selected marks.

<i> </i>

+  **-x &nbsp; <i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>** \\
    specifies range in abscissa : <b><i>x</i><sub>1</sub></b> = left edge, <b><i>x</i><sub>2</sub></b> = right edge (modified by padding; see &nbsp;**-p#**&nbsp; below).\\
    If this switch is not supplied, **fplot**{: style="color: blue"} will make an initial pass through all the data in the current frame to determine
    the globally smallest and largest abscissa values, and use them for <b><i>x</i><sub>1</sub></b> and <b><i>x</i><sub>2</sub></b>.
+  **-y &nbsp; <i>y</i><sub>1</sub>,<i>y</i><sub>2</sub>**\\
    specifies range in ordinate : <b><i>y</i><sub>1</sub></b> = bottom edge, <b><i>y</i><sub>2</sub></b> = top edge (modified by padding; see &nbsp;**-p#**).\\
    If this switch is not supplied, **fplot**{: style="color: blue"} will make an initial pass through all the data in the current frame to determine
    the globally smallest and largest ordinate values, and use them for <b><i>y</i><sub>1</sub></b> and <b><i>y</i><sub>2</sub></b>.
+  **-p#**\\
   pads bounds of abscissa and ordinate by adding <b>&plusmn;(#/2)&times;(<i>x</i><sub>2</sub>&minus;<i>x</i><sub>1</sub>)</b> to the right (left) boundary,
   and <b>&plusmn;(#/2)&times;(<i>y</i><sub>2</sub>&minus;<i>y</i><sub>1</sub>)</b> to the top (bottom) boundary.
   If if is not supplied, the default padding factor is **#**=0.1.\\
   _Note:_{: style="color: red"} Even if you specify
   (**<i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>**) or (**<i>y</i><sub>1</sub>,<i>y</i><sub>2</sub>**)
   through &nbsp;**-x**&nbsp; or &nbsp;**-y**,  the bounds are still padded.    Use &nbsp;**-p0**&nbsp; to suppress padding.\\
   _Note:_{: style="color: red"}  **<i>x</i><sub>1</sub>**, **<i>x</i><sub>2</sub>**, and **<i>y</i><sub>1</sub>**, **<i>y</i><sub>2</sub>** are called "user's units"
   in contrast to "[graphics units](/docs/misc/fplot/#graphics-units-and-medium-units)" and "[medium units](/docs/misc/fplot/#graphics-units-and-medium-units)."

+ **-1p**\\
  skip parsing of remaining arguments in the frame for the first pass.  Current values for
   (**<i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>**) and (**<i>y</i><sub>1</sub>,<i>y</i><sub>2</sub>**)
  are frozen.

{::comment}
+ **-aspect #\\
  resizes frame to make dy/dx(UU) / dy/dx(MU) = #
{:/comment}

+ **-3d shy[,shx,shz]**\\
  sets up 3-d perspective drawing.\\
  Points are shifted by **shy** (**shx**,**shz**).
  Projection is **x** to right, **z** up, **y** normal to paper.

+ **-rotp rot1[,rot2,...]**
  rotates points around an axis, or a succession of axes (used in conjunction with **-3d**).\\
  _Example_

    **-rotp (0,0,1)pi/4,(0,1,0)pi/3,(0,0,1)pi/2**

rotates the points by the Euler angles &pi;/4, &pi;/3, &pi;/2.  [This document](/docs/misc/rotations/) specifies the syntax of rotations.

#### **LABELLING and NUMBERING** switches govern labels and axis numbering
{::comment}
/docs/misc/fplot/#labelling-and-numbering-switches-govern-labels-and-axis-numbering
{:/comment}

<br>_Notes:_{: style="color: red"}

1. Where labels are used, text inside curly brackets &nbsp;**{..}**&nbsp; may be mapped
   into other fonts, depending on the character preceding the brackets.

   {::nomarkdown}<div>{:/}

   Character  | Function
   ^{..}      | superscript
   \_{..}     | subscript
   \~{..}     | Greek/Symbol
   @{..}      | bold
   &{..}      | italic

   {::nomarkdown}</div>{:/}

   _Example_  :   \~{D}&{k}\_{~&#123;&#123;\136&#125;&#125;}/&{k}\_{0}\\
   will be drawn as &nbsp; &Delta;<i>k</i><sub>&perp;</sub>/<i>k</i><sub>0</sub>.  (<b>\136</b> is the postscript symbol for &perp;.)

2. When using &nbsp;**{...}**&nbsp; in an **fplot**{: style="color: blue"} script file, you must
   [prepend the left bracket with a '**\\**'](/docs/misc/fplot/#on-the-differences-between-instructions-in-a-script-file-and-on-the-command-line) to avoid substitution by the preprocessor.\\
   _Example modified for script file_ : &nbsp; \~\\{D}&\\{k}\_\\{~\&#123;\&#123;\136&#125;&#125;}/&\\{k}\_\\{0}

3. The [Labels Exercise](/docs/misc/fplot/#fun-with-labels) illustrates all of the instructions in this section.

##### _Labelling switches_

+ **-lbl[um] _x_,_y_[:0] _cc_[,rot=#] _string_ [_tex-string_]**\\
  writes **_string_** at (**_x_**, **_y_**).  For examples, see this [exercise on labels](/docs/misc/fplot/#fun-with-labels).
  + **-lbl** and **-lblu** position label at (_x_,_y_) in user's units; &nbsp; **-lblm** indicates medium units.
  + Optional &nbsp;**:0**&nbsp; tells **fplot**{: style="color: blue"} to write a label without initially creating a blank box underneath.
  + **_cc_**  is a sequence of two characters specifying the justification of **_string_**.\\
     The first character is one of &nbsp; **l**, **c**, **r** &nbsp; corresponding to right, center, left justification;\\
     The second is one of &nbsp; **u**, **c**, **d** &nbsp; corresponding to up, center, down justification.
  + Alternatively, &nbsp;**_cc_**&nbsp; is &nbsp;**tx,** which flags **fplot**{: style="color: blue"} to run the postscript file through latex with string substitutions.\\
    In that case: **_tex-string_** is the actual (TeX) string and is required;  <b>_string_</b> is merely a tag needed for latex processing.

<i> </i>

+ **-lblx _xlst_ _y_[:0] _cc_ _str1_ _str2_ ...  &nbsp;&nbsp;** \| **&nbsp;&nbsp; -lbly ylst x[:0] _cc_ _str1_ _str2_ ...**\\
  puts labels **_str1_**, **_str2_**,  at a list **_xlst_** (**_ylst_**) of points distributed on the **_x_** axis (**_y_** axis) for a given
  value of **_y_** (**_x_**).  The number of strings must match the number of elements in **_xlst_**.
  + Optional **:0** tells **fplot**{: style="color: blue"} to write without initially creating a blank rectangle in the text box.
  + **_cc_** controls justification of labels; see **-lbl** above.

  **_xlist_** (**_ylist_**) is a list of real numbers; it has same syntax as those of [integer lists](/docs/misc/integerlists/).

<i> </i>

+ <b> -xl _str_ &nbsp;&nbsp; </b> \| &nbsp;&nbsp; <b> -yl _str_ </b> &nbsp;&nbsp; \| &nbsp;&nbsp; <b> -tl _str_ </b>\\
  supplies a label for the abscissa, ordinate, or title (title appears above the frame).\\
  This switch adds no new functionality **-lbl** already has.  It is convenient because it places the label at a reasonable default position.
+ **-fmtnx:_string_ &nbsp;&nbsp;**\|**&nbsp;&nbsp; -fmtny:_string_**\\
  awrite format for &nbsp;**_x_**&nbsp; axis or &nbsp;_**y**_&nbsp; axis label.
+ <b>-noxn \| -noyn </b>\\
  suppress abscissa (ordinate) axis numbering.
+ **-xn:t &nbsp;&nbsp;**\|**&nbsp;&nbsp; -yn:r**\\
  place abscissa (ordinate) axis numbering on right (top) side.

+ **-font t# &nbsp;&nbsp;\|&nbsp;&nbsp; -font h# &nbsp;&nbsp;\|&nbsp;&nbsp; -font i# &nbsp;&nbsp;\|&nbsp;&nbsp; -font b# &nbsp;&nbsp;\|&nbsp;&nbsp; -font s#**\\
  Sets the font for labels following this switch to Times Roman (**t**), Helvetica (**h**), italic (**i**), bold (**b**) or symbol (**s**) font.
  +  **#** is the size in points.
  +  If this switch precedes the frame specification, it affects the font of the axis numbering (absent a frame-specific **-frme:font=...**)

<i> </i>

+ **-k _x_,_y_[:_len_][,_spacing_][;_style_]**\\
  specifies key position (and length, spacing or style).

#### **DATA** switches draw one or more families of xy data
{::comment}
/docs/misc/fplot/#data-switches-draw-one-or-more-families-of-xy-data
{:/comment}

<br>_Notes:_{: style="color: red"}

1. Within a frame zero or more families of _xy_ data can be drawn.
   _xy_ data is typically read from a file; the syntax to plot data in **<i>data-file</i>** is
   <pre>
   [DATA-switches] <i>data-file</i> | -tp <i>list</i> [[DATA-switches] <i>data-file</i> | -tp <i>list</i> ...]
   </pre>

2. **DATA-switches** preceding **<i>data-file</i>** control how the ordinate, abscissa, and possible additional information
   (e.g. [error bars](/docs/misc/fplot/#error-bars), color weights, the _z_ axis in 3D figures) is extracted from **<i>data-file</i>** and the manner in which data is drawn.

3. For abscissa and ordinate you can select a particular column (**-col**), choose algebraic combination involving multiple columns of data (**-ab** and **-ord**).
   Also you may rearrange the data or cull out a subset of it (**-map**), or interpolate it (**-itrp**).

4. As an alternative to reading data from a file you can supply it using switch **-tp**.
   Most of the examples in [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x) use this form.

5. [Example 2.2](/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file) provides a simple example of two sets of data
   plotted in a frame; see also [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp).

##### _DATA switches_
{::comment}
/docs/misc/fplot/#data-switches
{:/comment}

+ **-lt _n_[~bold=_b_][~col=#,#,#][~colw=#,#,#][~colw2=#,#,#][~colw3=#,#,#][~clip][~fill=#][~brk=#][~_la_,_lb_,_lc_,_ld_]**\\
  Line type specification and attributes.  Options separator **~** can be a different character such as **:** or **,**.
  + **_n_**         &nbsp; line type
    + **_n_**=0     &nbsp; No connecting line. Used to draw symbols at [points without any connecting lines](/docs/misc/fplot/#error-bars).
    + **_n_**=1     &nbsp; solid, unbroken line.
    + **_n_**=2     &nbsp; dashed line, or dot-dashed line. Dash lengths specified through &nbsp;**_la_**&nbsp; and &nbsp;**_lb_**.
    + **_n_**=3     &nbsp; dotted line.
  + **bold=_b_**    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line thickness or dot size **_b_**.  Allowed values for **_b_** are 0-9.  Default is 3.
  + **col=#,#,#**   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [**_r_,_g_,_b_**](/docs/misc/fplot/#color-specification) line color.
  + **colw=#,#,#**  &nbsp;&nbsp;                   First color weight when line is to be drawn with color weights.
  + **colw2=#,#,#**                          Second color weight when line is to be drawn with color weights.
  + **clip**        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; clips curves when they go outside the frame
  + **fill=#**      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill color.
    + 1 &nbsp; color line with color given by **col**
    + 2 &nbsp; fill the area inside of the curve with color
    + 3 &nbsp; both 1 and 2
  + **brk=1**       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    starts a new line whenever <b><i>x<sub>i</sub></i> ><i>x<sub>i-1</sub></i></b>
  + **_la_,_lb_,_lc_,_ld_**   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; length of dash and space (for dashed lines only).
                    Dash length units are sized so that 1 correspond to a "typical" dash size.
    + **_la_**      &nbsp; First dash length
    + **_lb_**      &nbsp; First space length
    + **_lc_**      &nbsp; Second dash length
    + **_ld_**      &nbsp; Second space length\\
    You can enter anywhere between 1 and 4 numbers. If fewer then three numbers are given, a simple a dashed line will result.\\
    [This exercise](/docs/misc/fplot/#dot-dashed-lines) shows how to make a dot-dashed line.

<i> </i>

+ **-s _S_[~col=#,#,#][~clip][~bold=_b_][~fill=_f_]~_sym1_[,_sym2_ ..]** \\
  Draw a symbol at each point in next **<i>data-file</i>**.  **_S_** is one of twelve symbols listed in the table below.\\
  Each symbol has one or more attributes **_sym1_, _sym2_** that affect the symbol shape (see Table).\\
  Optional switches are separated by **~** (or the character following **_S_**):
  + **col=#,#,#** &nbsp;                                      fill color or color of symbol contour
  + **clip**      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  If present, clips symbols that fall outside frame
  + **bold=_b_**  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line thickness for symbol contour. **bold=0** => fill symbol without contour.
  + **fill=_f_**  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              controls how symbol is filled:
    + <b>_f_</b>=0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do not fill symbol
    + <b>_f_</b>=1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill the symbol with whitespace
    + <b>_f_</b>=2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill symbol with gray.  Specify shading with **col=#**.
    + <b>_f_</b>=3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill symbol with [RGB color](/docs/misc/fplot/#color-specification) given by **col=#,#,#**.
  + <b>_sym1_, _sym2_,..</b> symbol attributes (optional for some symbols, required for others) that alter size and shape of symbol.\\
    The number and meaning of attributes depends on the symbol (see Table).\\
  **_S_** is specified in one of the following ways:\\
  &nbsp;&nbsp; **_S_** is one of the strings in the table below, e.g. **square** (only the first four characters are necessary)\\
  &nbsp;&nbsp; **_S_** is an index 1-12, listed in the table below\\
  &nbsp;&nbsp; **_S_** = &minus;1. This causes **fplot**{: style="color: blue"} to read **S** and the modifiers **_sym1_, _sym2_** from **<i>data-file</i>**.\\
  &nbsp;&nbsp; In this case columns of **<i>data-file</i>** must hold: &nbsp;  4: symbol type  (1=>arrow 2=>cone)  5-7: color  8-*, symbol attributes.

  {::nomarkdown}<div>{:/}

  <b><i>S</i></b> | index | sym1                   | sym2                  | sym3               | sym4       | sym5           | sym6       |
    x             | 1     | width&dagger;          | height&dagger;        |                    |            |                |            |
    square        | 2     | width&dagger;          | height&dagger;        |                    |            |                |            |
    diamond       | 3     | width&dagger;          | height&dagger;        |                    |            |                |            |
    +             | 4     | width&dagger;          | height&dagger;        |                    |            |                |            |
    polygon       | 5     | size                   | number of sides       | angle&dagger;      |            |                |            |
    circle        | 6     | radius&dagger;         |                       |                    |            |                |            |
    arrow         | 7     | &Delta;<i>x</i>        | &Delta;<i>y</i>       | head length        | head angle | head-on-axis   | placement&dagger; |
    errbar        | 8     | width                  | height&times;<i>z</i> |                    |            |                |            |
    timeline      | 9     | end height             | line thickness        | end thickness      |            |                |            |
    hist          | 10    | width                  |                       |                    |            |                |            |
    row           | 11    | scale                  | offset                |                    |            |                |            |
    wiggle        | 12    | &Delta;<i>x</i>        | &Delta;<i>y</i>       | periods            | excursion  | points         |            |

  {::nomarkdown}</div>{:/}

  Notes on the Table:\\
  Attributes marked with "&dagger;" are optional. By default, **sym1**=1 and **sym2**=**sym1**.\\
  Symbols 1-4 have a width and height given by **sym1** and **sym2** (thus **square** can be a rectangle).\\
  Symbol 5 (polygon) has an third attribute, which sets the angle of 1<sup>st</sup> point relative to the vertical.\\
  Symbol 6 (circle) has one attributes.  It defaults to 1 if not specified.\\
  Symbol 7 draws arrows with the tip at (_x_, _y_).  Attributes refer to:\\
  &nbsp;&nbsp;&nbsp;&nbsp; 1,2 **&Delta;<i>x</i>** and **&Delta;<i>y</i>** are the endpoint of the tail relative to the tip (graphics units)\\
  &nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; **head length** is the size of the arrowhead as a fraction of arrow length\\
  &nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp; **head angle** is the angle subtended by the arrowhead\\
  &nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp; **head-on-axis**  the projection of the arrowhead onto the axis as a fraction of arrow length\\
  &nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; optional **placement**: set to 1 to put the tail at (_x_, _y_), or to 1/2 to center the arrow at (_x_, _y_).\\
  See the [Frames exercise](/docs/misc/fplot/#things-about-frames) for an illustration.\\
  Symbol 8&nbsp; draws error bars. **<i>data-file</i>** must have a third (**_z_**) element of data, in column 3.\\
  _Note:_{: style="color: red"} Error bars may also be drawn through the **-ey** command.  They are drawn before any possible second symbol through **-s**.\\
  See the [Error bars exercise](/docs/misc/fplot/#error-bars) for an example.\\
  Symbol 9&nbsp; (timeline) requires **<i>data-file</i>** to have a third (**_z_**) element of data to indicate size of timeline, in column 3.\\
  Symbol 10 (histogram) not documented.\\
  Symbol 11 (row)  not documented.\\
  Symbol 12 (wiggle) draws a wiggly line:\\
  &nbsp;&nbsp;&nbsp;&nbsp; 1,2&nbsp; **&Delta;<i>x</i>** and **&Delta;<i>y</i>** are the endpoint of the tail relative to the head (graphics units)\\
  &nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp; **periods** = number of oscillations in the symbol\\
  &nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp; **excursion** = size of excursion about straight line\\
  &nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp; (optional) **points** = number of points to draw the symbol: more points make the symbol smoother.\\
  [This exercise](/docs/misc/fplot/#wiggle-and-arrow-symbols) illustrates the wiggle and arrow symbols.

+ **-ey _n_[,&Delta;,_yshft_]**\\
  Add error bars to each point in the next **_data-file_**.\\
  The size of the error bar is taken from column **_n_** (**_data-file_** must have at least **_n_** columns)
  Optional **&Delta;** controls the width the the bar (1 is default).  The error bar is offset from the
  point center by **_yshft_**.  This can be used in place of, or in conjuction with **-s**.\\
  See this [error bar exercise](/docs/misc/fplot/#error-bars) for an example.

+ **-l[0] _legend_**\\
  Add **_legend_** to key for this data set. &nbsp; Optional 0 suppresses blanking of the box where the legend is written.\\
  Switch is operative only if a key was originally specified.\\
  See [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp) for an example

+ **-tp [_nc_~]_list_**\\
  generates a table of points.  Optional **_nc_~** specifies the number columns in the list (defaults to 1).\\
  See [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x) above.

+ **-map [-i _expr_] _list_**\\
  permutes rows original data array defined by **_list_**. The syntax of integer lists is described on [this page](/docs/misc/integerlists/).\\
  Optional **-i _expr_** causes points for which **_expr_=0** to be removed from **_list_**.\\
  For each point, **_expr_** can make use of the following variables:\\
  **i** (row index);  **x** and **y** (columns for abscissa and ordinate; see **-col** below), **nr** and **nc** (number of rows and columns),
  **xn**&nbsp; where &nbsp;**n**&nbsp; is column _n_.\\
  **_list_** is required : if you want to map all the points, use **1:nr** for **_list_**.\\
  _Example_ : &nbsp;&nbsp; **-map &nbsp; -i &nbsp; 'x<=4' &nbsp; 1,3,5,4**\\
  culls an array from rows 1,3,5,4 of the original data.  If the abscissa is &nbsp;&le;4&nbsp; the row is excluded.

+ **-itrp _x1_,_x2_,_dx_[,_ifrat_][,_nord_]**\\
  interpolates data to a uniform mesh of points in the range (**_x1_,_x2_**)
  spaced by **_dx_**, using a polynomial.\\
  Set optional **_ifrat_** to 1 if to use a rational polynomial instead.
  Optional **_nord_** specifies the polynomial order.\\
  See [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp) above.

+ **-sort**\\
  sort data in ascending abscissa order (after mapping).

+ **-con[~options] _flist_ [other DATA-switches] _data-file_**\\
  special mode for contour plots. **_flist_** is a list of real numbers; specify with the same syntax as for [integer lists](/docs/misc/integerlists/).\\
  This mode draws contours of constant &nbsp; _f_=**#**, interpolating discrete data read from **_data-file_** for each **#** in **_flist_**.\\
  **_data-file_** must consist of function values _f_(<i>x<sub>i</sub></i>,<i>y<sub>i</sub></i>)
  on a uniform rectangular grid of points (<i>x<sub>i</sub></i>,<i>y<sub>i</sub></i>).\\
  Elements in a fixed COLUMN comprise data on a uniform mesh parallel to abscissa, _f_(<i>x<sub>i</sub></i>,<i>y</i>=const).\\
  Elements in a fixed ROW commprise data on a uniform mesh parallel to ordinate, _f_(<i>x</i>=const,<i>y<sub>i</sub></i>).\\
  Bottom and top (left and right) edges of frame correspond to first and last columns (rows) of data.\\
  Options separator &nbsp;'**~**'&nbsp; can be a different character such as &nbsp;'**:**'&nbsp; or &nbsp;'**,**'.
  + **dup=#1[,#2]** Duplicate row (col) data #1 (#2) times
  + **fn=_filename_** writes _xy_ pen moves to file **_filename_**.
  + **noclose** suppresses closing contours on boundaries.

  See [Example 2.2](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr) above.

+ **-r:switches [other DATA-switches] _data-file_**\\
  tells **fplot**{: style="color: blue"} how to parse contents **_data-file_**.\\
  Optional **switches** are separated by a colon:
  + **nr=#**      stipulate that next **_data-file_** has &nbsp;**#**&nbsp; rows
  + **nc=#**      stipulate that next **_data-file_** has &nbsp;**#**&nbsp; columns
  + **qr**        &nbsp;&nbsp;&nbsp;&nbsp;read with fortran read (fast, no algebra; useful for large files)
  + **br**        &nbsp;&nbsp;&nbsp;&nbsp;read from binary file
  + **s=#**       &nbsp; skips &nbsp;**#**&nbsp; records before reading data
  + **open**      leaves file open after reading.  Useful when reading muliple blocks of data from a single file.
+ **-nc=_n_**\\
  same function as **-r_nc=#**
+ **-qr**\\
  same function as **-r:qr**
+ **-br**\\
  same function as **-r:br**

+ **-col _cx_,_cy_[,_cw_]**\\
  Use column **_cx_** for **x** and column **_cy_** for **y**.  In the absence of further
  substitution (**-ord _expr_** or **-ab  _expr_**) **x** and **y** are respectively the abscissa and ordinate.
  Default values are **cx**=1 and **cy**=2.

+ **-ord _expr_**\\
  substitute **_expr_** for the ordinate.
  Expressions can use variables &nbsp; **x**, **y** (see **-col** above), &nbsp; **i** for row index, and &nbsp;**xn**&nbsp; where &nbsp;**n**&nbsp; is column _n_.\\
  Many examples appear in document,
  e.g. [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x) and the [Symbols exercise](/docs/misc/fplot/#wiggle-and-arrow-symbols).
+ **-ab  _expr_**\\
  substitute **_expr_** for the abscissa.\\
  Expressions can use variables &nbsp; **x**, **y** (see **-col** above), &nbsp; **i** for row index, and &nbsp;**xn**&nbsp; where &nbsp;**n**&nbsp; is column _n_.
+ **-abf _expr_**\\
  maps numbering and tic marks on abscissa to **_expr_**

+ **-colsy _list_**\\
  make a family of _xy_ plots for columns in list.
  The syntax of integer lists is described on [this page](/docs/misc/integerlists/).\\
  If the data consists of a single column, it is copied to column 2 and the row index is copied to column 1.\\
  Thus `fplot -colsy 2,4 ...` draws two curves, with columns 2 and 4, respectively, as the _y_ variable.\\
  _Note:_{: style="color: red"} the ordinate actually plotted may be modified by **-ord _expr_**.  In the instance above
  **_y_** entering into **_expr_** will be column 2 for the first curve, and column 4 for the second.

+ **-colsw _list_**\\
  corresponding list of columns for color weights.

+ **-ins _strn_**\\
  insert **_strn_** directly into output postscript file.
  There is no check that **_strn_** consists of valid postscript ... you are on your own!
+ **-insf _file_**\\
  insert the contents of **_file_** directly into output postscript file.

+ **-bs _radius_[;file-list]**\\
  (3D only) connects points within radius and file-list.

_____________________________________________________________

### 4. _Additional notes_
{::comment}
/docs/misc/fplot/#additional-notes
{:/comment}

#### File preprocessor
{::comment}
/docs/misc/fplot/#file-preprocessor
{:/comment}

Both script files and data files are by default run through the [file preprocessor](/docs/input/preprocessor/).
This provides programming capability in the script files.

##### On the differences between instructions in a script file and on the command line
{::comment}
/docs/misc/fplot/#on-the-differences-between-instructions-in-a-script-file-and-on-the-command-line
{:/comment}

When commands are read from a script file, the action differs in the following ways from instructions given on the command-line:

_Start and end of script file_ : **fplot**{:style="color: blue"} will start reading instructions when it encounters
a line beginning with &nbsp;**fplot**&nbsp; in the first column.
(**fplot** is analogous to a _category_ in the Questaal [input system](/docs/input/inputfile/#input-file-structure).)
It will parse instructions from that point as though they are read from the command-line until line begins
with a character in the first column, or there are no more lines.  Thus the indentation is syntactically significant.

_Preprocessor directives_ : The [preprocessor directives](/docs/input/preprocessor/#preprocessor-directives) are not part of the script itself, but
control which lines of the script are read. For example, **% exit** causes the preprocessor to exit, and no further lines are read.

_Curly brackets and preprocessor variable subsitution_ : The preprocessor interprets
[curly brackets as expressions](/docs/input/preprocessor/#curly-brackets-contain-expressions) and makes substitutions for them, while
**fplot**{:style="color: blue"} [uses curly brackets](/docs/misc/fplot/#labelling-and-numbering-switches-govern-labels-and-axis-numbering)
to substitute special fonts (superscripts and subscripts, Greek, bold, italic and symbol fonts).

When using curly brackets in a script, you must suppress the preprocessor's expression substitution.  Do this
by prepending **{strn}** with a backslash, _viz_ **\\{strn}**.  The preprocessor will remove the backslash but leave **{strn}** unaltered.
For example, the last figure in Example 2.1 can be equivalently made by
<pre>
$ echo fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02 -lbl 1.0,0.5:0 cc '~\{D}&\{k}_\{~\{\{\136}}}/&\{k}_\{0}' > myplot
$ fplot -f myplot
</pre>

Note that the label now contains backslashes.

_Wild card expansion_ : there is no unix wild-card expansion in a script file.
Thus quotation marks to inhibit wild card expansion are not necessary, though they can be used.

#### Color specification
{::comment}
/docs/misc/fplot/#color-specification
{:/comment}

Some switches specify colors through, **col=_r_,_g_,_b_**.  These are RBG conventions (red, green, blue) expressed as
a fraction of the brightest color.  0 is the absence of color, and 1 is the brightest color.
Thus **col=1,0,0** is red; **col=0,1,0** is green; **col=0,0,1** is blue; while
**col=0,1,1** is cyan; **col=1,0,1** is magenta; **col=1,1,0** is yellow.

#### User's units
{::comment}
/docs/misc/fplot/#users-units
{:/comment}

_User's units_ are the units the data are represented in.  Each frame can have its own set of units.
Units that bound the box of the frame can be specified through
&nbsp; **-x <i>x</i><sub>1</sub>**,**<i>x</i><sub>2</sub>** and &nbsp; **-y <i>y</i><sub>1</sub>**,**<i>y</i><sub>2</sub>**.

In the absence of explicit specification, **fplot**{: style="color: blue"} will parse through all the families of data to be drawn
in the current frame to determine the bounds and determine one or both of (**<i>x</i><sub>1</sub>**,**<i>x</i><sub>2</sub>**)
(**<i>y</i><sub>1</sub>**,**<i>y</i><sub>2</sub>**) not specified from the smallest and largest values it finds.

Once (**<i>x</i><sub>1</sub>**,**<i>x</i><sub>2</sub>**) and (**<i>y</i><sub>1</sub>**,**<i>y</i><sub>2</sub>**) bounds have been
obtained, they are padded by (both abscissa and ordinate are enlarged on each end) by a fraction of their starting distance.
The bounds are stretched by a fraction 0.1 by default, but you can set the padding to any number with the **-p** argument.

#### Graphics units and medium units
{::comment}
/docs/misc/fplot/#graphics-units-and-medium-units
{:/comment}

_Graphics units_ are used to facilitate construction of some elements of the figure.

They range from (0,0) to (1,1) for the largest square that fits within the plot medium.
Graphics units are convenient for quantities that depend on the size of the figure, and not the units of data.
Examples are the size of tic marks, the size of symbols, and spacing between elements in a key.

_Medium units_ correspond to physical units of a device (meaningful for hard copies).  Postscript uses points (1 point = 1/72 inch).  For the most part the user
doesn't need to be concerned with them.
Note however, that (0,0) in postscript units is the lower left corner, with values increasing upwards and to the right.
Other conventions use the top left corner for (0,0).  This can be important when exporting the postscript file into other formats.
See for example the [Postscript Conversion Exercise](/docs/misc/fplot/#adapting-postscript-files-to-other-formats) which converts
_fplot.ps_{: style="color: green"} into _.svg_{: style="color: green"} format.

#### Structure of data files
{::comment}
/docs/misc/fplot/#structure-of-data-files
{:/comment}

Data files follow a standard Questaal format for two-dimensional arrays.
**fplot**{: style="color: blue"} will pass the data file through the [file preprocessor](/docs/input/preprocessor/) before parsing it for values.

**fplot**{: style="color: blue"} must be given information about the number of rows and columns in the file.  The safest way to specify this,
is to indicate it in the first line of the file; see for example the charge density file _chgd.cr_{: style="color: green"} in
[Example 2.3](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr). It begins with:

~~~~
% rows 101 cols 101
      0.0570627197      0.0576345670      0.0595726102      0.0628546738
...
~~~

Calling **nr** and **nc** the number of rows and columns, respectively,
**nr** and **nc** can be stipulated in the data file as shown, but the information can be supplied in other ways.

+ The parser checks to see whether the first nonblank, non-preprocessor directive, begins with `% ... rows nr` or `% ... cols nc`.\\
  It uses whatever information is supplied to set the number of rows to **nr** and/or columns to **nc**.
+ Command-line switches &nbsp; `-r:nr=#` or `-r:nc=#` can specify **nr** or **nc**.
+ If **nr** has not been stipulated in some manner, **fplot**{: style="color: blue"} works it out from the file contents.
+ If **nc** has not been stipulated, the parser will count the number of elements in the first line containing data elements, and assign **nc** to it.\\
  For the particular file _chgd.cr_{: style="color: green"}, **fplot**{: style="color: blue"} would incorrectly infer **nc**=4: so **nc** must be stipulated in this case.

### 5. _Other resources_

See the [plbnds](/docs/misc/plbnds/) and [pldos](/docs/misc/pldos/) manuals.


{::comment}
Need to explain

+ bs

+ more on map.  Eg. variable nr.

+ expand on -tp

expand on -map
{:/comment}

### 6. _Additional exercises_
{::comment}
/docs/misc/fplot/#additional-exercises
{:/comment}

#### Error bars
{::comment}
/docs/misc/fplot/#error-bars
{:/comment}

You can specify error bars for each _xy_ pair through either the `-s` command or the `-ey` command.
If you use the latter you can make further use of `-s` to draw a second symbol at each point.
In either case three columns of data are required, the third column containing the error bar.

Example showing an error bar and a circle:

~~~
$ fplot -frmt th=3,1,1 -lt 0 -ey 3,.75 -s circ~fill=2~col=0,0,0~.5 -tp 3~1,1,.1,2,4,.2,3,9,.3
~~~

+ An error bar is drawn first, using column 3 (**-ey 3,.75**).  The **.75** scales the default with of the horizontal lines in the error bar symbol by 0.75.
+ A filled circle is drawn after the error bar, concealing part of it.
+ No line is drawn connecting points: **lt 0** suppresses connecting lines.

<br>

#### Dot-dashed lines
{::comment}
/docs/misc/fplot/#dot-dashed-lines
{:/comment}

In [Example 2.3](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr),
a horizontal dashed line was drawn.  Try substituting the following line type for the dashed line:

~~~
-lt 2,bold=4,col=.8,.3,.0,1,.5,.3,.5
~~~

It should generate a dot-dashed line.  The sequence **1,.5,.3,.5** specifies
the dot-dashed sequence. **1,.5,** specifies a dash length 1 followed by a dash length 0.5.
In this case a second sequence (**.3,.5**) is present.  This specifies that (line,space) pair of **1,.5,**
and (line,space) pair of **.3,.5,** are drawn in alternation.

<br>

#### Wiggle and arrow symbols
{::comment}
/docs/misc/fplot/#wiggle-and-arrow-symbols
{:/comment}

This exercise shows applications of the wiggly line symbol, together with the arrow symbol.
Cut and paste the box below into script file _plot.wiggle_{: style="color: green"}.

~~~
fplot
  -frme .0,.7,0,.7 -x 0,1 -y 0,1 -frmt th=2,3,3 -noyn -ord 1.2 -tp 1.5
  -s wiggle:fill=0:bold=4:col=0.,1.,0.:-.15,0.16,2.3,.05 -ord .5 -tp 0.5
  -lt 0,bold=2 -s arrow:fill=3:col=0.,0.,0.:-.15/4,0.16/4,.99,25,.9 -ord 0.5 -tp 0.5
  -lt 0 -s wiggle:fill=3:bold=2:col=.5,1,0:-.35,0.00,0.5,.1,40 -ord .5-.05 -tp 0.8
~~~

<div onclick="elm = document.getElementById('figw'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="figw">{:/}
![Symbols Example](https://lordcephei.github.io/assets/img/wiggle.svg)
{::nomarkdown}</div>{:/}

~~~
$ fplot -f plot.wiggle
$ open fplot.ps
~~~

+ `-s wiggle:fill=0:bold=4:col=0.,1.,0.:-.15,0.16,2.3,.05 -ord .5 -tp 0.5`
  creates a wiggly line ending at **(0.5,0.5)**, sloping downward with run/rise = **(-0.15,0.16)**.
+ `-lt 0,bold=2 -s arrow:fill=3:col=0.,0.,0.:-.15/4,0.16/4,.99,25,.9 -ord 0.5 -tp 0.5`
  tacks an arrowhead onto the line with:\\
  &nbsp;&nbsp; Arrowhead filled with black (**col=0,0,0**)\\
  &nbsp;&nbsp; Tip at data point (**0.5,0.5**)\\
  &nbsp;&nbsp; Tail at position **(&minus;0.15/4,0.16/4)** in graphics units, relative to head;\\
  &nbsp;&nbsp; thus the arrowhead line point at the same angle as the wiggle but is 1/4 size.\\
  &nbsp;&nbsp; Wings with length **0.99 &times; [size of tail]**, subtending angle 25<sup>o</sup>.\\
  &nbsp;&nbsp; Arrowhead touches line of tail at **0.9&times;[length of tail].**

+ `-lt 0 -s wiggle:fill=3:bold=2:col=.5,1,0:-.35,0.00,0.5,.1,40 -ord .5-.05 -tp 0.8`
  creates a wiggly line with only half a period, and then fills the symbol with yellow-green (**col=.5,1,0**).

##### _Things to try_

Play with the last line, and see what happens as you change the **fill** value between 0 and 3,
and the **bold** value between 0 and 5.

<br>

#### Fun with labels
{::comment}
/docs/misc/fplot/#fun-with-labels
{:/comment}

This exercise shows off many of **fplot**{: style="color: blue"}'s labelling capabilities.
Cut and paste the box below into script file _plot.text_{: style="color: green"}.

~~~
fplot -p0 -font h18
#     -plaintext
      -xl horizontal\'next_h (eV)' -yl 'vertical\next_v'
      -tp 2~0,0,1,1                   # Diagonal line
      -lt 1,bold=2 -tp 2~0.3,0,0.3,1  # Vertical line at x=0.3
      -lt 1,bold=2 -tp 2~0,0.4,1,0.4  # Horizontal line at y=0.4
      -font i20
      -lblu 0.3,0.4:0 ru 'Above line: @\{ru} justification'
      -font b14
      -lblu 0.3,0.4:1 ld "Below line: &\{ld} justification"
      -font t18
      -lblu 0.3,0.2 rc 'Nested subscripts : ~\{Dj}_\{t_\{2_\{g}}}~\{-a}^\{4}'
      -lblu 0.3,0.68 lc,rot=40 'At 40^\{o} :  2^\{~\{b}}~\{P}_\{&\{k}^\{2}}=2^\{~\{a}}'
      -font h18
      -lbl 0.5,.94 cc "@\{cc} justification with special subscript &\{k}_\{~\{\{\136}}}"
      -lbl 0.2,.89 rc "arrows ~\{\{\253\254\255\256\257}}
      -lbl 0.2,.84 rc "brackets ~\{\{\173\341A\361\175\355\375\357\364\174}}
      -lbl 0.2,.79 rc "math  ~\{\{\266\245\321\326\327\243\263\055\261\264\265\271\272\273\100}}
      -lbl 0.2,.74 rc "symbols ~\{\{\333\334\335\336\337\362\134\136\262\267\250\274\260}}
~~~


<div onclick="elm = document.getElementById('figl'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="figl">{:/}
![Labels Example](https://lordcephei.github.io/assets/img/labels.svg)
{::nomarkdown}</div>{:/}

~~~
$ fplot -f plot.text
$ open fplot.ps
~~~

Note the following:

+ **-xl _string_** and **-yl _string_** create axes labels.
  + Labels are written in 18 point Helvetica (aka Arial) font. This is set by the initial **-font h18**.\\
  Note that &nbsp;'**\\**'&nbsp; within a label creates a line break.
+ Parts of the three lines drawn (diagonal; horizontal at _y_=0.4, vertical at _x_=0.3),
  are blanked out by labels.  This is explained below.
+ Label "**Below line** ..." :
  + is left justified at **_x_=0.3**, and appears below **_y_=0.4** (**ld** justification)
  + is in 14 point bold (Roman) font
  + does not blank out the surrounding box because **:0** is appended to **_x_**,**_y_**.
  + embeds italicized _ld_
+ Label "_Above line_ ..." :
  + is left justified at **_x=0.3_**, and appears above **_y_**=0.4 (**ru** justification)
  + is in 20 point italic font because of the **-font i20** preceding it.
  + blanks out the surrounding box, including the horizontal line below it\\
    To suppress blanking, see label "**Below line** ..." above.
  + "Bolidfies" embedded **ru**.
+ Label "Nested subscripts ..." :
  + is right justified and vertically centered at **_y_**=0.2.
  + is in 18 point Times Roman font
  + Note the multiple nesting of subscripts.
    _t_ is a subscript to <i>&phi;</i>; &nbsp; 2 is a superscript to _t_; &nbsp; _g_ is a subscript to 2.\\
    _Note:_{: style="color: red"} [backslashes are necessary](/docs/misc/fplot/#on-the-differences-between-instructions-in-a-script-file-and-on-the-command-line) to suppress expression substitution of &nbsp;**{..}**&nbsp; by the file preprocessor.
+ Label "At 40<sup>o</sup> ..." :
  + is rotated by 40<sup>o</sup>
  + Has a nested subscript/superscript:  _k_ is both subscript and italic; it has a superscript in Roman font.
+ Labels at the top of the figure display some useful symbols from the Postscript Symbol font. Specify them by an octal code, e.g. \355.\\
    Octal codes for the full Symbol character set can be found on p 612 of the [postscript manual](http://partners.adobe.com/public/developer/en/ps/psrefman.pdf).

##### _Things to try_

Try other combinations of the justification tags, e.g. turn &nbsp;**lu**&nbsp; into &nbsp;**rc**.
The first character can be one of &nbsp; **l**, **c**, **r**; the second one of &nbsp; **u**, **c**, **d**.

Uncomment the `-plaintext` line and observe how the labels change.

Swap the **:1** and **:0** in the "Above line" and "Below line" labels and observe how different parts of the horizontal line are blanked out.

Replace '**~**' with '**@**' in the labels at the top of the figure..  A completely different group of characters result.\\
  '**~{...}**'&nbsp; [maps characters](/docs/misc/fplot/#labelling-and-numbering-switches-govern-labels-and-axis-numbering) &nbsp;**...**&nbsp;
  into the postscript Symbol font while &nbsp;'**@{...}**'&nbsp; uses the bold Roman font instead (p 604 of the
  [postscript manual](http://partners.adobe.com/public/developer/en/ps/psrefman.pdf)).
  Dagger (&dagger;) and double dagger (&Dagger;) appear in the Roman set but not the Symbol, for example.

<br>

#### Things about frames
{::comment}
/docs/misc/fplot/#things-about-frames
{:/comment}

**fplot**{: style="color: blue"} provides a fair amount of flexbility in making frames.
The script in the box below draws three small frames.
Cut and paste into file _plot.frames_{: style="color: green"}.

~~~
fplot -frme:font=h30:col=0,0,1 0,1,0,.1 -frmt col=.6,.8,.8,th=4 -tmx 0.2:5,1.001;0.46~0.5 -tmy .5;1 -noyn -x -1,1 -y 0,2 -tp 1~
      -frme:xor=.3:col=0,1,0 0,1,.125,.225 -frmt col=.9,.9,.9,th=6 -x 0,1 -y 0,1 -tmx .1:5;.2,.5 -tmy .25 -noyn
      -s arrow:fill=3:bold=2:col=.5,.5,.5:-.07,0.20,.5,20,.4 -tp 2~.3,.6
      -frme:xor=.4:col=0,1,1 0,1,.3,.4 -noyn -x 0,1 -y 0,1 -tmx .1;1~.75,.5 -tmy .25:2 -1p -lbl .0,.0:0 cc ABC
      -s arrow:fill=3:bold=2:col=.5,.5,.5:.07,0.20,.5,20,.4 -tp 2~.4,.0
~~~

<div onclick="elm = document.getElementById('figf'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="figf">{:/}
![Frames Example](https://lordcephei.github.io/assets/img/frames.svg)
{::nomarkdown}</div>{:/}

~~~
$ fplot -f plot.frames
$ open fplot.ps
~~~

+ _Bottom panel_ :
  + `-frme:font=h30:col=0,0,1 0,1,0,.1` &nbsp; fills the frame with a [blue](/docs/misc/fplot/#color-specification) background (**col=0,0,1**).\\
     Frame labels and numbering are in 30 point font.  Labels will use Helvetica; numbering is always in Roman font.\\
     This font applies to the frame labelling only; subsequent labels revert to the pre-existing font.
  + `-frmt col=.6,.8,.8,th=4` frames the box with a pale blue (**col=.6,.8,.8**), fairly thick (**th=4**) line.\\
      The same line type is used for tic marks; also tics are numbered with this color.
  + `-tmx 0.2:5,1.001;0.46~0.5` :
    + spaces tic marks on the _x_ axis by 0.2
    + has 5 tics per major tic
    + one major tic passes through 1.001
    + The major tic is 0.46&times;[frame height]
    + The minor tic is 0.5&times;[major tic height]
  + `-tmy .5;1 -noyn` sets the tic mark spacing on the _y_ axis with every tic a major tic, and suppresses numbering.
  + `-tp 1~` doesn't draw anything.  It generates a "null" table of points and is needed because the frame isn't made unless at least one data set is supplied.
+ _Middle panel_ :
  + `-frme:xor=.3:yab=.6:col=0,1,0` :
    + fills the fame with green (**col=0,1,0**)
    + causes the ordinate to be drawn through **_x_**=0.3 and the abscissa through **_y_**=0.6 (see arrow).\\
      Tic labels appear adjacent to these lines.
  + `-frmt col=.9,.9,.9,th=6` :
    + draws the frame and tics with a nearly white, thick line.
    + If either &nbsp;**:xor**&nbsp; or &nbsp;**:yab**&nbsp; is given, no frame is drawn around the box.
  + `-tmx .1:5;.2,.5` specifies the abscissa tic marks (compare to bottom panel).
  + `-tmy .25 -noyn` spaces the tic marks and suppresses numbering on the _y_ axis.\\
    Note: the number of tics per major tic was not specified; the default is 2.
  + `-s arrow:fill=3:bold=2:col=.5,.5,.5:-.07,0.20,.5,20,.4 -tp 2~.3,.6` creates an arrow with:
    + arrowhead filled with grey (**col=0.5,0.5,0.5**)
    + tip at data point (**0.3,0.6**)
    + tail at position **(&minus;0.07,0.20)** in graphics units, relative to head (**0.3,0.6**).
    + wings with length **0.5 &times; [size of tail]**, subtending angle 20<sup>o</sup>
    + arrowhead touches line of tail at **0.4&times;[length of tail]**
+ _Top panel_ :
  + Use the default line type and color (black) for frame; compare it to the middle panel.
  + Major abscissa tic marks span the full height of the frame; minor tics are reduced by **0.75**.
  + Label ABC is partially concealed, because the frame was filled after the label was drawn.

##### _Things to try_

<br>

Move the label ABC to the end of the script, after the arrow.  Now the frame is
drawn first and the label is not concealed.

Replace **:col=0,1,1** with **:nofill**.  The frame is not filled so ABC is no longer concealed.

Try making graph paper by drawing one frame, filled, with thin tic marks.
Redraw the frame with &nbsp;**:nofill**&nbsp; and use fewer, but thicker tic marks.\\
Example:

~~~
fplot -frme:col=.8,1,.8 0,1,0,.5 -frmt col=.6,.8,.6,th=1 -p0
        -tmx 0.1:1,1;1~1 -noxn -tmy 0.1:1,1;1~1 -noyn -x -1,1 -y 0,1 -tp 1~
      -frme:nofill      0,1,0,.5 -frmt col=.4,.6,.4,th=2 -p0
        -tmx 0.5:1,1;1~1 -noxn -tmy .5:1;1 -noyn -x -1,1 -y 0,1 -tp 1~
~~~

To make make graph paper with 120<sup>o</sup> axes, replace both instances of **-frme**
with **-frme:theta=2*pi/3**.

<br>

#### Adapting postscript files to other formats
{::comment}
/docs/misc/fplot/#adapting-postscript-files-to-other-formats
{:/comment}

Many tools convert postscript files into other forms, e.g. ImageMagick's 'convert' utility will convert _.ps_{: style="color: green"} files
into bitmapped forms such as _.png_{: style="color: green"} or _.jpg_{: style="color: green"} format.

In this example we convert **fplot**{: style="color: blue"}-generated _fplot.ps_{: style="color: green"} into
[Scalable Vector Graphics](https://en.wikipedia.org/wiki/Scalable_Vector_Graphics) (_.svg_{: style="color: green"}) form.
The process is slightly complicated by the fact that
Postscript conventions put (0,0) at the lower left corner, with values increasing upwards and to the right.
In contrast, _.svg_{: style="color: green"} conventions put (0,0) at the upper left corner.
When converting to _.svg_{: style="color: green"} format, attention must be paid to this
if the figure is to embedded in another document, so it has the proper dimensions without padding with whitespace.

The main issue is to shift the figure to the top of the page (top is 792 points).
For the figure to begin at the top, it is necessary to shift the coordinates in
_fplot.ps_{: style="color: green"} generated by **fplot**{: style="color: blue"}.
so that the topmost bit resides at 792 points.  This is accomplished with [**-shftm** instruction](/docs/misc/fplot/#init-switches-must-occur-first).

The steps below adapt _fplot.ps_{: style="color: green"} generated from _plot.frames_{: style="color: green"} in
the [Frames Exercise](/docs/misc/fplot/#things-about-frames), to make _fplot.svg_{: style="color: green"}.

1. Carry out the [Frames Exercise](/docs/misc/fplot/#things-about-frames) to generate _fplot.ps_{: style="color: green"}.

2. To determine the postscript bounding box, use ghostscript.  Assuming you are using a bash shell, do:

        $ echo quit|gs -sDEVICE=bbox -dNOPAUSE fplot.ps | grep 'BoundingBox:'

   You should see

        %%BoundingBox: 120 116 553 303

   The left edge begins at 120 points; the top edge at 303 points, and the figure height is
   303-116 = 187 points.

3. Run **fplot**{: style="color: blue"} again, now adding a shift:

        $ fplot -shftm=0-120,792-303 -f plot.frames

   If you run the **gs**{: style="color: blue"} command again, you should now see:

        %%BoundingBox: 0 605 433 792

   The left edge is at 0, the top at 792 points.

4. Use the Inkscape program to convert from _.ps_{: style="color: green"} to _.svg_{: style="color: green"}.
   (This example was constructed using a linux build 0.48.4 r9939 of Inkscape.)

        $ inkscape fplot.ps -l fplot.svg

5. Use your text editor to change the line **height="990"** into **height="187pt"** in _fplot.svg_{: style="color: green"}.

_fplot.svg_{: style="color: green"} can now be embedded in a web page without any filling around it.

### _Index_

#### Subject Index

Contour plots

Data formats

Error bars

Fonts
  types
  size

Frames
  shape :  height, nonorthogal frames
  font
  filling
  axes, where they are drawn
  bounds, how they are determined
  log scale
  line type and color
  graph paper
  numbering
  tic marks : see tic marks

Key
 position
 spacing
 line size
 style
 legend

Labels
  position
  justification
  filling of label box
  angle
  abscissa
  ordinate
  title

Lines or curves
  solid, dotted, dot-dashed
  color
  thickness
  filling
  clipping
  color weights
  breaking when nonmonotomic

Mapping or transformation of data
  for ordinate
  for abscissa
  interpolation
  sorting

Scripts
  How to include commands in a file
  Differences with command-line instructions

Symbols

Topic                                  | Instruction       |  Definition                                          | Places to look
**Tic marks**                          | -tmx\|-tmy        | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
|---
&nbsp;&nbsp;&nbsp;&nbsp; _log scale_      | -frme**:lx**{: style="color: red"}\|-frme**:ly**{: style="color: red"}\|-frme**:lxy**{: style="color: red"} &nbsp; (axes) | | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
|---
                                          | -tmx\|-tmy &nbsp;..**@2\|@3\|@4**{: style="color: red"}... &nbsp; (tic marks) | | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
|---
&nbsp;&nbsp;&nbsp;&nbsp; _major tic size_ | -tmx\|-tmy &nbsp;..**,_rmt_**{: style="color: red"}      | | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
|--- | :- - -: | |
&nbsp;&nbsp;&nbsp;&nbsp; _minor tic size_ | -tmx\|-tmy &nbsp;..**;_rmnt_**{: style="color: red"}     | | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
|---
&nbsp;&nbsp;&nbsp;&nbsp; _user-specified_ | -tmx\|-tmy &nbsp;..**@5**{: style="color: red"}          | | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
|---
&nbsp;&nbsp;&nbsp;&nbsp; _placement_      | -tmx\|-tmy &nbsp;..**,_pos_**{: style="color: red"}...   | | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
|---
&nbsp;&nbsp;&nbsp;&nbsp; _spacing_        | -tmx\|-tmy &nbsp;**_spacing_**{: style="color: red"}...  | | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
|---
&nbsp;&nbsp;&nbsp;&nbsp; _mapping_        | **-abf _expr_**{: style="color: red"}

#### Command Index

Instruction   | Definition                                           | Places to look
**-1p**       |[FORMAT switches](/docs/misc/fplot/#format-switches)  | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp),&nbsp; [Frames Exercise](/docs/misc/fplot/#things-about-frames)
**-3d**       | [FORMAT switches](/docs/misc/fplot/#format-switches) |
**-ab**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-abf**      | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-aspect**   | [FORMAT switches](/docs/misc/fplot/#format-switches) |
**-br**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-bs**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-col**      | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-colsw**    | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-colsy**    | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-con**      | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.3](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr)
**-disp**     | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) |
**-ey**       | [DATA switches](/docs/misc/fplot/#data-switches)     | [Error bars exercise](/docs/misc/fplot/#error-bars)
**-f**        | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) | [Example 2.2](/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file)
**-fmtnx**    | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-font**     | [DATA switches](/docs/misc/fplot/#data-switches)     | [Labels exercise](/docs/misc/fplot/#fun-with-labels)
**-frme**     | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
**-frmt**     | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
**-h**        | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) |
**-ins**      | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-insf**     | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-itrp**     | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
**-k**        | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
**-l**        | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
**-lbl**      | [DATA switches](/docs/misc/fplot/#data-switches)     | [Labels exercise](/docs/misc/fplot/#fun-with-labels)
**-lblx**     | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-lt**       | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp),&nbsp; [Dot-dashed lines exercise](/docs/misc/fplot/#dot-dashed-lines)
**-map**      | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-nc**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-ndpi**     | [FORMAT switches](/docs/misc/fplot/#format-switches) |
**-nr**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-nx**       | [FORMAT switches](/docs/misc/fplot/#format-switches) |
**-ny**       | [FORMAT switches](/docs/misc/fplot/#format-switches) |
**-ord**      | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x)
**-p**        | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x)
**-plaintext**| [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) | [Labels exercise](/docs/misc/fplot/#fun-with-labels)
**-plm**      | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) |
**-pr**       | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) |
**-qr**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-r**        | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-rot**      | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) |
**-rotp**     | [FORMAT switches](/docs/misc/fplot/#format-switches) |
**-s**        | [DATA switches](/docs/misc/fplot/#data-switches)     | [Wiggly lines exercise](/docs/misc/fplot/#wiggle-and-arrow-symbols),&nbsp; [Error bars exercise](/docs/misc/fplot/#error-bars)
**-shftm**    | [INIT switches](/docs/misc/fplot/#init-switches-must-occur-first) |[Postscript conversion exercise](/docs/misc/fplot/#adapting-postscript-files-to-other-formats)
**-sort**     | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-tmx**      | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
**-tmy**      | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Frames Exercise](/docs/misc/fplot/#things-about-frames)
**-tp**       | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.2](/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file)
**-x**        | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
**-xl**       | [DATA switches](/docs/misc/fplot/#data-switches)     | [Labels exercise](/docs/misc/fplot/#fun-with-labels)
**-xn**       | [DATA switches](/docs/misc/fplot/#data-switches)     |
**-y**        | [FORMAT switches](/docs/misc/fplot/#format-switches) | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
**-yl**       | [DATA switches](/docs/misc/fplot/#data-switches)     | [Labels exercise](/docs/misc/fplot/#fun-with-labels)
**-yn**       | [DATA switches](/docs/misc/fplot/#data-switches)     | [Example 2.4](/docs/misc/fplot/#example-24-nbsp-mobility-in-tlinp)
