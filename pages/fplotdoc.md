---
layout: page-fullwidth
title: "The fplot program"
permalink: "/docs/misc/fplot/"
header: no
---
_____________________________________________________________


### _Purpose_
{:.no_toc}

**fplot**{: style="color: blue"} is a general purpose plotting package, with functionality roughly similar to **gnuplot**{: style="color: blue"}.
It is a command-line driven tool; you can also supply the information in a script file.
**fplot**{: style="color: blue"} has its particular strengths and weaknesses, but for the Questaal suite it is particularly useful because
it synchronises smoothly with other Questaal executables such as [**plbnds**{: style="color: blue"}](/docs/misc/plbnds)
and [**pldos**{: style="color: blue"}](/docs/misc/pldos/), and uses the same file structure for data.

Also **fplot**{: style="color: blue"} provides some functionality not readily obtained in **gnuplot**{: style="color: blue"}, e.g.
to determine cyclotron masses, drawing [energy bands with color weights](/docs/misc/plbnds/#example-3), and taking advantage
of the [programming language features](/docs/input/preprocessor) of the Questaal suite.

Tutorials that draw bands or densities-of-states use **fplot**{: style="color: blue"} to build figures.
But [**plbnds**{: style="color: blue"}](/docs/misc/plbnds) and [**pldos**{: style="color: blue"}](/docs/misc/pldos/) will render data generated by
Questaal codes into easily read files, for use by any graphics package.

_____________________________________________________________

### _Table of Contents_
{:.no_toc}
*  Auto generated table of contents
{:toc}

_____________________________________________________________

### _Preliminaries_

**fplot**{: style="color: blue"} is required and is assumed to be in your path.
You will also need a postscript viewer.  This document assumes you are using the apple-style **open**{: style="color: blue"} command to view postscript files.

This manual is written for fplot version 3.50.  To see what version you are using, do:

    $ fplot --version

_____________________________________________________________

### 1. _Introduction_

**fplot**{: style="color: blue"} is mainly designed to draw _xy_ data; it has some capability for contour plots and a very limited ability
for 3D graphics.

**fplot**{: style="color: blue"} is command-line driven and can efficiently generate figures from command-line arguments.  It can also read
arguments from a file script; this is necessary if the figure is complex.  **fplot**{: style="color: blue"} can make full use of the
[programming language capability](/docs/input/preprocessor) it has for reading input files, in both the script and the data files.

Other programs, especially [plbnds](/docs/misc/plbnds/) and [pldos](/docs/misc/pldos/), make **fplot**{: style="color: blue"}
scripts to make the process of drawing high quality figures of bands very easy and efficient,
with the capability of refining the figure by tuning the autogenerated plotting script.

**fplot**{: style="color: blue"}  will print a synopsis of the command it provides by typing

    $ fplot --h

### 2. _Examples_

Section 3 is a manual detailing **fplot**{: style="color: blue"};s features and arguments that take advantage of them.
This section develops a couple of examples to provide an intuitive feel for how the code operates and to illustrate some features.

#### Example 2.1. &nbsp; plot &nbsp; $$y=20\,x^2\exp(-4x)$$
{::comment}
/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x
{:/comment}

The following will plot this function in the interval (0,2), with the abscissa spaced in intervals of 0.02:

    $ fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02
    $ open fplot.ps

<div onclick="elm = document.getElementById('fig1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to view the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig1">{:/}
![Example 2.1](https://lordcephei.github.io/assets/img/fplot1.svg)
{::nomarkdown}</div>{:/}

Some useful points to note:

+ A square box is drawn around the figure.  You can select the width and height of the box; see `-frme` below, or try\\
  `$ fplot -frme .1,.9,.3,.7 -ord ...`
+ For log scales, modify `-frme` with `:lx` or `:ly` or both, e.g.
  `$ fplot -frme:ly 0,1,0,1 -ord ...`
+ By default all four edges of the box are drawn.  You can draw any combination of the four (`-frmt`) or shade the box; e.g.\\
  `$ fplot -frmt th=6,1,1 -ord ...`  or  `fplot -frmt col=.8,.9,.9,th=0 -ord ...`
+ You can also draw the abscissa and ordinate through some middle point (`-frme:xor` and `-frme:yab`), e.g.\\
  `$ fplot -frme:xor=.5:yab=.675 0,1,0,1 -ord ...`
+ You have considerable flexibility in controlling major and minor tic marks on the abscissa and ordinate (`-tmx` and `-tmy`), e.g.\\
  `$ fplot -tmx '.25;1~.02' -tmy '.1:5' -ord ...`
+ There is considerable flexibility in controlling the tic mark placement, font (`-font`)
  and formatting of the numbers (`-fmtnx` and `-fmtny`), whether they are suppressed (`-noxn` and `-noyn`) and where numbering is placed (`-xn` and `-yn`), e.g.\\
  `$ fplot '-fmtnx:%;2,2d' -fmtny:%e -ord ...`
+ You can control many aspects of the line type (`-lt`), e.g.\\
  `$ fplot -lt 3,bold=4,col=1,0,0 -ord ...`
+ The abscissa ranges from -0.1 to 2.1; the ordinate from -0.033 to +0.71. They were found automatically by finding the largest and smallest
  values in the frame, and padding the range by 10%.  You can specify the padding (`-pad`) and/or the bounds (`-x` and `-y`), e.g.\\
  `$ fplot -x .2,.3 -y .3,.6 -p0 -ord ...`
+ Labels can be added, e.g. in the following you should see a label centered at (1.2,0.5) similar to: &nbsp;&Delta;<i>k</i><sub>&perp;</sub>/<i>k</i><sub>0</sub>.
  Note that the string has Greek and italic symbols, subscripts and special character &perp;.
  These are accomplished through curly brackets **{...}**.
  <pre>$ fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02 -lbl 1.2,0.5 cc '~{D}&{k}_{~&#123;&#123;\136&#125;&#125;}/&{k}_{0}'</pre>

#### Example 2.2. &nbsp; Reading fplot commands from a script file
{::comment}
/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file
{:/comment}

Except for very simple cases, figures are too involved to invoked entirely from a command line.
Usually commands are be read from an input file (script file).

The following example presents a graphical solution to the Schrodinger equation for a particle in a box of width _L_ and potential depth <i>V<sub>0</sub></i>.
The quantization condition for wave number _k_ reads:

$$ \frac{\mathrm{cos}^2kL}{k^2L^2} = \frac{\hbar ^2}{2mV_0L^2} \quad\quad\quad\quad (1) $$

It is a nonlinear equation in _k_ which must be solved numerically or graphically.  The latter is accomplished by drawing the left and right sides of Eq. (1)
and seeing where the curves intersect.  It is convenient to work with the dimensionless parameter _x_=_kL_ and the right hand site as a dimensionless constant.

Cut and paste the box below into script file _plot.box_{: style="color: green"}.

~~~
fplot
  -frme 0,1,0,0.5 -frmt th=3,1,1 -tmx 1:1;.04 -tmy 0;0 -noyn -noxn -p0
  -lt 1,bold=5,col=0,.3,.8 -ord cos(x)*cos(x)/x/x -tp 1.1:15:.01
  -lt 2,bold=4,col=.8,.3,.0 -ord .015 -tp 1,10
  -lbl 15,-.0005 cc x
~~~

Create and view the postscript file:

~~~
$ fplot -f plot.box
$ open fplot.ps
~~~

Points to note:

+ The script file must contain a line [beginning with **fplot**](/docs/misc/fplot/#init-switches-must-occur-first).  Subsequent indented comprise the instructions
  to **fplot**{: style="color: blue"}.
+ The script file is read through the [file preprocessor](/docs/input/preprocessor/).  (In this example there are no special preprocessor instructions.)
+ Multiple _xy_ curves are drawn by stringing together (**DATA-switches data-file**) pairs.\\
  In this case the left hand side of Eq.(1) is drawn in blue-green (**_r_,_g_,_b_ = 0,0.3,0.8**),
  followed by a reddish dashed horizontal line at _y_=0.015.\
  (There are five solutions where the two curves intersect.  As <i>V<sub>0</sub></i> increases the rhs becomes smaller and more solutions appear).
+ Tic marks on the _x_ axis are all the same size while those on the _y_ axis are suppressed.

When commands are read from a script file, some differences can appear.
+ There is no unix wild-card expansion; quotation marks are not necessary.
+ Because scripts are run through the [file preprocessor](/docs/input/preprocessor/), the script system provides programming language capability and string substitution.

The last figure in Example 2.1 can be equivalently made by
<pre>
$ echo fplot  -ord '20*x^2*exp(-4*x)' -tp .02:2:.02 -lbl 1.0,0.5:0 cc '~\{D}&\{k}_\{~\{\{\136}}}/&\{k}_\{0}' > myplot
$ fplot -f myplot
</pre>

Note that the label now contains backslashes.  You must include the backslash to [suppress the file preprocessor's string substitution](/docs/misc/fplot/#file-preprocessor).

#### Example 2.3. &nbsp; _Charge density contours in Cr_
{::comment}
/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr
{:/comment}

It is usually more convenient to make scripts for fplot, especially when the figure is complex.
This figure shows a contour plot of the charge density of the Cr charge density in (100), (011) plane,
with quality almost good enough for publication in a journal.

In this example commands are read from script _fplot.cr_{: style="color: green"}.
To make this plot you will need to copy the already-prepared charge density contour file [chgd.cr](../../../assets/download/inputfiles/chgd.cr) to your working directory,
and cut and paste the script in the box below to _plot.cr_{: style="color: green"}.

~~~
fplot
  -frme 0,0.5,0,sqrt(0.5) -tmx '1;0' -tmy '1;0' -noxn -noyn
  -x 0,1 -y 0,1
  -con .045,.055 -lt 2,bold=3,col=.4,0,0 chgd.cr
  -con .065,.075 -lt 3,bold=4,col=0,0,0 chgd.cr
  -font h13
  -lblu 0.17,0.556 cc '45'
  -lblu 0.28,0.355 cc '55'
  -font t14
  -lblu .5,-.02 cd 'Charge density in bcc Chromium (10^\{-3} a.u.)'
~~~

Run **fplot**{: style="color: blue"} with

    $ fplot -f plot.cr

<div onclick="elm = document.getElementById('fig2'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig2">{:/}
![Example 2.2](https://lordcephei.github.io/assets/img/fplot2.svg)
{::nomarkdown}</div>{:/}

+ Argument `-f` tells **fplot**{: style="color: blue"} that the next argument
  _fplot.cr_{: style="color: green"} is not a command but a file containing a script.
+ The script file is read through the preprocessor before parsing.  In this case there are no preprocessor directives.
+ Commands inside a script work almost exactly as they do on the command line.
  However, in scripts you have to use **\\{...}** for curly brackets, since a simple **{...}**
  will interpreted by the preprocessor as expressions.  Curly brackets can specify superscripts and subscripts, Greek, bold, italic and symbol fonts.
+ **fplot**{: style="color: blue"} draws constant-density contours at 0.045 and 0.055 because of `-con .045,.055`.
  By splitting up the four contours into a pair of `-con` commands, distinct colours and line types can be drawn.
+ Data is read from _chgd.cr_{: style="color: green"}, which must contain _xy_ data. **fplot**{: style="color: blue"} must be
  told how many rows or columns the data has; here it is specified in the first line of _chgd.cr_{: style="color: green"}.
+ Two of the contour values are labelled (`-lblu`) using Helvetica 13pt font; the figure label uses a 14pt Roman font

_____________________________________________________________

### 3. _fplot manual_
{::comment}
/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x
{:/comment}

This manual is written for fplot version 3.50.

Usage:

<pre>
fplot [-INIT-switches] [-FORMAT-switches] [-DATA-switches] <i>data-file</i> ...
</pre>


##### **INIT** switches must occur first
{::comment}
/docs/misc/fplot/#init-switches-must-occur-first
{:/comment}

+ **\-\-h | \-\-help**\\
  print out a help message and exits.
+ **-rot**\\
  rotate figure 90 by degrees
+ **-pr#**\\
  set the standard output verbosity to #
+ **-disp[:lus]**\\
  display picture in a subshell.
  Option :l or :u or :s draws in landscape, upside-down, seascape.\\
  _Note:_{: style="color: red"} to use this feature you must compile
  **fplot**{: style="color: blue"} with a viewer available your machine.\\
  Customize string **dispfn** near the beginning of **fplot.f**.
+ **-plaintext**\\
  assume strings have no non-ASCII characters (superscripts, subscripts, etc).
+ **-f <i>script-file</i>**\\
  read remaining arguments from input file <b><i>script-file</i></b>.\\
  _Note:_{: style="color: red"} the script file is [run through the file preprocessor](/docs/misc/fplot/#file-preprocessor) before parsing.\\
  The input (script) file must contain a line beginning with **fplot** in the first column.
  This plays the role of a _category_ in the Questaal [input system](/docs/input/inputfile/#input-file-structure).
  **fplot**{: style="color: blue"} will skip over lines until it finds one beginning with **fplot** in the first column.
  It will begin to parse arguments as though they are read from the command-line until end-of-file is encountered, or a line begins
  with a character in the first column, or it is terminated by preprocessor instruction such as **% exit**.

  [Example 2.2](/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file) provides an example.

##### **FORMAT** switches govern frame layout and labels.
{::comment}
/docs/misc/fplot/#format-switches-govern-frame-layout-and-labels
{:/comment}

A figure is comprised of one or more frames. Each new frame overlays anything below it.

_Note:_{: style="color: red"} by default, **fplot**{: style="color: blue"} draws a frame around the figure
with tic marks and numbering (see [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x)).
These defaults can be modified with the switches in this section.

_Note:_{: style="color: red"} some switches in this and later sections specify colors through, **col=_r_,_g_,_b_**
(RBG conventions red,green,blue)


{::comment}

+ **-frme[:lx|:ly|:lxy][:theta=#][:xor=#][:yab=#] &nbsp;_l_,_r_,_b_,_t_**\\
  creates a new frame in a rectangular box.  _l_,_r_,_b_,_t_ are the left, right, bottom, top edges in "graphics units."\\
  _Note:_{: style="color: red"} "graphics units" are designed so that 0,1,0,1 makes a square
  box with that fits on a sheet of A4 or American size paper with comfortable margins.


{::nomarkdown}<div>{:/}

&nbsp; Option | Function
&nbsp; :lx       |
&nbsp; :ly       |
&nbsp; :lxy      |
&nbsp; :xor=#    |
&nbsp; :yab=#    |
&nbsp; :theta=#  |

{::nomarkdown}</div>{:/}

{:/comment}

+ **-frme[:lx|:ly|:lxy][:theta=#][:xor=#][:yab=#] &nbsp;_l_,_r_,_b_,_t_**\\
  starts a new frame, in box.  _l_,_r_,_b_,_t_ are left, right, bottom, top in "graphics units."\\
  _Note:_{: style="color: red"} "graphics units" are designed so that 0,1,0,1 makes a square
  box with that fits on a sheet of A4 or American size paper with comfortable margins.
  Options to **-frme** are:\\
  + **:lx**          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; draw abscissa on a logarithmic scale.
  + **:ly**          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; draw ordinate on a logarithmic scale.
  + **:lxy**         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   draw both abscissa and ordinate on a logarithmic scale.
  + **:xor=#**       &nbsp;&nbsp;&nbsp;&nbsp;                   draw vertical axis at x=#.
  + **:yab=#**       &nbsp;&nbsp;&nbsp;&nbsp;                   draw horizontal axis at y=#.
  + **:theta=#**     angle between abscissa and ordinate (in radians)<br/>

<i> </i>

+ **-frmt &nbsp; [col=_r_,_g_,_b_,][th=#1[,#2,#3]]**\\
  Sets parameters governing the drawing of frame.
  + **col=_r_,_g_,_b_** specify the line color for the frame (RBG conventions red,green,blue)
  + **th=#1[,#2,#3]** specifies the line thickness and which lines are drawn:\\
    **#1** sets line thickness. &nbsp; &minus;1 draws no frame.  &nbsp; Default value is 3.\\
    **#2** set to:&nbsp;  **0** for top and bottom;&nbsp; **1** for bottom only;&nbsp; **2** for top only;&nbsp; **3** for neither.\\
    **#3** set to:&nbsp;  **0** for left and right;&nbsp; **1** for left only;&nbsp; **2** for right only;&nbsp; **3** for neither.

<i> </i>

+ **-tmx** \| **-tmy &nbsp; spacing[:mt][,pos][;rmt][~rmnt][@mode]**\\
  tic mark specification and attributes.
  + **spacing**  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                  spacing between tics (spacing may be modified by **@mode**, below)
  + **\:mt**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no. tics per major tic
  + **,pos**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 position and size of major tic
  + **;rmt**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 size of major tic
  + **\~rmnt**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                             size of minor tic, relative to major tic
  + **@mode**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                1,2,3 for log;  mode=5 => caller specifies tics,

<i> </i>

+  **-x &nbsp; <i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>** \\
    specifies range in abscissa : <i>x</i><sub>1</sub> = left edge, <i>x</i><sub>2</sub> = right edge (modified by padding **-p#** as described below).\\
    If this switch is not supplied, **fplot**{: style="color: blue"} will make an initial pass through all the data in the current frame to determine
    the globally smallest and largest abscissa values, and use them for <i>x</i><sub>1</sub> and <i>x</i><sub>2</sub>.
+  **-y &nbsp; <i>y</i><sub>1</sub>,<i>y</i><sub>2</sub>**\\
    specifies range in ordinate : <i>y</i><sub>1</sub> = bottom edge, <i>y</i><sub>2</sub> = top edge (modified by padding **-p#** as described below).\\
    If this switch is not supplied, **fplot**{: style="color: blue"} will make an initial pass through all the data in the current frame to determine
    the globally smallest and largest ordinate values, and use them for <i>y</i><sub>1</sub> and <i>y</i><sub>2</sub>.
+  **-p#**\\
   pads bounds of abscissa and ordinate by adding &plusmn;(#/2)&times;(<i>x</i><sub>2</sub>&minus;<i>x</i><sub>1</sub>) to the right (left) boundary,
   and &plusmn;(#/2)&times;(<i>y</i><sub>2</sub>&minus;<i>y</i><sub>1</sub>) to the top (bottom) boundary.
   The default padding factor is 0.1.\\
   _Note:_{: style="color: red"} Even if you specify <i>x</i><sub>1</sub> and <i>x</i><sub>2</sub> or <i>y</i><sub>1</sub> and <i>x</i><sub>2</sub>
   through the **-x** and **-y** switches, they are still padded.    Use `-p0` to suppress padding.\\
   _Note:_{: style="color: red"}  **<i>x</i><sub>1</sub>**, **<i>x</i><sub>2</sub>**, and **<i>y</i><sub>1</sub>**, **<i>y</i><sub>2</sub>** are called "user's units"
   in contrast to "graphics units" and "medium units." These are intermediate units used to facilitate construction of the figure.

+ **-1p**\\
  skip parsing of remaining arguments in the frame for the first pass.  Current values for
   **<i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>** and **<i>y</i><sub>1</sub>,<i>y</i><sub>2</sub>**
  are frozen.

{::comment}
+ **-aspect #\\
  resizes frame to make dy/dx(UU) / dy/dx(MU) = #
{:/comment}

+ **-3d shy[,shx,shz]**\\
  sets up 3-d perspective drawing.\\
  Points are shifted by **shy** (**shx**,**shz**).
  Projection is **x** to right, **z** up, **y** normal to paper.

+ **-rotp rot1[,rot2,...]**
  rotates points around an axis, or a succession of axes (used in conjunction with **-3d**).\\
  _Example_

    **-rotp (0,0,1)pi/4,(0,1,0)pi/3,(0,0,1)pi/2**

rotates the points by the Euler angles &pi;/4, &pi;/3, &pi;/2.  [This document](/docs/misc/rotations/) specifies the syntax of rotations.

##### **LABELLING and NUMBERING** switches govern labels and axis numbering
{::comment}
/docs/misc/fplot/#labelling-and-numbering-switches-govern-labels-and-axis-numbering
{:/comment}

Where labels are used, text inside curly brackets **{..}** may be mapped
into other fonts, depending on the character preceding the brackets.

{::nomarkdown}<div>{:/}

Character  | Function
^{..}      | superscript
\_{..}     | subscript
\~{..}     | Greek
@{..}      | bold
&{..}      | italic

{::nomarkdown}</div>{:/}

_Example_  :   \~{D}&{k}\_{~&#123;&#123;\136&#125;&#125;}/&{k}\_{0}\\
will be drawn as &nbsp; &Delta;<i>k</i><sub>&perp;</sub>/<i>k</i><sub>0</sub>.  (<b>\136</b> is the postscript symbol for &perp;.)

_Note:_{: style="color: red"} When using **{..}** in an **fplot**{: style="color: blue"} script file, you must
[prepend the left bracket with a '**\\**'.](/docs/misc/fplot/#file-preprocessor) to avoid substitution by the preprocessor.

_Example modified for script file_ : &nbsp; \~\\{D}&\\{k}\_\\{~\&#123;\&#123;\136&#125;&#125;}/&\\{k}\_\\{0}

+ **-lbl[um] _x_,_y_[:0] _cc_[,rot=#] _string_ [_tex-string_]**\\
  writes **_string_** at (**_x_**, **_y_**).
  + **-lblu** indicates _x_ and _y_ are in user's units (**-lbl** does the same);&nbsp; **-lblm** indicates medium units.
  + Optional **:0** tells **fplot**{: style="color: blue"} to write without initially creating a blank rectangle in the text box.\\
    By default, a blank space is created before the text is written.
  + **_cc_**  is a sequence of two characters specifying the justification of **_string_**.\\
     The first character is one of &nbsp; **l**, **c**, **r** &nbsp; corresponding to left, center, right justification;\\
     The second is one of &nbsp; **u**, **c**, **d** &nbsp; corresponding to up, center, down justification.
  + Alternatively, **_cc_** is **tx,** which flags **fplot**{: style="color: blue"} to run the postscript file through latex with string substitutions.\\
    In that case: **_tex-string_** is the actual (TeX) string and is required;  <b>_string_</b> is merely a tag needed for latex processing.

<i> </i>

+ **-lblx _xlst_ _y_[:0] _cc_ _str1_ _str2_ ...  &nbsp;&nbsp;** \| **&nbsp;&nbsp; -lbly ylst x[:0] _cc_ str1 str2 ...**\\
  puts labels **_str1_**, **_str2_**,  at a list **_xlst_** (**_ylst_**) of points on the **_x_** axis (**_y_** axis) for a given
  value of **_y_** (**_x_**).  The number of strings must match the number of elements in **_xlst_**.
  + Optional **:0** tells **fplot**{: style="color: blue"} to write without initially creating a blank rectangle in the text box.\\
  + **_cc_** has the same meaning as for `-lbl`.

<i> </i>

+ <b> -xl _str_ &nbsp;&nbsp; </b> \| &nbsp;&nbsp; <b> -yl _str_ </b> &nbsp;&nbsp; \| &nbsp;&nbsp; <b> -tl _str_ </b>\\
  supplies a label for the abscissa, ordinate, or title (title appears above the frame).\\
  This switch adds no new functionality **-lbl** already has.  It is convenient because it places the label at a reasonable default position.
+ **-fmtnx:_string_ &nbsp;&nbsp;**\|**&nbsp;&nbsp; -fmtny:_string_**\\
  awrite format for _x_ axis or _y_ axis label.
+ <b>-noxn \| -noyn </b>\\
  suppress abscissa (ordinate) axis numbering.
+ **-xn:t &nbsp;&nbsp;**\|**&nbsp;&nbsp; -yn:r**\\
  place abscissa (ordinate) axis numbering on right (top) side.

+ **-font t# &nbsp;&nbsp;**\|**&nbsp;&nbsp; -font h#**\\
  Sets the font for labels following this switch to Times Roman (Helvetica) font. &nbsp;
  +  If this switch occurs before the frame is drawn, it affects the font of the axis numbering.
  +  **#** is the size in points.

<i> </i>

+ **-k _x_,_y_[:_len_][,_spacing_][;_style_]**\\
  specifies key position (and length, spacing or style).

##### **DATA** switches draw one or more families of xy data
{::comment}
/docs/misc/fplot/#data-switches-draw-one-or-more-families-of-xy-data
{:/comment}

Within a frame zero or more families of _xy_ data can be drawn.
_xy_ data is typically read from a file; the syntax to plot data in **<i>data-file</i>** is
<pre>
DATA-switches <i>data-file</i> | -tp <i>list</i> [DATA-switches <i>data-file</i> | -tp <i>list</i> ...]
</pre>
**DATA-switches** preceding **<i>data-file</i>** control how data is extracted from **<i>data-file</i>** and the manner in which data is drawn.
For either abscissa arnd ordinate you can select a particular column, or take an algebraic combination involving multiple columns of data.

As an alternative to reading data from a file you can supply it using switch **-tp**.
Most of the examples in [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x) use this form.
[Example 2.2](/docs/misc/fplot/#example-22-nbsp-reading-fplot-commands-from-a-script-file) provides a simple example of two sets of data
plotted in a frame.

+ **-lt _n_[,bold=_b_][,col=#,#,#][,colw=#,#,#][,fill=#][,brk=#][,_la_[,_lb_]][,_la_[,_lb_]]**\\
  Line type specification and attributes.
  + **_n_**         line type
    + **_n_**=0     (use this type when you want to draw symbols at a set of points without any connecting lines)
    + **_n_**=1     solid, unbroken line
    + **_n_**=2     dashed line, or dot-dashed line. Dash lengths specified through **_la_** and **_lb_**.
    + **_n_**=3     dotted line.
  + **bold=_b_**    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line thickness or dot size **_b_**.  Allowed values for **_b_** are 0-9.  Default is 3.
  + **col=#,#,#**   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [line color](/docs/misc/fplot/#color-specification).
  + **colw=#,#,#**  &nbsp;                   First color weight when line is to be drawn with color weights.
  + **fill=#**      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill color.
    + 1 color line with color given by **col**
    + 2 fill the area inside of the curve with color
    + 3 both 1 and 2
  + **brk=1**       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; starts a new line whenever <i>x<sub>i</sub></i> ><i>x<sub>i-1</sub></i>
  + **_la_[,_lb_]** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; length of dash and space (for dashed lines only).
                    Dash length units are designed so 1 makes a "typical" dash size.\\
                    **_la_,_lb_** can be repeated, _viz_ **<i>la</i>1,<i>lb</i>1,<i>la</i>2,<i>lb</i>2** to make a [dot-dashed line](/docs/misc/fplot/#further-exercises).

<i> </i>

+ **-s _S_[:col=#,#,#][clip][bold=#][:fill=#]:_sym1_[,_sym2_ ..]** \\
  Draw a symbol at each point in next **<i>data-file</i>**.  **_S_** is one of twelve symbols listed in the table below.\\
  Each symbol has one or more attributes **_sym1_, _sym2_** that affect the symbol shape (see Table).\\
  Optional switches:
  + **col=#,#,#** &nbsp;                                      fill color or color of symbol contour
  + **clip**      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  If present, clips symbols that fall outside frame
  + **bold=_b_**  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line thickness for symbol contour. **bold=0** => fill symbol without contour.
  + **fill=_f_**  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              controls how symbol is filled:
    + <b>_f_</b>=0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do not fill symbol
    + <b>_f_</b>=1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill symbol with gray.  Specify shading with **col=#**.
    + <b>_f_</b>=2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fill symbol with [color](/docs/misc/fplot/#color-specification) given by **col=#,#,#**.
  + <b>_sym1_, _sym2_,..</b> optional symbol attributes that alter size and shape of symbol.  The meaning and number of attributes depends on the symbol (see Table).\\
  **_S_** is specified in one of the following ways:\\
  **_S_** is one of the strings in the table below, e.g. **square** (only the first four characters are necessary)\\
  **_S_** is an index 1-12, listed in the table below\\
  **_S_** = &minus;1. This causes **fplot**{: style="color: blue"} to read **S** and the modifiers **_sym1_, _sym2_** from **<i>data-file</i>**.\\
  Columns of **<i>data-file</i>** must hold: &nbsp;  4: symbol type  (1=>arrow 2=>cone)  5-7: color  8-*, symbol attributes

  {::nomarkdown}<div>{:/}

  <b><i>S</i></b> | index | sym1       		| sym2              | sym3               | sym4       | sym5           | sym6      |
    x             | 1     | width      		| height            |                    |            |                |           |
    square        | 2     | width      		| height            |                    |            |                |           |
    diamond       | 3     | width      		| height            |                    |            |                |           |
    +             | 4     | width      		| height            |                    |            |                |           |
    polygon       | 5     | size       		| number of sides   | angle              |            |                |           |
    circle        | 6     | radius     		|                   |                    |            |                |           |
    arrow         | 7     | &Delta;<i>x</i> | &Delta;<i>y</i>   | _head length_      | _head angle_ | _axis proj_    | _shift_   |
    errbar        | 8     | width      		| height&times;z    |                    |            	|                |           |
    timeline      | 9     | end height 		| line thickness    | end thickness      |            |                |           |
    hist          | 10    | width      		|                   |                    |            |                |           |
    row           | 11    | scale      		| offset            |                    |            |                |           |
    wiggle        | 12    | xtail      		| ytail             | # periods          | excursion  | # pts          | placement |

  {::nomarkdown}</div>{:/}

  Notes on the Table:
  + Some symbols (**timeline** and **hist**) require three numbers _x_, _y_, _z_ for each point.  By default these points are taken from columns 1,2,3 of **<i>data-file</i>**.
  + Where feasible symbol attributes take default values if not specified.  **sym1** defaults to 1.
  + Symbols 1-4 have a optional width and height attribute given by **sym1** and **sym2**. (Note **square** can be a rectangle). **sym2** defaults to **sym1**.
  + Symbol 5 requires two attributes : size and number of sides.  The third attribute (angle of 1st point) is optional.
  + Symbol 6 uses only one attribute.  Its default value is 1.
  + Symbol 7 draws arrows putting the arrow tip at (_x_, _y_).  It requires seven attributes:
    + &Delta;<i>x</i> and &Delta;<i>y</i> are the endpoint of the tail relative to the tip (graphics units)\\
    + _head length_ is the size of the head as a fraction of arrow length\\
    + _head angle_ is the angle subtended by the arrowhead\\
    + _axis proj_  the head length along the arrow axis as a fraction of arrow length\\
    + _shift_ shifts the head so that


+ **-l[0] _legend_**\\
  Add **_legend_** to key for this data set. &nbsp; Optional 0 suppresses blanking of the box where the legend is written.\\
  Switch is operative only if a key was originally specified.

+ **-tp [_nc_~]_list_**\\
  generates a table of points.  Optional **_nc_~** specifies the number columns in the list (defaults to 1).

+ **-map [-i _expr_] _list_**\\
  permutes rows original data array defined by **_list_**.\\
  Optional **-i _expr_** causes points for which **_expr_=0** to be removed from**_list_**.\\
  The syntax of integer lists is described on [this page](/docs/misc/integerlists/).\\
  _Example_ : &nbsp;&nbsp **-map -i 'x<=4' 1,3,5,4**\\
  This will return a data array of at most 4 rows (rows 1,3,5,4); additionally any of the new list is excluded if the first column is less than or equal to 4.

+ **-itrp _x1_,_x2_,_dx_[,_ifrat_][,_nord_]**\\
  interpolates data to a uniform mesh of points in the range (**_x1_,_x2_**)
  spaced by **_dx_**, using a polynomial.\\
  Set optional **_ifrat_** to 1 if to use a rational polynomial instead.\\
  Optional **_nord_** specifies the polynomial order.

+ **-sort**\\
  sort data in ascending abscissa order (after mapping).

+ **-con[:options] _ylist_ [other DATA-switches] _data-file_**\\
  special mode for contour plots. **_ylist_** is a list of real numbers.\\
  This mode draws contours of constant _f_=**#**, interpolating data from **_data-file_**.\\
  **_data-file_** must consist of function values _f_(<i>x<sub>i</sub></i>,<i>y<sub>i</sub></i>)
  on a uniform rectangular grid of points (<i>x<sub>i</sub></i>,<i>y<sub>i</sub></i>).\\
  Elements in a fixed COLUMN contains data on a uniform mesh parallel to abscissa, _f_(<i>x<sub>i</sub></i>,<i>y</i>=const).\\
  Elements in a fixed ROW contains data on a uniform mesh parallel to ordinate, _f_(<i>x</i>=const,<i>y<sub>i</sub></i>).\\
  Bottom and top (left and right) edges of frame correspond to first and last columns (rows) of data.\\
  Options:
  + **:dup=#1[,#2]** Duplicate row (col) data #1 (#2) times
  + **:fn=_filename_** writes xy pen moves to file **_filename_**.
  + **:noclose** suppresses closing contours on boundaries.
  See [Example 2.2](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr) above.\\
  The syntax of lists is described on [this page](/docs/misc/integerlists/).

+ **-r:switches [other DATA-switches] _data-file_**\\
  switches that tell **fplot**{: style="color: blue"} how to manage **_data-file_** where data is read.
  All **switches** are optional; they are separated by a colon:
  + **qr**        read with fortran read (fast, no algebra; useful for large files)
  + **br**        read from binary file
  + **s=#**       skips # records before reading
  + **open**      leaves file open after reading
+ **-nc=_n_**\\
  stipulate that the next **_data-file_** (following the remaining **DATA-switches** has **_n_** columns.
+ **-qr**\\
  same function as -r:qr
+ **-br**\\
  same function as -r:br

+ **-ord _expr_**\\
  substitute **expr** for the ordinate. [Example 2.1](/docs/misc/fplot/#example-21-nbsp-plot-y20x2exp-4x) above shows some examples.
+ **-ab  _expr_**\\
  substitute **expr** for the abscissa.\\
  Expression can contain variables **x_j_*# where **_j_** is column j
+ **-abf _expr_**\\
  maps numbering and tic marks on abscissa to **expr**
+ **-col _cx_,_cy_[,_cw_]**\\
  Use column **_cx_** for the abscissa and column **_cy_** for the ordinate.

+ **-colsy _list_**\\
  make a family of _xy_ plots for columns in list.
  The syntax of integer lists is described on [this page](/docs/misc/integerlists/).\\
  If the data consists of a single column, it is copied to column 2 and the row index is copied to column 1.\\
  Thus `fplot -colsy 2 ...` plots the column with row index on the abscissa.

+ **-colsw _list_**\\
  corresponding list of columns for (color) weights.

+ **-ey #[,dx,shfty]**\\
  Use this switch to make error bars in _y_ from one column of data. Column **#** contains the error bar.

+ **-ins _strn_**\\
  insert **_strn_** directly into output postscript file.
  There is no check that **_strn_** consists of valid postscript ... you are on your own!
+ **-ins[f] _file_**\\
  insert the contents of **_file_** directly into output postscript file.

+ **-bs _radius_[;file-list]**\\
  (3D only) connects points within radius and file-list.

_____________________________________________________________

### 4. _Additional notes_
{::comment}
/docs/misc/fplot/#additional-notes
{:/comment}

#### File preprocessor
{::comment}
/docs/misc/fplot/#file-preprocessor
{:/comment}

Both script files and data files are by default run through the [file preprocessor](/docs/input/preprocessor/).
This provides programming capability in the script files.

_Curly brackets_ : the preprocessor interprets [curly brackets as expressions](/docs/input/preprocessor/#curly-brackets-contain-expressions)
and substitutes them.
However **fplot**{: style="color: blue"} uses curly brackets to
[substitute fonts](/docs/misc/fplot/#labelling-and-numbering-switches-govern-labels-and-axis-numbering) in labels.  To keep the curly
bracket pair and its contents intact, you must suppress the preprocessor's expression substitution.  Do this by prepending **{strn}** with a
backslash, _viz_ **\\{strn}**.  The preprocessor will remove the backslash but leave **{strn}** unaltered.

#### Color specification
{::comment}
/docs/misc/fplot/#color-specification
{:/comment}

Some switches specify colors through, **col=_r_,_g_,_b_**.  These are RBG conventions (red, green, blue) expressed as
a fraction of the brightest color.  0 is the absence of color, and 1 is the brightest color.

#### Structure of data files

Data files follow a standard Questaal format.  The more secure way to specify the number
of rows and columns in the file is indicate it in the first column.  The charge density file _chgd.cr_{: style="color: green"} in Example
[Example 2.3](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr) begins with

~~~~
% rows 101 cols 101
      0.0570627197      0.0576345670      0.0595726102      0.0628546738
...
~~~


+ Data is read from _chgd.cr_{: style="color: green"}.  It contains 101 rows and 101 columns; but this is not evident from the file itself.
  The script tells **fplot**{: style="color: blue"} that the file contains 101 columns with `nc -101`; it works out the number of rows from
  the file contents.


### 5. _Further exercises_
{::comment}
/docs/misc/fplot/#further-exercises
{:/comment}

#### Dot-dashed lines

[Example 2.2](/docs/misc/fplot/#example-23-nbsp-charge-density-contours-in-cr) made
a horizontal dashed line.  Try substituting the following line type for the dashed line:

~~~
-lt 2,bold=4,col=.8,.3,.0,1,.5,.3,.5
~~~

It should generate a dot-dashed line.  The sequence **1,.5,.3,.5** specifies
the dot-dashed sequence. **1,.5,** specifies a dash length 1 followed by a dash length 0.5.
In this case a second sequence (**.3,.5**) is present.  This specifies a (line,space) pair of **1,.5,**
is followed by a (line,space) pair of **.3,.5,**.  The sequences alternate.

_____________________________________________________________

### 6. _Other resources_

See the [plbnds](/docs/misc/plbnds/) and [pldos](/docs/misc/pldos/) manuals.


{::comment}
Need to explain

cw in
+ **-col _cx_,_cy_[,_cw_]**\\

+ bs

+ more on map.  Eg. variable nr.

+ expand on -tp

expand on -map
{:/comment}
