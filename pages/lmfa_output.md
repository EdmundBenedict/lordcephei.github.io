---
layout: page-fullwidth
title: "Annotated standard output, program lmfa"
subheadline: ""
show_meta: false
teaser: ""
permalink: "/docs/outputs/lmfa_output/"
header: no
---

_____________________________________________________________

### _Purpose_
{:.no_toc}

This page details the output generated by the free atomic code **lmfa**{: style="color: blue"}.

_____________________________________________________________

### _Table of Contents_
{:.no_toc}
*  Auto generated table of contents
{:toc}

The output documented here is mostly taken from the **lmf**{: style="color: blue"}
[tutorial for PbTe](/tutorial/lmf/lmf_pbte_tutorial/).
Some portions are adapted from other calculations, as will be indicated.

The standard output is organised by blocks.  The sections below
annotate each block approximately in the order they are made.

Some parts are similar to the [**lmf**{: style="color: blue"} output](/docs/outputs/lmf_output/); in places where they are similar a cursory
treatment is given here; the reader is referred to that page.

_Note:_{: style="color: red"} This document is annotated for an output vebosity of 35 (medium verbosity)
Raising the verbosity causes **lmfa**{: style="color: blue"} to print additional information.
Verbosity 31 is a little terse; verbosity 41 is a little verbose.

### Preprocessor's transformation of the input file
{::comment}
/docs/outputs/lmfa_output/#preprocessors-transformation-of-the-input-file
{:/comment}

The input file is run through the [preprocessor](/docs/input/preprocessor/), which modifies the ctrl file before it it is parsed for tags.
Normally it does this silently.  To see the effects of the preprocessor use `lmfa --showp ...`

The result is very similar to `lmf --showp ...`, which is documented 
[here](/docs/outputs/lmf_output/#preprocessors-transformation-of-the-input-file/).

### How lmf and lmfa read input differently
{::comment}
/docs/outputs/lmfa_output/#how-lmf-and-lmfa-read-input-differently
{:/comment}

To see what tags **lmfa**{: style="color: blue"} will look for, use `lmfa --input`.  [This web
page](/docs/input/inputfile/#help-with-finding-tokens) explains what `--input` gives you.

The result is similar to [**lmf**{: style="color: blue"} produces](/docs/outputs/lmf_output/#display-tags-parsed-in-the-input-file).
However **lmfa**{: style="color: blue"} parses fewer tags; moreoever, some tags they both parse
have different meanings.

<div onclick="elm = document.getElementById('input'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
<span style="text-decoration:underline;">Click here to compare input tags in lmfa to lmf.</span>
</div>{::nomarkdown}<div style="display:none;padding:0px;" id="input">{:/}

Add `--input` to the **lmfa**{: style="color: blue"} and **lmf**{: style="color: blue"} commands

~~~
$ lmfa ctrl.pbte --input > out.lmfa
$ lmf  ctrl.pbte --input > out.lmf
~~~
The output is quite verbose so only some differences are highlighted.

This appears in the **lmf**{: style="color: blue"} output

~~~
 --- Parameters for hamiltonian ---
 gmax                   reqd*  r8       1,  1
   (alias for HAM_GMAX)
   Energy cutoff for plane-wave mesh (Ry)
 - If preceding token is not parsed, attempt to read the following:
~~~

**lmfa**{: style="color: blue"} does not read **EXPRESS_gmax** (alias for **HAM_GMAX**).
For this reason you don't need to specify it when running **lmfa**{: style="color: blue"}, 
but do need to when running **lmf**{: style="color: blue"}.  Similarly, **lmfa**{: style="color: blue"} does not read
**BZ_NKABC** (another tag **lmf**{: style="color: blue"} requires), and many other tags that are optional in **lmf**{: style="color: blue"},
e.g. **HAM_SO**.

**lmfa**{: style="color: blue"} looks for this tag, but **lmf**{: style="color: blue"} does not:

~~~
 autobas_lmto           opt    i4       1,  1     default = 0
   (alias for HAM_AUTOBAS_LMTO)
   Controls lmfa's autogeneration of LMTO basis parameters (RSMH,EH,RSMH2,EH2)
~~~

Two others **lmfa**{: style="color: blue"} looks for but **lmf**{: style="color: blue"} does not are &nbsp;**SPEC\_ATOM\_Q**&nbsp; and &nbsp;**SPEC\_ATOM\_MMOM**.
These affect the construction of the [atomic charge density](/docs/outputs/lmfa_output/#self-consistent-density-of-atoms).

The following tag is read by both codes, but the meaning differs.  From the output of **lmfa**{: style="color: blue"}:

~~~
 autobas_mto            opt    i4       1,  1     default = 0
   (alias for HAM_AUTOBAS_MTO)
   Controls lmfa's autogeneration of LMTO basis parameters (RSMH,EH,RSMH2,EH2)
   0 do not autogenerate basis parameters
   1 or 3 1-kappa parameters with Z-dependent LMX
   2 or 4 2-kappa parameters with Z-dependent LMX
   ...
~~~

From the output of **lmf**{: style="color: blue"}:

~~~
 autobas_mto            opt    i4       1,  1     default = 0
   (alias for HAM_AUTOBAS_MTO)
   Autoset basis:  controls what part of MTO basis is read from basis file basp
   0       No parameters are read from basp
   ...
~~~


In the first case the token affects how the basis parameters are _generated_; 
in the second how the basis parameters are _read_.
The same applies to **HAM_AUTOBAS_PNU** and **HAM_AUTOBAS_LOC**;
also **HAM_AUTOBAS_PFLOAT** have different meanings.

{::nomarkdown}</div>{:/}

After transformation by the preprocessor, **lmfa**{: style="color: blue"} parses for tags and substitutes default values for tags it does not
find.  To see the value of tags **lmfa**{: style="color: blue"}, whether parsed or defaults, use `lmfa --show` or `lmfa --show=2`.  The latter causes **lmfa**{:
style="color: blue"} to stop after displaying tags, and is useful if you want to see whether **lmfa**{: style="color: blue"} is doing what
you expect.  Using `--show` is useful if you want to record the input conditions in the output (be advised that the output is verbose).

The action of `--show` is similar to what occurs with **lmf**{: style="color: blue"}; see
[see annotation of **lmf**{: style="color: blue"} output](/docs/outputs/lmf_output/#display-tags-parsed-in-the-input-file) for further discussion.

### Header, lattice, and symmetry blockss

The header information presents a condensed synopsis of some key
settings that are used in the calculation.  It is similar to the
header table [produced by **lmf**{: style="color: blue"}](/docs/outputs/lmf_output/#header-information).

The next blocks print information about the lattice vectors and settings used in Ewald summations.  This is not relevant for **lmfa**{:
style="color: blue"}; but it is printed out anyway and is identical to [**lmf**{: style="color: blue"}
output](/docs/outputs/lmf_output/#lattice-information).
Similarly for the following block on [symmetry and _k_ mesh](/docs/outputs/lmf_output/#/docs/outputs/lmf_output/#symmetry-and-k-mesh).

### Loop over species
{::comment}
 /docs/outputs/lmfa_output/#loop-over-species
{:/comment}

**lmfa**{: style="color: blue"} begins a loop over each species, and performs the following steps.

#### _Self-consistent density_
{::comment}
 /docs/outputs/lmfa_output/#self-consistent-density
{:/comment}

~~~
 Species Pb:  Z=82  Qc=68  R=3.044814  Q=0
 mesh:   rmt=3.044814  rmax=47.629088  a=0.025  nr=497  nr(rmax)=607
  Pl=  6.5     6.5     5.5     5.5     5.5    
  Ql=  2.0     2.0     10.0    0.0     0.0    

  iter     qint         drho          vh0          rho0          vsum     beta
    1   82.000000   2.667E+04      410.0000    0.4078E+03     -164.7879   0.30
   55   82.000000   4.614E-05     1283.9616    0.3612E+08     -309.4131   0.30

 sumev=-18.068313  etot=-41740.206542  eref=0.000000

~~~


#### _Valence wave functions_
{::comment}
 /docs/outputs/lmfa_output/#valence-wave-functions
{:/comment}

~~~
 Free-atom wavefunctions:
 valence:      eval       node at      max at       c.t.p.   rho(r>rmt)
   6s      -0.91143         1.014       1.961       2.814     0.168779
   6p      -0.27876         1.185       2.643       4.790     0.524423
   5d      -1.56879         0.523       1.073       2.252     0.007786
   5f       0.02051         0.620      34.528      47.629*    1.000000
   5g       0.02823         0.000      35.985      47.629*    1.000000
~~~

#### _Core wave functions_
{::comment}
 /docs/outputs/lmfa_output/#core-wave-functions
{:/comment}

~~~
 core:        ecore       node at      max at       c.t.p.   rho(r>rmt)
   1s   -6465.77343         0.000       0.010       0.022     0.000000
 ...
   4f      -9.79627         0.000       0.350       1.108     0.000000
   5s     -10.60776         0.451       0.789       1.074     0.000002
   5p      -6.31315         0.486       0.882       1.314     0.000052

~~~

#### _Generating basis information_
{::comment}
 /docs/outputs/lmfa_output/#generating-basis-information
{:/comment}

After parsing the ctrl file, **lmfa**{: style="color: blue"} will build some
basis set information which is written to file _basp0.pbte_{: style="color: green"}

<div onclick="elm = document.getElementById('basp'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">
<span style="text-decoration:underline;">Click here for annotation of lmfa's generation of basis parameters.</span>
</div>{::nomarkdown}<div style="display:none;padding:0px;"id="basp">{:/}
{::comment}
text underlined:
<span style="text-decoration:underline;">Click here to compare lmfa's input tags to lmf.</span>
text in colored box:
<button type="button" class="button tiny radius">Click here to compare lmfa's input tags to lmf.</button>
{:/comment}

_basp.pbte_{: style="color: green"} supplies basis information (parameters **EH** and **RSMH** defining the shape of the envelope functions,
["continuous principal quantum numbers](/docs/code/asaoverview/#augmentation-sphere-boundary-conditions-and-continuous-principal-quantum-numbers) _P_
and information about local orbitals).


_On the selection of boundary conditions of partial waves at the augmentation radius_

~~~
 Optimise free-atom basis for species Pb, rmt=3.044814
 l  it    Rsm      Eh     stiffR   stiffE      Eval      Exact     Pnu    Ql
 0  50   1.794  -0.698      88.6    108.3   -0.91141  -0.91143    6.89   2.00
 1  26   2.026  -0.161     182.6    936.8   -0.27824  -0.27876    6.81   2.00
 2  32   1.013  -1.099       3.1      5.0   -1.56878  -1.56879    5.93  10.00
 eigenvalue sum:  exact -18.06831    opt basis -18.06716    error 0.00116

...
 Autogenerated Pnu:  6.895 6.809 6.250 5.183 5.089
~~~

_On identifying local orbitals for shallow cores_

~~~
 Find local orbitals which satisfy E > -2 Ry  or  q(r>rmt) > 5e-3
 l=2  eval=-1.569  Q(r>rmt)=0.0078  PZ=5.934  Use: PZ=15.934
 l=3  eval=-9.796  Q(r>rmt)=3e-8  PZ=4.971  Use: PZ=0.000
~~~

{::nomarkdown}</div>{:/}

#### Fitting the charge density outside the augmentation radius
{::comment}
 /docs/outputs/lmfa_output/#fitting-the-charge-density-outside-the-augmentation-radius
{:/comment}

~~~
 tailsm: fit tails to 6 smoothed hankels, rmt= 3.02869, rsm= 1.51434
 HNSMFT:  85 points in interval  3.02869  24.73301;  q=  1.433395
 E:    -1.00000    -2.00000    -4.00000    -6.00000    -9.00000    -15.0000
 C:    -0.10708    13.99477    -208.816    3199.570    -32652.0    736827.1
        r          rho         fit         diff
    3.028689    0.013779    0.013777    0.000002
    3.888922    0.003349    0.003348    0.000000
    4.993484    0.000541    0.000541    0.000000
    6.411769    0.000054    0.000054    0.000000
    8.232883    0.000003    0.000003    0.000000
    q(fit):     1.433395    rms diff:   0.000002
    fit: r>rmt  1.433395   r<rmt  6.387103   qtot  7.820498
    rho: r>rmt  1.433395   r<rmt  4.566605   qtot  6.000000

 coretail: q=0.00215, rho(rmt)=0.00566.  Fit with Hankel e=-14.401  coeff=639.|
      r            rhoc          fit
    3.028689    0.01975240    0.01975240
    3.347222    0.00650048    0.00651738
    3.792904    0.00136878    0.00136091
    4.297927    0.00023338    0.00022687
    4.870194    0.00003132    0.00002930
    5.518656    0.00000320    0.00000283
    6.253461    0.00000024    0.00000020
    7.086104    0.00000001    0.00000001
~~~

#### Estimating the plane-wave cutoff GMAX
{::comment}
 /docs/outputs/lmfa_output/#estimating-the-plane-wave-cutoff-gmax
{:/comment}

~~~
 FREEAT:  estimate HAM_GMAX from RSMH:  GMAX=4.3 (valence)  7.8 (local orbitals)
~~~

