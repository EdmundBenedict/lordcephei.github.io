<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>LM Suite - Full Potential LDA Tutorial</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="LM Suite - Full Potential LDA Tutorial" /> <meta property="og:description" content="»LM Suite« is a program for for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//fpnew/" /> <meta property="og:site_name" content="LM Suite" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="show-for-small-only"><a href="https://lordcephei.github.io" class="icon-tree"> LM Suite</a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="right"> <script language="Javascript" type="text/javascript"> function google_search() { var query = document.getElementById("google-search").value; window.open("http://google.com/search?q=" + query + "%20site:" + "https://lordcephei.github.io"); } </script> <li class="divider"></li> <li style="background:#FFFFFF"> <form style="width:200px" onsubmit="google_search()" > <input type="text" id="google-search" placeholder="Enter search term and hit enter"> </form> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> </ul> <ul class="left"> <li><a href="https://lordcephei.github.io/">Start</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/blog/">News and Updates</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io/docs/">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/insert/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/install/">Installation</a></li> <li><a href="https://lordcephei.github.io/fplmtoverview/">FP Overview</a></li> <li><a href="https://lordcephei.github.io/fpcapabilities/">FP Capabilities</a></li> <li><a href="https://lordcephei.github.io/inputguide/">The Input File</a></li> <li><a href="https://lordcephei.github.io/opticsdoc/">Optics</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/lmtut/">Basic GW Tutorial</a></li> <li><a href="https://lordcephei.github.io/asadoc/">ASA tutorial</a></li> <li><a href="https://lordcephei.github.io/buildingfpinput/">Building the FP Input File</a></li> <li><a href="https://lordcephei.github.io/fpnew/">Tutorial for the full-potential LDA program lmf</a></li> <li><a href="https://lordcephei.github.io/fpoptbas/">FP basis optimisation</a></li> <li><a href="https://lordcephei.github.io/extbfield/">Adding external Zeeman field to the potential</a></li> <li><a href="https://lordcephei.github.io/fstut/">Generating a Fermi surface in spin polarized Fe</a></li> </ul> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> <li class="divider"></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>LM Suite - Full Potential LDA Tutorial</h1> </header> <p class="teaser"> </p> <h1 id="tutorial-for-the-full-potential-lda-program-lmf-v000">Tutorial For The Full-Potential LDA Program <strong>lmf</strong> (v0.00)</h1> <h3 id="purpose"><em>Purpose</em></h3> <hr /> <p>This tutorial demonstrates the all-electron, full-potential LDA program <strong>lmf</strong>. It:</p> <ol> <li> <p>describes how to build the input file, by categories. You can build input files automatically from structural data, but this section is worth going through nevertheless.</p> </li> <li> <p>Some checks are made and a band pass is explained.</p> </li> <li> <p>The basis set is tuned.</p> </li> <li> <p>explains the output of a self-consistent calculation, and how to create energy bands and density-of-states</p> </li> <li> <p>shows how to compute shear constants <em>c</em><sub>11</sub>−<em>c</em><sub>12</sub> and <em>c</em><sub>44</sub> in Al.</p> </li> </ol> <p>In this tutorial two of the three elastic constants in Al are calculated. Build the input file yourself, or copy <a href="http://titus.phy.qub.ac.uk/packages/LMTO/v7.11/doc/FPsamples/ctrl.al">ctrl.al</a> and skip immediately to the electronic structure calculations.</p> <h3 id="prerequisites"><em>Prerequisites</em></h3> <hr /> <p>You will need the executables <strong>lmchk</strong>, <strong>lm</strong>, <strong>lmstr</strong> etc in your path (all of these are installed when scons is run with the target flag <em>all</em>).</p> <p>It is assumed you have read the ASA documentation and the FP documentation, how the input file is structured and have gone through the ASA tutorial, and you understand how the file preprocessor works.</p> <h3 id="tutorial"><em>Tutorial</em></h3> <hr /> <p>This tutorial gives a brief outline as to the commands and procedures required to use the <strong>lmf</strong> program for users who may have experience with the program already. More detailed instructions can be found in each section should you require them.</p> <p><em>Note:</em> All instances of <em>al</em> in the command lines can be replaced with <em>*ctrl.al*{: style=”color: green”}</em>, depending on what your input file has been named.</p> <h4 id="building-the-input-file"><em>1. Building The Input File</em></h4> <hr /> <p>It is assumed for the tutorial that the specific categories in the input file are known. The sample input file for Al is provided <a href="http://titus.phy.qub.ac.uk/packages/LMTO/v7.11/doc/FPsamples/ctrl.al">here</a>.</p> <p>The input file and all of its categories are properly explained <a href="/fpinputfile/">here</a>.</p> <h4 id="getting-started-analyzing-the-results-of-a-band-pass"><em>2. Getting Started: Analyzing The Results Of A Band Pass</em></h4> <hr /> <p>Use <strong>lmchk</strong> to verify:</p> <ul> <li> <p>The preprocessor works as advertised:</p><pre><code>lmchk al --showp
</code></pre><p>For example, the line containing <em style="color: blue">RSMH=</em> should have been turned into</p><pre><code>RSMH=1.8,1.8,1.8	EH=-.1,-.1,-.1
</code></pre></li> <li> <p>Invoke:</p><pre><code>lmchk al
</code></pre><p>And verify from the output that the sphere overlaps about 0.6% (a safe number) and that sum-of-sphere volumes equals about 75% of the total.</p> </li> </ul> <p>Use <strong>lmfa</strong> to generate densitites for the free atom. Atomic densities will be overlapped to make a first trial density for the solid (Mattheis construction).</p><pre><code>    lmfa al
</code></pre><p>Invoke <strong>lmf</strong> in a non self-consistent mode:</p><pre><code>    lmf al -vhf=1
</code></pre><p>A full description and the output from this command can be found in the extended tutorial <a href="/fpbandpass/">here</a>.</p> <h4 id="optimizing-the-basis-set"><em>3. Optimizing The Basis Set</em></h4> <hr /> <ul> <li> <p>One can optimize RSMH efficiently with:</p> <p>lmf al –optbas</p> <p>You can take the result of the optimized calculation (saved in <em style="color: green">basp2.ext</em>) and copy them to your input file. Or, you can have lmf automatically read these parameters from file basp; tokens in <em style="color: blue">HAM_AUTOBAS</em> control what <strong>lmf</strong> reads from this file, and what <strong>lmfa</strong> writes to it.</p> </li> <li> <p>We might consider the effect of enlarging the basis, which as we noted we can do from the commmand line with <em style="color: blue">-vbigbas=1</em>. Do this:</p> <p>lmf al -vbigbas=1 -vhf=1</p> </li> </ul> <p>Read more about basis sets <a href="/fpbasisset/">here</a>.</p> <h4 id="self-consistent-lda-calculation"><em>4. Self-consistent LDA calculation</em></h4> <hr /> <p>We can do a self-consistent calculation with:</p><pre><code>    lmf al &gt; out 
</code></pre><p>Up to the calculation of the Fermi level the output will be essentially the same.</p> <p>Now the <a href="FPsamples/out.al.lmf#outrho">output density</a> is generated. With the output density, the HKS energy functional can be evaluated. Also the log derivative parameters P are floated to the band centers-of-gravity. How the P’s are floated is prescribed by tokens <a href="tokens.html#SPECcat">IDMOD</a>; there is a corresponding ASA counterpart discussed in the <a href="lmto.html#section2">ASA overview</a>.</p> <p>A <a href="FPsamples/out.al.lmf#mixrho">new density</a> is constructed as follows:</p> <ul> <li> <p>The <em>output density</em> is screened using the model Lindhard function, provided the Lindhard parameter <a href="tokens.html#HAMcat">ELIND</a> is nonzero:</p> <script type="math/tex; mode=display">n_{out}^* = n_{in} + eps^{-1} (n_{out}-n_{in})</script> </li> <li> <p>An estimate for the self-consistent density is made by mixing n<sub>in</sub> and n<sub>out</sub><sup>*</sup> using some <a href="tokens.html#mixing">mixing scheme</a>.</p> </li> <li> <p>The resultant density is <a href="FPsamples/out.al.lmf#iors">saved</a> in <em style="color: green">rst.ext</em>, unless you specify otherwise using <em style="color: blue">–rs=</em>.</p> </li> <li> <p>At the end of the iteration, the total energies are printed and checks are made whether self-consistency is achieved to tolerances specified by <a href="tokens.html#ITERcat">ITER_CONV</a> and <a href="tokens.html#ITERcat">ITER_CONVC</a>. The RMS DQ generated at the <a href="FPsamples/out.al.lmf#mixrho">mixing step</a> is the measure compared against tolerance <a href="tokens.html#ITERcat">CONVC</a>; the change in energy from one iteration to the next is tested against tolerance <a href="tokens.html#ITERcat">CONV</a>. Both tolerances must be satisfied, unless you set CONV=0 or CONVC=0 (0 tolerance tells <strong>lmf</strong> not to test that parameter).</p> </li> </ul> <p>Look at this <a href="/fpldacalc/">page</a> for LDA calculations.</p> <h4 id="shear-constants"><em>5. Shear constants</em></h4> <hr /> <p>This section shows how to calculate two of the three independent shear constants in Al. We first calculate <em>c</em><sub>11</sub>−<em>c</em><sub>12</sub>, which we will do by computing the total energy at different lattice distortions, and fitting the curvature of the total energy. The tetragonal distortion is conveniently generated using the line</p><pre><code>    SHEAR=0 0 1 1+dist 
</code></pre><p>which distorts the lattice in a way that conserves volume to all orders (this is useful because it tends to be less error-prone). The direction of distortion is set by the first three parameters; the lattice will be sheared along (001).</p> <p>The first difficulty is that our specification of the FT mesh using token GMAX may cause the program to switch meshes for as parameter <em>dist</em> changes. This is a bad idea, since we want to resolve very small energy differences. So, the first step is to comment out the line with <em style="color: blue">GMAX=gmax</em> in the input and use instead:</p><pre><code>    FTMESH=10 10 10 
</code></pre><p>The second difficulty is that the shear constants in Al are difficult to converge, because they require many <em>k</em>-points. The following steps are written in ‘tcsh’ and compute the self-consistent total energy parameterically as a function of ‘dist’:</p><pre><code>       rm -f out save.al
       foreach x ( -0.04 -0.03 -0.02 -0.01 0 0.01 0.02 0.03 0.04)
           rm -f mixm.al wkp.al
           lmf al -vdist=$x -vnk=24 --pr20,20 &gt;&gt;out
       end
</code></pre><p>Note that the mixing file eigenvalue weights file (<em style="color: green">mixm.al</em> and <em style="color: green">wkp.al</em>) are deleted for each new shear calculation. File save.al contains total energies ehf for 9 values of dist using 24 divisions of k-points. (To properly converge the calculation use <em style="color: blue">nk=32</em> or even <em style="color: blue">nk=40</em>.)</p> <p>Extracting ehf and ehk parametrically as a function of dist is very easy with the <a href="Building_FP_input_file.html#vextract">vextract</a> tool:</p><pre><code>    cat save.al | startup/vextract c dist ehf &gt; dat 
</code></pre><p>The key ‘c’ tells vextract that you want lines beginning only with ‘c’: these lines correspond to band passes when <a href="Building_FP_input_file.html#vextract">self-consistency</a> was reached. You can use any regular expression for the key. You can ask vextract to extract any quantity associated with a variable in the file.</p> <p>A trigonal shear will yield c<sub>44</sub>. To compute it, replace the SHEAR token with:</p><pre><code>    SHEAR=1 1 1 1+dist 
</code></pre><p>Both of these elastic constants depend on the fitting procedure with an uncertainty of about 5%. A careful calculation would use more points dist and increase nk. The final shear constant, the bulk modulus, you can calculate by varying the lattice constant. We do not do it here, but if you do this, you are advised to use token <em style="color: blue">STRUC_DALAT</em>, rather than change ALAT (see the following note).</p> <h4 id="other-things-to-read-and-do"><em>6. Other things to read and do</em></h4> <hr /> <p>You can generate and plot the energy bands using <strong>lmf</strong>. It proceeds in the same way as in the <a href="/asadoc/">ASA tutorial</a>. Generate the band file this way:</p><pre><code>    cp startup/syml.fcc ./syml.al
    lmf al --band:fn=syml 
</code></pre><p>The generation of the core-level spectroscopy, Mulliken analysis or density-of-states is done first by invoking <strong>lmf</strong> with the appropriate <a href="fp.html#section3">command-line switch</a>, followed by <strong>lmdos</strong>. The <strong>lmdos</strong> step is illustrated (including a way to plot results) in the <a href="/asadoc/">ASA tutorial</a>.</p> <p>To compute the density of states, see <a href="generating-density-of-states.html">this tutorial</a>. To compute core-level EELS spectra or Mulliken analysis in Fe, try running</p><pre><code>    fp/test/test.fp fe 2 
</code></pre><p>To compute total or partial DOS in hcp Co, try running</p><pre><code>    fp/test/test.fp co 2 
</code></pre><p>Read about bandpass <a href="/fpbandpass/">here</a>.</p> <h3 id="further-reading"><em>Further Reading</em></h3> <hr /> <p><strong>lmf</strong> has many other useful features not described in this tutorial. Look at <a href="">this page</a> for information about other tools and kinds of calculations available.</p> <h3 id="issues-or-comments"><em>Issues Or Comments</em></h3> <hr /> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> »LM Suite« is a program for for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> <li class="sitemap-link" > <a href="https://lordcephei.github.io/download/" title="Download the program">Downloads</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> <div id="subfooter"> <nav class="row"> <section id="subfooter-left" class="b30 small-12 medium-6 columns"> <ul class="inline-list"> <li>Created with &hearts; by <a style="display:inline;" href="http://phlow.de/">Phlow</a> with <a style="display:inline;" href="http://jekyllrb.com/" target="_blank">Jekyll</a> using <a style="display:inline;" href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a> </li> </ul> </section> <section id="subfooter-right" class="small-12 medium-6 columns social-icons"> <ul class="inline-list"> <li><a href="http://www.youtube.com/PhlowMedia" target="_blank" class="icon-youtube" title="Videos, Video-Anleitungen und Filme von Phlow auf YouTube"></a></li> <li><a href="http://twitter.com/phlow" target="_blank" class="icon-twitter" title="Immer das Neuste von Phlow gibt es auf Twitter"></a></li> <li><a href="http://www.facebook.com/phlow.media" target="_blank" class="icon-facebook" title="Lass uns Freunde sein!"></a></li> <li><a href="http://soundcloud.com/phlow" target="_blank" class="icon-soundcloud" title="Sounds und Downloads und mehr"></a></li> <li><a href="http://github.com/phlow" target="_blank" class="icon-github" title="Code und mehr..."></a></li> <li><a href="http://instagram.com/phlowmedia" target="_blank" class="icon-instagram" title="Bilder und Impressionen mit und ohne Filter..."></a></li> <li><a href="http://www.pinterest.com/phlowmedia/" target="_blank" class="icon-pinterest" title="Bilder, Fotos, Illustrationen, Grafiken sammeln..."></a></li> <li><a href="http://www.mixcloud.com/phlow/" target="_blank" class="icon-cloud" title="Mixe, was sonst?"></a></li> </ul> </section> </nav> </div><!-- /#subfooter --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
