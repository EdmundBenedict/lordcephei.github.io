<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>The File Preprocessor</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="The File Preprocessor" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//docs/input/preprocessor/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <h1>The File Preprocessor</h1> </header> <h3 id="purpose"><em>Purpose</em></h3> <p>This manual documents the functioning of Questaal’s preprocessor. Many files in the Questaal suite (e.g. the main input file <em style="color: green">ctrl.ext</em>) are read through the prepocessor before they are used.</p> <hr /> <h3 class="no_toc" id="table-of-contents"><em>Table of Contents</em></h3> <ul id="markdown-toc"> <li><a href="#purpose" id="markdown-toc-purpose"><em>Purpose</em></a></li> <li><a href="#main-features" id="markdown-toc-main-features"><em>Main Features</em></a> <ul> <li><a href="#curly-brackets-contain-expressions" id="markdown-toc-curly-brackets-contain-expressions">Curly brackets contain expressions</a></li> <li><a href="#variables" id="markdown-toc-variables">Variables</a></li> <li><a href="#branching-and-looping-constructs" id="markdown-toc-branching-and-looping-constructs">Branching and looping constructs</a></li> </ul> </li> <li><a href="#expression-substitution" id="markdown-toc-expression-substitution"><em>Expression Substitution</em></a> <ul> <li><a href="#further-properties-of-curly-brackets" id="markdown-toc-further-properties-of-curly-brackets">Further properties of curly brackets</a></li> <li><a href="#syntax-of-algebraic-expressions" id="markdown-toc-syntax-of-algebraic-expressions">Syntax of Algebraic Expressions</a></li> <li><a href="#assignment-operators" id="markdown-toc-assignment-operators">Assignment Operators</a></li> <li><a href="#examples-of-expressions" id="markdown-toc-examples-of-expressions">Examples of expressions</a></li> </ul> </li> <li><a href="#preprocessor-directives" id="markdown-toc-preprocessor-directives"><em>Preprocessor Directives</em></a> <ul> <li><a href="#variable-declarations-and-assignments" id="markdown-toc-variable-declarations-and-assignments">Variable declarations and assignments</a></li> <li><a href="#branching-constructs" id="markdown-toc-branching-constructs">Branching constructs</a></li> <li><a href="#looping-constructs" id="markdown-toc-looping-constructs">Looping constructs</a></li> <li><a href="#other-directives" id="markdown-toc-other-directives">Other directives</a></li> </ul> </li> <li><a href="#source-codes" id="markdown-toc-source-codes"><em>Source codes</em></a></li> </ul> <hr /> <h3 id="main-features"><em>Main Features</em></h3> <!-- /docs/input/preprocessor/#main-features --> <p>The preprocessor allows you to declare variables and evaluate expressions. It also possesses some programming language capability, with branching control to skip or loop over a selected block of lines.</p> <p>The preprocesor is built into the source code, <em style="color: green">rdfiln.f</em>. Comments at the beginning of <em style="color: green">rdfiln.f</em> document directives it can process. Here we use <em style="color: green">rdfiln</em> as a name for the preprocessor.</p> <h4 id="curly-brackets-contain-expressions">Curly brackets contain expressions</h4> <!-- /docs/input/preprocessor/#curly-brackets-contain-expressions --> <p><em style="color: green">rdfiln</em> treats curly brackets <strong>{…}</strong> specially and substitutes its contents for <strong>something-else</strong>. Typically <strong>{…}</strong> will contain an algebraic expression, which is evaluated as a binary number and rendered back as an ASCII representation of the number.</p> <p>Thus the line</p><pre><code>    talk {4/2} me
</code></pre><p>becomes</p><pre><code>    talk 2 me
</code></pre><p><strong>{…}</strong> can contain other kinds of syntax as well; see <a href="/docs/input/preprocessor/#expression-substitution">below</a>.</p> <p><em style="color: red">Note:</em> The substitution <font size="+1"><tt>{...}</tt></font>→<font size="+1"><tt><i>string</i></tt></font> may increase the length of the line. If the modified line exceeds the maximum size it is truncated. This maximum length is controlled by parameter <strong>recln0</strong> in the main program. Source codes are distributed with <strong>recln0=120</strong>.</p> <h4 id="variables">Variables</h4> <!-- /docs/input/preprocessor/#variables --> <p>The preprocessor permits three kinds of variables: floating point scalar, floating-point vector, and strings. They can be declared with <a href="/docs/input/preprocessor/#variable-declarations-and-assignments">preprocessor directives</a>. Scalar and character variables can also be declared on the command-line using, e.g.<br /> <code>-vsnam=expr</code>  or  <code>-vcnam=string</code>.</p> <ul> <li>Separate symbol tables are maintained for each of the three kinds of variables.</li> <li>Scalar variables and vector elements can be used in algebraic expressions.</li> <li>Character variables can be used in string expressions (see below).</li> </ul> <p><em style="color: red">Note:</em> As <em style="color: green">rdfiln</em> parses a file, it may create new variables, thus enlarging the symbols table. Variables allocated this way are temporary, however. When <em style="color: green">rdfiln</em> has finished with whatever it is reading, it destroys variables created by preprocessor directives. You can preserve variables for future use with the <strong>% save</strong> directive.</p> <h4 id="branching-and-looping-constructs">Branching and looping constructs</h4> <!-- /docs/input/preprocessor/#branching-and-looping-constructs --> <p>You can <a href="/docs/input/preprocessor/#branching-constructs">conditionally read</a> certain lines of a file, or <a href="/docs/input/preprocessor/#looping-constructs">loop over lines</a> multiple times.</p> <h3 id="expression-substitution"><em>Expression Substitution</em></h3> <!-- /docs/input/preprocessor/#expression-substitution --> <p>Enclosing a string in curly brackets, <em>viz</em> <strong>{strn}</strong>, instructs the preprocessor to parse the contents of  <strong>{strn}</strong>  and substitute it with something else.</p> <p><em style="color: red">Note:</em> To suppress expression substitution, prepend <strong>{strn}</strong> with a backslash, <em>viz</em> <strong>\{strn}</strong>. The preprocessor will remove the backslash but leave <strong>{strn}</strong> unaltered.</p> <p><strong>strn</strong> must take one of the following syntactical forms. If <em style="color: green">rdfiln</em> cannot match the first form, it tries the second, and so on. (It is an error if no form can be matched.) These four forms are as follows, arranged by the precedence they take in parsing:</p> <ul> <li>(<em>string substitution</em>):   <strong>strn</strong> is name of a <strong>character variable</strong>. The value of the variable is substituted.<br /> The variable <em>may</em> be followed by a qualification (see 1a and 1b below).</li> <li>(<em>conditional substitution</em>):   <strong>strn</strong> begins with a “<strong>?</strong>”. An expression is evaluated, which determines what string is substituted. See 2 below.</li> <li>(<em>vector substitution</em>):   <strong>strn</strong> is the name of a vector. The result is the contents of the vector. See 3 below.</li> <li>(<em>expression substitution</em>):   <strong>strn</strong> an algebraic expression. Expressions use C-like syntax. See 4 below.</li> </ul> <p>In more detail, the four rules are as follows:</p> <ol> <li> <p><strong>strn</strong> consists of (or begins with) a character variable, say <strong>mychar</strong>.</p> <p>a. <strong>strn</strong> is a character variable. <em style="color: green">rdfiln</em> replaces <strong>{mychar}</strong> with contents of <strong>mychar</strong>.<br /> <em>Example</em>: If mychar=’foo bar’,    <strong>{mychar} → foo bar</strong>.</p> <p>b. <strong>strn</strong> is a character variable followed by a qualifier (…), which must be one of the following:</p> <ul> <li> <p><strong>(integer1,integer2)</strong> (substring of  <strong>strn</strong>). <strong>{mychar(n1,n2)}</strong> is replaced by the (<strong>n1:n2</strong>) substring of <strong>{mychar}</strong>.<br /> <em>Example</em>: If mychar=”foo bar”, <strong>{mychar(2,3)}</strong> → <strong>oo</strong>.</p> </li> <li> <p><strong>(charlst,n)</strong> (index to charlst). <strong>{mychar(charlst,n)}</strong> returns in index to <strong>{mychar}</strong>. <strong>{mychar}</strong> is parsed for characters in <strong>charlst</strong>, returning the index to the <strong>n</strong>1<sup>th</sup> occurrence; <strong>charlst</strong> is a sequence of characters.<br /> <strong>n</strong> is optional: if omitted, the preprocessor uses <strong>n=1</strong>.<br /> <em>Example</em>: let mychar=”foo bar” and charlst=’abc’. Note that “foo bar” contains characters ‘b’ and ‘a’.<br /> <strong>{mychar(‘abc’,2)} → 6</strong>, because the 6<sup>th</sup> character contains the second occurence of [abc].</p> </li> <li> <p><strong>(:e)</strong> returns an index marking last nonblank character in <strong>{mychar}</strong>.<br /> <em>Example</em>: If mychar=’foo bar’,   <strong>{mychar(:e)} → 7</strong>.</p> </li> <li> <p><strong>(/’strn1’/’strn2’/,n1,n2)</strong> substitutes <strong>strn2</strong> for <strong>strn1</strong>.<br /> Substitutions are made for the <strong>n</strong>1<sup>th</sup> to <strong>n</strong>2<sup>th</sup> occurrence of <strong>strn1</strong>.<br /> <em>Example</em> If <strong>mychar=”foo bar”</strong>, then   <strong>{mychar(/’foo’/’boo’/)}</strong> → “boo bar” <strong>n</strong>1 and <strong>n</strong>2 are optional, as are the quotation marks.</p> </li> </ul> </li> <li> <p><strong>strn</strong> takes the form <strong>{?~</strong><em>expr</em><strong>~strn1~strn2}</strong>   (Note: the ‘~’ can be any character).<br /> <em>expr</em> is an algebraic expression; <strong>strn1</strong> and <strong>strn2</strong> are strings. <em style="color: green">rdfiln</em> returns either <strong>strn1</strong> or <strong>strn2</strong>, depending on the result of <em>expr</em>.<br /> If <em>expr</em> evaluates to nonzero, <strong>{…}</strong> is replaced by <strong>strn1</strong>.; else <strong>{…}</strong> is replaced by <strong>strn2</strong>.<br /> <em>Example:</em>   <strong>{?~(n&lt;2)~n is less than 2~n is at least 2}</strong> :<br /> <strong>{…}</strong>   becomes   “<strong>n is less than 2</strong>“   if <em>n</em>&lt;2; otherwise it becomes <strong>  “n is at least 2”  </strong></p> </li> <li> <p><strong>strn</strong> is name of a vector variable, say <strong>myvec</strong>. <em style="color: green">rdfiln</em> replaces <strong>{myvec}</strong> with a sequence of numbers separated by one space, which are the contents of <strong>myvec</strong>.<br /> <em>Example</em> : suppose <strong>myvec</strong>. has been declared as a 5-element quantity in the following way:<br />    % vec myvec[5] 6-1 6-2 5-2 5-3 4-3<br /> <strong>{myvec}</strong>  will be turned into <strong>5 4 3 2 1</strong> <br /> A single element of a vector acts like a scalar. Thus  <strong>{3*myvec(2)-2}</strong>  becomes <strong>10</strong>.</p> </li> <li> <p><strong>strn</strong> is an algebraic expression composed of numbers combined with unary and binary operators. The syntax is very similar to the C programming language. <em style="color: green">rdfiln</em> parses  <strong>strn</strong>  to obtain a binary number, renders the result in ASCII form, and substitutes the result.</p> <p><em style="color: red">Note:</em> <strong>strn</strong>  may consist of a sequence of expressions, separated by commas. <em style="color: green">rdfiln</em> returns the value of the last expression. A variable should be assigned to each intermediate expression. Assignment may be simple (<strong>=</strong>) or involve an arithmetic operation. <em>Examples:</em></p><pre>
  {x=3}               &larr;  assigns x to 3 and returns '3'
  {x=3,y=4}           &larr;  assigns x to 3 and y to 4, and returns '4'
  {x=3,y=4,x*=y}      &larr;  assigns x to 3*4 and y to 4, and returns '4'
  {x=3,y=4,x*=y,x*2}  &larr;  assigns x to 3*4 and y to 4, and returns '24'
</pre></li> </ol> <h4 id="further-properties-of-curly-brackets">Further properties of curly brackets</h4> <p>Brackets may be nested. <em style="color: green">rdfiln</em> will work recursively through deeper levels of bracketing, substituting <font size="+1"><tt>{..}</tt></font> at each level with a result before returning to the higher level. <br /> <i>Example</i>: Suppose  <strong>{foo}</strong>  evaluates to <strong>2</strong>. Then:</p><pre>  {my{foo}bar}</pre><p>will be transformed into</p><pre>  {my2bar}</pre><p>and finally the result of  <strong>{my2bar}</strong>  evaluated.</p> <p>If <em style="color: green">rdfiln</em> cannot evaluate <font size="+1"><tt>{my2bar}</tt></font> it will abort with a message similar to this one:</p><pre>
 rdfile: bad expression in line
 {  ...  my2bar}
</pre><p><em style="color: red">Note:</em> there is a syntactical difference between <strong>{expr}</strong> and the value of <em>expr</em> itself, because <strong>{expr}</strong> returns an ASCII representation of <em>expr</em>, and precision is lost. Thus  <strong>{pi-3}</strong>  is replaced by <strong>.141592654</strong></p> <h4 id="syntax-of-algebraic-expressions">Syntax of Algebraic Expressions</h4> <p>The general syntax for an expression is a sequence of one or more expressions of the form</p><pre>   {<b>name=</b>expr<b>[,name=</b>expr<b>...]</b>}</pre><p>Commas separate declarations. Arithmetic operators can be used in place of assignment (<strong>=</strong>), for example  <strong>{x=3,y=4,x<em>=y,x</em>2}</strong>. The final expression may (and typically does) consist of an expression only omitting  <strong>name=</strong>.</p> <p><em style="color: red">Note:</em> <em>expr</em> may not contain any whitespace.</p> <p><em>expr</em> has a syntax very similar to C. It is composed of numbers, scalar variables, elements of vector variables, and macros, combined with unary and binary operators.</p><pre>
    <i>Unary</i> operators take first precedence:
    1.   - arithmetic negative
         ~ logical negative (.not.)
           functions abs(), exp(), log(), sin(), asin(), sinh(), cos(), acos()
                     cosh(), tan(), atan(), tanh(), flor(), ceil(), erfc(), sqrt()
           Note: flor() rounds to the next lowest integer; ceil() rounds up.

    The remaining operators are <i>binary</i>, listed here in order of precedence with associativity
    2.   ^  (exponentiation)
    3.   *  (times), / (divide), % (modulus)
    4.   +  (add), - (subtract)
    5.   &lt;  (.lt.); &gt; (.gt.); = (.eq.); &lt;&gt; (.ne.); &lt;= (.le.);  &gt;= (.ge.)
    6.   &amp;  (.and.)
    7.   |  (.or.)
    8&amp;9  ?: conditional operators, used as: **test**?**expr1**:**expr2**
    10&amp;11 () parentheses 
</pre><p>The  <strong>?:</strong>  pair of operators follow a C-like syntax: <strong>test</strong>, <strong>expr1</strong>, and <strong>expr2</strong> are all algebraic expressions.<br /> If <strong>test</strong> is nonzero, <strong>expr1</strong> is evaluated and becomes the result. Otherwise <strong>expr1</strong> is evaluated and becomes the result.</p> <h4 id="assignment-operators">Assignment Operators</h4> <p>The following are the allowed assignment operators:</p><pre>
  assignment-op         function
    '='            simple assignment
    '*='           replace 'var' by var*expr
    '/='           replace 'var' by var/expr
    '+='           replace 'var' by var+expr
    '-='           replace 'var' by var-expr
    '^-'           replace 'var' by var^expr
</pre><h4 id="examples-of-expressions">Examples of expressions</h4> <p>Suppose that the variables table looks like:</p><pre>
   Var       Name                 Val
    1        t                   1.0000
    2        f                  0.00000
    3        pi                  3.1416
    4        a                   2.0000
 ...
   Vec       Name            Size   Val[1..n]
    1        firstnums          5    1.0000        5.0000
    2        nextnums           5    6.0000        10.000
 ...
     char symbol                     value
    1 c                               half
    2 a                               whole
    3 blank
</pre><p><em style="color: red">Note:</em> You can print out the current variables table with the <strong>% show</strong> directive. As described in more detail <a href="#variabledecl">below</a>, such a variables table can be created with the following directives:</p><pre>
 % const a=2
 % char c half a whole blank " "
 % vec firstnums[5] 1 2 3 4 5
 % vec nextnums[5] 6 7 8 9 10
</pre><p>Then the line</p><pre>
  {c} of the {a} {pi} is {pi/2}</pre><p>is turned into the following;</p><pre>
  half of the whole 3.14159265 is 1.57079633</pre><p>whereas the line</p><pre>
  one quarter is {1/(nextnums(4)-5)}</pre><p>becomes</p><pre>
  one quarter is .25</pre><p><em>Character Substrings Example</em>:</p><pre>
 % char c half a whole
  To {c(1,3)}ve a cave is to make a {a(2,5)}!
</pre><p>becomes</p><pre>
  To halve a cave is to make a hole!
</pre><p><em>Vector Substitution Example</em>:</p><pre>
  {firstnums}, I caught a hare alive, {nextnums} I let him go again ...
</pre><p>becomes</p><pre>
  1 2 3 4 5, I caught a hare alive, 6 7 8 9 10  I let him go again ...
</pre><p><em>Nesting Example</em>: The following illustrates nesting to three levels. The innermost block is substituted first. Beginning with</p><pre>
    % const xx{1{2+{3+4}1}} = 2
</pre><p>substitution takes place in three passes:</p><pre>
    % const xx{1{2+71}} = 2
    % const xx{173} = 2
    % const xx173 = 2
</pre><p>_ Example of <strong>{?~expr~strn1~strn2}</strong> syntax_</p><pre>
    MODE={?~k~B~C}3</pre><p>evaluates to, if <em>k</em> is nonzero:</p><pre>
    MODE=B3
</pre><p>or, if k_ is zero:</p><pre>
    MODE=C3
</pre><p><em style="color: red">Note:</em> the scalar variables table is always initialized with predefined variables <strong>t=1</strong> and <strong>f=0</strong> and **pi=π. It is STRONGLY ADVISED that you never alter any of these variables.</p> <h3 id="preprocessor-directives"><em>Preprocessor Directives</em></h3> <!-- /docs/input/preprocessor/#preprocessor-directives --> <ul> <li>Lines beginning with  <strong>% keyword</strong>  are be interpreted as preprocessor directives. Such lines are not part of the the post-processed input.</li> <li>Lines which begin with  <strong>#</strong>  are comment lines and are ignored. (More generally, text following a <strong>#</strong> in any line is ignored).</li> </ul> <p>Recognized keywords are</p><pre>
   const cconst cvar udef var vec                        &larr; allocate and assign numerical variables
   char char0 cchar getenv vfind                         &larr; allocate and assign character variables
   if ifdef ifndef iffile else elseif elseifd endif      &larr; branching construct
   while repeat end   exit                               &larr; looping and terminating constructs
   echo include includo macro save show stop trace udef  &larr; miscellaneous
</pre><h4 id="variable-declarations-and-assignments">Variable declarations and assignments</h4> <!-- /docs/input/preprocessor/#variable-declarations-and-assignments --> <p>  Keywords :   <strong>const cconst cvar udef var vec char char0 cchar getenv vfind</strong></p> <!-- Note: kramdown needs 3-space indentation for outside list code blocks 3+4 spaces. nested lists 3+2 spaces<pre> ... </pre>must also be indented --> <ol> <li><strong>const</strong>  and  <strong>var</strong>  load or alter the variables table. <i>Example</i>:<pre>% const  myvar=<i>expr</i> </pre><p>does two things:</p> <ul> <li>adds <strong>myvar</strong> to the scalar variables symbols table if it is not there already. <strong>const</strong> and <strong>var</strong> are equivalent in this respect.</li> <li>assigns the result of <i>expr</i> to it, if <i>either</i> <ul> <li>you use the <strong>var</strong> directive <i>or</i></li> <li>you use the <strong>const</strong> directive <i>and</i> the variable had not yet been created.</li> </ul> </li> </ul> <p>In other words, if  <strong>myvar</strong>  already exists prior to the directive,  <strong>const</strong>  will not alter its value but  <strong>var</strong>  will. Thus the lines</p><pre><code>% const a=2
% const a=3
</code></pre><p>incorporate <strong>a</strong> into the symbols table with value 2, while</p><pre><code>% const a=2
% var a=3
</code></pre><p>does the same but assigns 3 to <strong>a</strong>.</p> <p><em style="color: red">Note:</em> if <strong>myvar</strong> exists, you can multiply, divide, add, subtract from, or exponentiate it with <em>expr</em>, using one of the following C-like syntax:</p><pre>
   myvar*=<i>expr</i>  myvar/=<i>expr</i>  myvar+=<i>expr</i>  myvar-=<i>expr</i>  myvar^=<i>expr</i>
</pre><p>These operators modify  <strong>myvar</strong>  for both  <strong>const</strong>  and  <strong>var</strong>  directives.</p> </li> <li><strong>cconst</strong>  and  <strong>cvar</strong>  <em>conditionally</em> load or alter the variables table. <i>Example</i>:<pre>% cconst <i>test-expr</i> myvar=<i>expr</i> </pre><p><i>test-expr</i>  is an algebraic expression (e.g., <strong>i==3</strong>) that evaluates to zero or nonzero. <br /> If <i>test-expr</i> evaluates to nonzero, the remainder of the directive proceeds as  <strong>const</strong>  or  <strong>var</strong>  do.<br /> Otherwise, no further action is taken.</p> <p>  <i>Example</i>: the input segment</p><pre><code>% const a=2 b=3 c=4 d=5
A={a} B={b} C={c} D={d}
% const a=3
% var d=-1
% const b*=2 c+=3
A={a} B={b} C={c} D={d}
% cconst b==6  b+=3 c-=3
A={a} B={b} C={c} D={d}
% cconst b==6  b+=3 c-=3
A={a} B={b} C={c} D={d}
</code></pre><p>generates four lines:</p><pre><code>A=2 B=3 C=4 D=5
A=2 B=6 C=7 D=-1
A=2 B=9 C=4 D=-1
A=2 B=9 C=4 D=-1
</code></pre><p><strong>a</strong> is unchanged from its initial assignment while <strong>d</strong> changes.</p> <p>Compare the two  <strong>cconst</strong>  directives. <strong>b</strong> and <strong>c</strong> are altered in the first instance, since the condition  <strong>b==6</strong>  evaluates to 1, while they do not change in the second instance, since now  <strong>b==6</strong>  evaluates to zero.</p> </li> <li> <p><strong>char</strong> loads or alters the character table. <i>Example</i>:</p><pre><code>% char  c half     a whole      blank
</code></pre><p>loads the character table as follows:</p><pre><code> char symbol                     value
1 c                               half
2 a                               whole
3 blank
</code></pre><p>The last declaration can omit an associated string, in which case its value is a blank, as  <strong>blank</strong>  is in this case.</p> <p><em style="color: red">Note:</em> Re-declaration of any previously defined variable will change the contents of the variable.</p> </li> <li> <p><strong>char0</strong>  is the same as  <strong>char</strong> , except re-assignment of an existing variable is ignored. Thus  <strong>char0</strong>  is to  <strong>const</strong>  as  <strong>char</strong>  is to  <strong>var</strong> .</p> </li> <li><strong>cchar</strong>  is similar to  <strong>char</strong>   but tests are made to enable different strings to be loaded depending on the results of the tests. The syntax is<pre>% cchar nam  <i>expr1</i> str1 /i&gt;expr2 str2 ... </pre><p><strong>nam</strong>   is the name of the character variable; <i>expr1 expr2</i>  etc are algebraic expressions.<br /> <strong>nam</strong>   takes the value  <strong>str1</strong>   if  <i>expr1</i>   evaluates to nonzero, the value  <strong>str2</strong>   if  <i>expr2</i>   evaluates to nonzero, etc.</p> </li> <li><strong>getenv</strong>  has a function similar to <strong>char</strong> , only the contents of the variable are read from the unix environment variables table. Thus<pre>% getenv myhome HOME </pre><p>puts the string of your home directory into variable <strong>myhome</strong>.</p> </li> <li> <p><strong>vec</strong>  loads or alters elements in the table of vector variables.</p><pre><code>% vec v[n]                      &amp;larr; creates a vector variable of length n
% vec v[n] n1 n2 n3 ...         &amp;larr; does the same, also setting the first elements
</code></pre><p>Once <strong>v</strong>  has been declared, individual elements of  <strong>v</strong>   may be set with the following syntax</p> </li> </ol><pre>
 % vec v(<i>i</i>) <i>n</i>                    &larr; assigns <i>n</i> to v(<i>i</i>)
 % vec v(<i>i1</i>:<i>in</i>)  <i>n1</i> <i>n2</i> ... <i>nn</i>    &larr; assigns range of elements <i>i1</i>..<i>in</i> to <i>n1 n2 ... nn</i>
</pre><p>There must be exactly <strong><i>in−i1</i>+1</strong>  elements <strong><i>n1 … nn</i></strong> .</p> <p><em style="color: red">Note:</em> if <strong>v</strong>  is already declared, it is an error to re-declare it.</p> <ol> <li><strong>vfind</strong>  finds which element in a vector that matches a specified value. The syntax is<pre>% vfind v(i1:i2)  svar  <i>match-value</i> </pre><p><strong>svar</strong>  is a scalar variable and <i>match-value</i>  a number or expression. Elements  <strong>v(i1:i2)</strong>   are parsed.  <strong>svar</strong>   is assigned to the the first instance i for which  <strong>v(i)</strong>=<i>match-value</i> . If no match is found, <strong>svar</strong>  is set to zero.<br />   <i>Example</i>:</p><pre><code>% vec  a[3] 101 2002 30003
% vfind a(1:3) k 2002           &amp;larr; sets k=2
% vfind a(1:3) k 10             &amp;larr; sets k=0
</code></pre></li> </ol> <h4 id="branching-constructs">Branching constructs</h4> <!-- /docs/input/preprocessor/#branching-constructs --> <p>  Keywords :   <strong>if ifdef ifndef iffile else elseif elseifd endif</strong></p> <p>Branching constructs have a function similar to the C constructs.</p> <ol> <li> <p><strong>if <i>expr</i></strong>, <strong>elseif <i>expr</i></strong>, <strong>else</strong>  and  <strong>endif</strong>  are conditional read blocks. Lines between these directives are read or not, depending on the value of  <strong><i>expr</i></strong>. <i>Example</i>:</p><pre><code>% if Quartz
 is clear
% elseif Ag
 is bright
% else
 neither is right
% endif
</code></pre><p>generates this line if  <strong>Quartz</strong>  evaluates to nonzero:<br />      <strong>is clear</strong><br /> otherwise this line if  <strong>Ag</strong>  evaluates to nonzero*<br />      <strong>is bright</strong><br /> and otherwise<br />      <strong>neither is right</strong></p> </li> <li> <p><strong>ifdef</strong>  is similar to <strong>if</strong> , but has a more general idea of what constitutes an expression.</p> <ul> <li> <b>if</b> <i>expr</i>&nbsp;&nbsp; requires that <i>expr</i>&nbsp; be a valid expression, while &nbsp;<b>ifdef</b> <i>expr</i>&nbsp; evaluates <i>expr</i>&nbsp; as <b>false</b> if it invalid (e.g. it contains an undefined variable). <li> <i>expr</i>&nbsp;&nbsp; can be an algebraic expression, or a sequence of expressions separated by &nbsp;<b>&amp;</b>&nbsp;&nbsp; or &nbsp;&nbsp;<b>|</b>&nbsp;&nbsp; (<i>AND</i> or <i>OR</i> binary operators), <i>viz</i>:<pre>% ifdef <i>expr1</i> | <i>expr2</i> | <i>expr3</i> ...   </pre>If any of &nbsp;<i>expr1</i>,&nbsp;&nbsp; &nbsp;<i>expr2</i>,&nbsp;&nbsp; ... evaluate to nonzero, the result is nonzero, whether or not preceding expressions are valid. <br /><font color="#ff0000"><i>Note</i>&nbsp;</font> the syntactical significance of the spaces. &nbsp;<i>expr1</i><b>|</b><i>expr2</i>&nbsp;&nbsp; cannot be evaluated unless both &nbsp;<i>expr1</i>&nbsp;&nbsp; and &nbsp;<i>expr2</i>&nbsp;&nbsp; are valid expressions, while &nbsp;<i>expr1</i>&nbsp; <b>|</b> &nbsp;<i>expr2</i>&nbsp;&nbsp; may be nonzero if either is valid. <li> <b>ifdef</b>&nbsp;&nbsp; allows a limited use of character variables in expressions. Either of the following are permissible expressions:<pre>
   char-variable            &larr; T if char-variable exists, otherwise F
   char-variable=='<i>string</i>'  &larr; T ifchar-variable has the value <i>string</i> </pre><i>Example</i>:<pre> % ifdef  x1==2 &amp; atom=='Mg' | x1===1  </pre>is nonzero if scalar &nbsp;<b>x1</b>&nbsp;&nbsp; is 2 <i>and</i> if character variable &nbsp;<b>atom</b>&nbsp;&nbsp; is equal to "Mg", <i>or</i> if scalar &nbsp;<b>x1</b>&nbsp;&nbsp; is 1. <font color="#ff0000"><i>Note</i>&nbsp;</font> binary operators &nbsp;<b>&amp;</b>&nbsp;&nbsp; and &nbsp;&nbsp;<b>|</b>&nbsp;&nbsp; are evaluated left to right: &nbsp;<b>&amp;</b>&nbsp;&nbsp; does not take precedence over &nbsp;<b>|</b>. <p><p> </p></p></li></li></li></ul> </li> <li> <p><strong>elseifd</strong>   is to  <strong>elseif</strong>   as  <strong>ifdef</strong>   is to  <strong>if</strong>.</p> </li> <li> <p><strong>ifndef</strong> <i>expr</i>  … is the mirror image of  <strong>ifdef</strong> <i>expr</i>. Lines following this construct are read only if  <strong><i>expr</i></strong>   evaluates to 0.</p> </li> <li> <p><strong>iffile filename</strong>   is a construct analogous to  <strong>%if</strong>   or  <strong>%ifdef</strong>   for conditional reading of input lines.<br /> The test condition is set not by an expression, but whether file  <strong>filename</strong>   exists or not.<br /> <em style="color: red">Note:</em>  <strong>if</strong>,    <strong>ifdef</strong>,   and  <strong>ifndef</strong>   constructs may be nested to a depth of <em>mxlev</em>. The codes are distributed with <em>mxlev=6</em>.</p> </li> </ol> <h4 id="looping-constructs">Looping constructs</h4> <!-- /docs/input/preprocessor/#looping-constructs --> <p>  Keywords :   <strong>while repeat end</strong></p> <ol> <li><strong>while</strong>  and  <strong>end</strong>  mark the beginning and end of a looping construct. Lines inside the loop are repeatedly read until a test expression evaluates to 0.<pre>
% while [<i>expr1</i> <i>expr2</i> ...] <i>test-expr</i> &larr; skip to `% end' if <i>test-expr</i> is 0
...                              &larr; these lines become part of the input while <i>test-expr</i> is nonzero
% end                            &larr; return to the `% while' directive until <i>test-expr</i> is 0</pre><p>The (optional) expressions <strong>[</strong><i>expr1</i> <i>expr2</i> …<strong>]</strong>  follow the rules of the  <strong>const</strong>   directive:</p> <ul> <li>Each of <i>expr1</i>,  <i>expr2</i>, , … take the form  <strong>nam=</strong> <i>expr</i>   or  <strong>nam op=</strong> <i>expr</i>.</li> <li>A simple assignment  <strong>nam=</strong><i>expr</i>   has effect only when  <strong>nam</strong>   has not yet been loaded into the variables table. Thus it has effect on the first pass through the  <strong>while</strong>   loop (provided  <strong>nam</strong>   isn’t declared yet) but not subsequent passes.</li> </ul> <p>These rules make it very convenient to construct loops, as the following example shows.</p><pre>
% udef -f db                   &larr; removes db from symbols table, if it already exists
% while db=-1 db+=2 db&lt;=3      &larr; db is initialized to -1 only once
this is db={db}                &larr; the body of the loop that becomes the input
% end                          &larr; return file pointer to %while until test db&lt;=3 is 0</pre><p>generates</p><pre><code>this is db=1
this is db=3
</code></pre><p><strong>Pass 1:</strong>  <strong>db</strong>  is created and assigned the value −1, then incremented to 1. Condition  <strong>db&lt;=3</strong>   evaluates to 1 and the loop proceeds.<br /> <strong>Pass 2:</strong>  <strong>db</strong>  already exists so  <strong>db=-1</strong>  has no effect.  <strong>db+=2</strong>  increments  <strong>db</strong>   to <strong>3</strong>.<br /> <strong>Pass 3:</strong>  <strong>db</strong>   increments to <strong>5</strong> causing the condition  <strong>db&lt;=3</strong>   to become 0. The loop terminates.</p> </li> <li><strong>% repeat</strong>   …  <strong>% end</strong>   is another looping construct with the syntax<pre>
% repeat varnam <i>list</i>
 ...                             &larr; lines parsed for each element in list
% end
</pre><p>As with the  <strong>while</strong>   construct, multiple passes are made through the input lines.  <i>list</i>   generates a sequence of integers (see the <a href="/docs/misc/integerlists/">integer list syntax</a> manual). For each member of the sequence  <strong>varnam</strong>   takes its value and the body of the loop passed through.  <i>list</i>   can be just an integer (e.g.  <strong>7</strong> ) or define a <a href="/docs/misc/integerlists/">more complex sequence</a>, e.g.  <strong>1:3,6,2</strong>   generates the sequence  <strong>1 2 3 6 2</strong>.</p> <p><i>Example:</i> nested  <strong>while</strong>  and  <strong>repeat</strong>  loops</p><pre>
% const nm=-3 nn=4
% while db=-1 db+=2 db&lt;=3
% repeat k= 2,7
this is k={k} and db={db}
{db+k+nn+nm} is db + k + nn+nm, where nn+nm={nn+nm}
% end (loop over k)
% end (loop over db)
</pre><p>The nested loops are expanded into:</p><pre>
this is k=2 and db=1
4 is db + k + nn+nm, where nn+nm=1
this is k=7 and db=1
9 is db + k + nn+nm, where nn+nm=1
this is k=2 and db=3
6 is db + k + nn+nm, where nn+nm=1
this is k=7 and db=3
11 is db + k + nn+nm, where nn+nm=1
</pre></li> </ol> <h4 id="other-directives">Other directives</h4> <!-- /docs/input/preprocessor/#other-directives --> <p>  Keywords :   <strong>echo exit include includo macro save show stop trace udef</strong></p> <ol> <li><strong>echo <i>contents</i></strong>   echoes  <strong><i>contents</i></strong>   to standard output. <br /><i>Example</i> :<pre>
% echo hello world 
</pre><p>prints</p><pre>
#rf    <i>line-no</i>: hello world
</pre><p><i>line-no</i>   is the current line number.</p> </li> <li><strong>exit [</strong><i>expr</i><strong>]</strong>   causes the program to stop parsing the input file, as though it encountered an <strong>end-of-file</strong>. <ul> <li>If  <i>expr</i>   evaluates to nonzero, or if it is omitted, parsing ends.</li> <li>If  <i>expr</i>   evaluates to 0 the directive has no effect.</li> </ul> <p><em style="color: red">Note:</em>  compare to the  <strong>stop</strong>  directive.</p> </li> <li><strong>include filename</strong>  causes <em style="color: green">rdfiln</em> to include the contents file  <strong>filename</strong>  into the input. <ul> <li>If  <strong>filename</strong>  exists, <em style="color: green">rdfiln</em> opens it and the file pointer is transferred to this file until no further lines are to be read. At that point file pointer returns to the original file.</li> <li>If  <strong>filename</strong>  does not exist, the directive has no effect.</li> </ul> <p><em style="color: red">Notes:</em>  <strong>%include</strong>  may be nested to a depth of 10.  Looping and branching constructs <i>must</i> reside in the same file.</p> </li> <li> <p><strong>includo filename</strong>  is identical to  <strong>include</strong> , except that <em style="color: green">rdfiln</em> aborts if  <strong>filename</strong>  does not exist.</p> </li> <li><strong>macro(arg1,arg2,..)</strong> <i>expr</i>  defines a macro. <strong>arg1,arg2,…</strong>  are substituted into <i>expr</i>  before it is evaluated. <i>Example</i> :<pre>
% macro xp(x1,x2,x3,x4) x1+2*x2+3*x3+4*x4
The result of xp(1,2,3,4) is {xp(1,2,3,4)}
</pre><p>generates</p><pre>
The result of xp(1,2,3,4) is 30
</pre><p><em style="color: red">Note:</em>  macros are not quite identical to function declarations. The following lines illustrate this:</p><pre>
% macro xp(x1,x2,x3,x4) x1+2*x2+3*x3+4*x4
The result of xp(1,2,3,4) is {xp(1,2,3,4)}
The result of xp(1,2,3,3+1) is {xp(1,2,3,3+1)}
The result of xp(1,2,3,(3+1)) is {xp(1,2,3,(3+1))}
</pre><p>generates</p><pre>
The result of xp(1,2,3,4) is 30
The result of xp(1,2,3,3+1) is 27
The result of xp(1,2,3,(3+1)) is 30
</pre><p><strong>macro</strong>  merely substitutes 1,2,3,… for  <strong>x1,x2,x3,x4</strong>  in  <strong><i>expr</i></strong>  as follows:</p><pre>
1+2*2+3*3+4*4            &larr; xp(1,2,3,4)
1+2*2+3*3+4*3+1          &larr; xp(1,2,3,3+1)
1+2*2+3*3+4*(3+1)        &larr; xp(1,2,3,(3+1))
</pre><p>Operator order matters, so  <strong>4</strong>  and  <strong>3+1</strong>  behave differently. By enclosing the fourth argument in parenthesis, operator precedence is maintained.</p> </li> <li><strong>save</strong>  preserves variables after the preprocessor exits. The syntax is:<pre>
% save                   &larr; preserves all variables defined to this point
% save <i>name</i> [<i>name2</i> ...]  &larr; saves only variables named
</pre><p>Only variables in the scalar symbols table are saved.</p> </li> <li><strong>show …</strong>  prints various things to standard output:<pre>
% show vars              &larr; prints out the state of the variables table
% show lines             &larr; echos each line generated to the screen until:
% show stop              &larr; is encountered
</pre><p><em style="color: red">Note:</em>  because the vector variables can have arbitrary length,  <strong>show</strong>  prints only the size of the vector and the first and last entries.</p> </li> <li><strong>stop [</strong><i>expr</i> <strong>msg</strong>]  : causes the program to stop execution. <ul> <li>If  <strong><i>expr</i></strong>  evaluates to nonzero, or if it is omitted, program stops ( <strong>msg</strong> , if present, is printed to standard output before aborting).</li> <li>If  <strong><i>expr</i></strong>  evaluates to 0 the directive has no effect.</li> </ul> <p><em style="color: red">Note:</em>  compare to the  <strong>exit</strong>  directive.</p> </li> <li><strong>trace</strong>  turns on debugging printout. <em style="color: green">rdfiln</em> prints to standard output information about what it is doing. <ul> <li><strong>trace 0</strong> turns the tracing off</li> <li><strong>trace 1</strong> turns the tracing on at the lowest level.<br /> <em style="color: green">rdfiln</em> traces directives having to do with execution flow (<strong>if-else-endif</strong>, <strong>repeat/while-end</strong>).</li> <li><strong>trace 2</strong> prints some information about most directives.</li> <li><strong>trace 4</strong> is the most verbose</li> <li><strong>trace</strong> (no argument) toggles whether it is on or off.</li> </ul> </li> </ol> <p>10. <strong>udef [−f]</strong>  <i>name</i> [<i>name2</i> …]’  remove one or more variables from the symbols table. If the  <strong>−f</strong>  is omitted, <em style="color: green">rdfiln</em> aborts with error if you remove a nonexistent variable. If  <strong>−f</strong>  is included, removing nonexistent variable does not generate an error. Only scalar and character variables may be deleted.</p> <h3 id="source-codes"><em>Source codes</em></h3> <!-- /docs/input/preprocessor/#source-codes --> <p>Source codes the preprocessor uses are found in the  <strong>slatsm</strong>  directory:</p><pre>
   rdfiln.f  The source code for the preprocessor. Subroutine <b>rdfile</b> parses an entire file and
             and returns a preprocessed one, can be found in rdfiln.f
             The key subroutine is <b>rdfiln</b>, which parses one line of a file.
   symvar.f  maintains the table of variables for floating point scalars.
   symvec.f  maintains the table of vector variables.
   a2bin.f   evaluates ASCII representations of algebraic expressions using a C-like syntax, converting the
             result into a binary number. Expressions may include variables and vector elements.
   bin2a.f   converts a binary number into a character string (inverse function to a2bin.f).
   mkilst.f  generates a list of integers for looping constructs,
             as described below.  describes the syntax of integer lists.
</pre><p><em style="color: green">rdfiln</em> also maintains a table of character variables. It is kept in the character array <b>ctbl</b>, and is passed as an argument to <em style="color: green">rdfiln</em>.</p> <p><em style="color: red">Note:</em>  the ASCII representation of a floating-point expression is represented to 8 or 9 decimal places; thus it has less precision than the binary form. For example, <strong>‘{1.2345678987654e-8}’</strong>  is turned into <strong>1.2345679e-8</strong>.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
