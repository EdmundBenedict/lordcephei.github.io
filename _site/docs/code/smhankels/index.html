<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Smooth Hankel Functions</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Smooth Hankel Functions" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//docs/code/smhankels/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <h1>Smooth Hankel Functions</h1> </header> <h3 class="no_toc" id="purpose"><em>Purpose</em></h3> <hr /> <p>To describe a some of the properties of smooth Hankel functions. They form the basis set of the <strong style="color: blue">lmf</strong> code, and they are used for other properties, e.g. in the calculation of the electrostic potential. They also form the backbone of the new <a href="/docs/code/jpos/">Jigsaw Puzzle Orbitals</a> basis.</p> <h3 class="no_toc" id="table-of-contents"><em>Table of Contents</em></h3> <hr /> <ul id="markdown-toc"> <li><a href="#unique-properties-of-smoothed-hankel-functions" id="markdown-toc-unique-properties-of-smoothed-hankel-functions"><em>Unique properties of Smoothed Hankel functions</em></a></li> <li><a href="#smooth-hankel-functions-and-the-hsubklsub-family" id="markdown-toc-smooth-hankel-functions-and-the-hsubklsub-family"><em>Smooth Hankel functions and the H<sub>kL</sub> family</em></a></li> <li><a href="#two-center-integrals-of-smoothed-hankels" id="markdown-toc-two-center-integrals-of-smoothed-hankels"><em>Two-center integrals of smoothed Hankels</em></a></li> <li><a href="#smoothed-hankels-for-positive-energy" id="markdown-toc-smoothed-hankels-for-positive-energy"><em>Smoothed Hankels for positive energy</em></a></li> <li><a href="#other-resources" id="markdown-toc-other-resources"><em>Other Resources</em></a></li> </ul> <h3 id="unique-properties-of-smoothed-hankel-functions"><em>Unique properties of Smoothed Hankel functions</em></h3> <!-- /docs/code/smhankels/#unique-properties-of-smoothed-hankel-functions --> <hr /> <p>Smooth Hankel functions are convolutions of ordinary Hankel functions and Gaussian functions and are regular at the origin. Ordinary Hankel functions <script type="math/tex">\bar H_L</script> are solutions of the Helmholtz wave equation \begin{eqnarray} \left(\Delta+\varepsilon\right)\bar H_L(\varepsilon,{\mathbf{r}}) =-4\pi \delta({\mathbf{r}}) \quad\quad\quad\quad (1) \end{eqnarray} Solutions are products of radial functions and spherical harmonics <script type="math/tex">Y_L(\hat{\mathbf{r}})</script>, Here <script type="math/tex">L</script> is a compound index for the <script type="math/tex">\ell{}m</script> quantum numbers. Radial functions are spherical Hankel or Bessel functions. We will focus on the Hankel functions: \begin{eqnarray} \bar H_L(\varepsilon;{\mathbf{r}})=-i^\ell{\bar\kappa}^{\ell+1}h_\ell^{(1)}(i{\bar\kappa}{}r)Y_L(\hat{\mathbf{r}}) \quad\hbox{ where }\quad {\bar\kappa}^2 = -\varepsilon \quad\quad\quad\quad (2) \end{eqnarray} where <script type="math/tex">h_\ell^{(1)}(z)</script> is the spherical Hankel function of the first kind. Hankel (Bessel) functions are regular (irregular) as <i>r</i>→∞; thus Hankel functions are exact solutions of the Schrödinger equation in a flat potential with appropriate boundary conditions for large <em>r</em>. For small <em>r</em>, the situation is reversed with Bessel functions being regular. Hankel and Bessel functions vary as <script type="math/tex">r^{-\ell-1}</script> and <script type="math/tex">r^{\ell}</script> when <em>r</em>→0.</p> <p>When envelope functions are augmented with <a href="/docs/package_overview/#linear-methods-in-band-theory">partial waves</a> in spheres around atoms, the irregular part of <script type="math/tex">\bar H_L</script> is eliminated. Thus augmented Hankel functions can form exact solutions to the Schrödinger equation in a muffin-tin potential.</p> <p>Smooth Hankel functions <script type="math/tex">H_L</script> are regular for both large and small <em>r</em>. The Figure below compares ordinary Hankel functions <script type="math/tex">\bar H_L(\varepsilon,{\mathbf{r}})</script> (dashed lines) to smooth ones <script type="math/tex">H_L</script> for <script type="math/tex">\varepsilon{=}-0.5</script>. Red, green, and blue correspond to <script type="math/tex">\ell=0,1,2</script>.</p> <p><img src="/assets/img/smhankels.svg" alt="Ordinary and Smooth Hankel functions" /></p> <p>Smooth Hankels are superior to ordinary ones, first because real potentials are not flat so there is scope for improvement on the Hankel functions as the basis set.</p> <p>Also the fact that the <i>H<sub>L</sub></i> are everywhere smooth can greatly facilitate their implementation. In the present Questaal implementation the charge density is kept on a uniform mesh of points. Sharply peaked functions require finer meshes, and some smoothing would necessary in any case.</p> <p>Finally also have a sensible asymptotic form, decaying exponentially as real wave functions do when far from an atom. Thus they have better shape than gaussian orbitals do.</p> <p>Smooth Hankels have two big drawbacks as a basis set. First, they are more complicated to work with. One center expansions of ordinary Hankels (needed for augmentation) are Bessel functions. A counterpart does exist for smooth Hankels, but expansions are polynomials related to Laguerre polynomials. The expansion is cumbersom and introduces an extra cutoff in the polynomial order.</p> <p>Second, gaussian orbitals hold an enormous advantage over both ordinary and smooth Hankels, namely that the product of two of them in real space can be expressed as another gaussian (plane waves have a similar property). There exist no counterpart for Hankels, so an auxiliary basis must be constructed to make the charge density and matrix elements of the potential. The Questaal suite uses plane waves for the auxiliary basis.</p> <h3 id="smooth-hankel-functions-and-the-hsubklsub-family"><em>Smooth Hankel functions and the H<sub>kL</sub> family</em></h3> <hr /> <!-- /docs/code/smhankels/#smooth-hankel-functions-and-the-hsubkLsub-family --> <p>Methfessel’s class of functions <script type="math/tex">H_{kL}</script>, are a superset of smoothed Hankel functions <script type="math/tex">H_L</script>; they also incorporate the family of (polynomial)<script type="math/tex">\times</script>(gaussians). The <script type="math/tex">H_L</script> and the <script type="math/tex">H_{kL}</script> are defined in <a href="/docs/code/smhankels/#other-resources">reference 1</a>, and many of their properties derived there. The <script type="math/tex">H_{kL}({\mathbf{r}})</script> are a family of functions with <script type="math/tex">k=0,1,2,...</script> and angular momentum <script type="math/tex">L</script>. They are members of the general class of functions <script type="math/tex">F_L({\mathbf{r}})</script> which are determined from a single radial function by \begin{eqnarray} F_L({\mathbf{r}}) = \Upsilon_L(-\nabla) \, f(r) \quad\quad\quad\quad (3) \end{eqnarray} <script type="math/tex">\Upsilon_L({\mathbf{r}})</script> with <script type="math/tex">{\mathbf{r}}=(x,y,z)</script> is a polynomial in <script type="math/tex">(x,y,z)</script>, so is meaningful to talk about <script type="math/tex">\Upsilon_L(-\nabla)</script>. It is written in terms of conventional spherical harmonics as \begin{eqnarray} \Upsilon_L({\mathbf{r}}) = r^\ell Y_L (\hat{\mathbf{r}}) \quad\quad\quad\quad (4) \end{eqnarray} Just as the product of two spherical harmonics can be expanded in Clebsh Gordan coefficients <script type="math/tex">C_{KLM}</script> and spherical harmonics, so can the product of two spherical harmonic polynomials: \begin{eqnarray} Y_K(\hat{\mathbf{r}})Y_L(\hat{\mathbf{r}}) = \sum_M C_{KLM} Y_M({\hat{\mathbf{r}}}) \end{eqnarray} \begin{eqnarray} \Upsilon_K({\mathbf{r}})\Upsilon_L({\mathbf{r}}) = \sum_M C_{KLM} r^{k+\ell-m} \Upsilon_M({\mathbf{r}}) \quad\quad\quad\quad (5) \end{eqnarray} <script type="math/tex">C_{KLM}</script> is nonzero only when <script type="math/tex">{k+\ell-m}</script> is an even integer, so the r.h.s. is also a polynomial in <script type="math/tex">(x,y,z)</script>, as it must be.</p> <p>Functions <script type="math/tex">H_{L}({\mathbf{r}})</script> are defined through the radial function <script type="math/tex">h(r)</script> (Ref 1, Eq. 6.5): \begin{eqnarray} H_{L}(\varepsilon,r_s;{\mathbf{r}}) &amp;=&amp; \Upsilon_L(-\nabla) h(\varepsilon,r_s;r) \quad\quad\quad\quad\quad\quad\quad\quad (6) \end{eqnarray} \begin{eqnarray} h(\varepsilon,r_s;r) &amp;=&amp; \frac{1}{2r}\left(u_+(\varepsilon,r_s;r) - u_{-}(\varepsilon,r_s;r)\right) \quad\quad\quad\quad (7) \end{eqnarray} \begin{eqnarray} u_{\pm}(\varepsilon,r_s;r) &amp;=&amp; e^{\mp{\bar\kappa}{}r}\left[1-{\rm{erf}}\left(\frac{r_s{\bar\kappa}}{2}\mp{}\frac{r}{r_s}\right)\right] \quad\quad\quad\quad (8) \end{eqnarray} <script type="math/tex">H_{L}</script> is parameterized by energy <script type="math/tex">\varepsilon</script> and smoothing radius <script type="math/tex">r_s</script>; their significance will will become clear shortly. The extended family <script type="math/tex">H_{kL}({\mathbf{r}})</script> is defined through powers of the Laplacian acting on <script type="math/tex">H_{L}({\mathbf{r}})</script>: \begin{eqnarray} H_{kL}({\mathbf{r}}) &amp;=&amp; \Delta^k H_{L}({\mathbf{r}}) \quad\quad\quad\quad (9) \end{eqnarray}</p> <p>In real space <script type="math/tex">H_{kL}</script> must be generated recursively from <script type="math/tex">h</script>. However, the Fourier transform of <script type="math/tex">H_{kL}</script> has a closed form (Ref 1, Eq. 6.35). The differential operator becomes a multiplicative operator in the reciprocal space so \begin{eqnarray} \widehat{H}_{kL}(\varepsilon,r_s;\mathbf{q}) &amp;=&amp; -\frac{4\pi}{\varepsilon-q^2}\Upsilon_L(-i\mathbf{q})\,(-q^2)^k\,e^{r_s^2(\varepsilon-q^2)/4} \quad\quad\quad\quad (10) \end{eqnarray} By taking limiting cases we can see the connection with familiar functions, and also the significance of parameters <script type="math/tex">\varepsilon</script> and <script type="math/tex">r_s</script>.</p> <ol> <li> <p><script type="math/tex">k=0</script> and <script type="math/tex">r_s=0</script>: <script type="math/tex">\widehat{H}_{00}(\varepsilon,0;\mathbf{q})=-{4\pi/(\varepsilon-q^2)}</script><br /> This is the Fourier transform of <script type="math/tex">H_{00}(\varepsilon,0;r)=\exp(-{\bar\kappa}{}r)/r</script>, and is proportional to the <script type="math/tex">\ell=0</script> spherical Hankel function of the first kind, <script type="math/tex">h_0^{(1)}(z)</script>. For general <script type="math/tex">L</script> the relation is \begin{eqnarray} H_{0L}(\varepsilon,0;{\mathbf{r}})=H_{L}(\varepsilon,0;{\mathbf{r}})=\bar H_{L}(\varepsilon,{\mathbf{r}})=-i^\ell{\bar\kappa}^{\ell+1}h_\ell^{(1)}(i{\bar\kappa}{}r)Y_L(\hat{\mathbf{r}}) \end{eqnarray} which is Eq. 2.</p> </li> <li> <p><script type="math/tex">k=1</script> and <script type="math/tex">\varepsilon=0</script>: <script type="math/tex">\widehat{H}_{10}(0,r_s;\mathbf{q})=-{4\pi} e^{-r_s^2q^2/4}</script>.<br /> This is the Fourier transform of a Gaussian function, whose width is defined by <script type="math/tex">r_s</script>. For general <script type="math/tex">L</script> we can define the family of generalized Gaussian functions \begin{eqnarray} G_{0L}(\varepsilon,r_s;{\mathbf{r}}) = \Upsilon_L(-\nabla) g(\varepsilon,r_s;r) = \left(\frac{1}{\pi r_s^2}\right)^{3/2} e^{\varepsilon r_s^2/4} \left(2r_s^{-2}\right)^l e^{-r^2/r_s^2} Y_L(\hat{\mathbf{r}}) \end{eqnarray} <em>g</em> is a simple gaussian with an extra normalization: \begin{eqnarray} g(\varepsilon,r_s;r) &amp;=&amp; \left(\frac{1}{\pi r_s^2}\right)^{3/2} e^{\varepsilon r_s^2/4}e^{-r^2/r_s^2} \quad\quad\quad\quad (11) \end{eqnarray}</p> </li> </ol> <p>Comparing cases 1 and 2 with Eq. (10), evidently <script type="math/tex">\widehat{H}_L(\mathbf{q})</script> is proportional to the product of the Fourier transforms of a conventional spherical Hankel function of the first kind, and a gaussian. By the convolution theorem, <script type="math/tex">{H_L}({\mathbf{r}})</script> is a convolution of a Hankel function and a gaussian. For <script type="math/tex">r\gg r_s</script>, <script type="math/tex">{H_L}({\mathbf{r}})</script> behaves as a Hankel function and asymptotically tends to <script type="math/tex">H_L({\mathbf{r}})\to r^{-l-1}\exp(-\sqrt{-\varepsilon}r)Y_L(\hat{\mathbf{r}})</script>. For <script type="math/tex">r\ll r_s</script> it has structure of a gaussian; it is therefore analytic and regular at the origin, varying as <script type="math/tex">r^lY_L(\hat{\mathbf{r}})</script>. Thus, the <script type="math/tex">r^{-l-1}</script> singularity of the Hankel function is smoothed out, with <script type="math/tex">r_s</script> determining the radius for transition from Gaussian-like to Hankel-like behavior. Thus, the smoothing radius <script type="math/tex">r_s</script> determines the smoothness of <script type="math/tex">H_L</script>, and also the width of generalized gaussians <script type="math/tex">G_L</script>.</p> <p>By analogy with Eq. (9) we can extend the <script type="math/tex">G_{L}</script> family with the Laplacian operator: \begin{eqnarray} G_{kL}(\varepsilon,r_s;{\mathbf{r}}) = \Delta^k\, G_{0L}(\varepsilon,r_s;{\mathbf{r}}) = \Upsilon_L(-\nabla) \Delta^k g(\varepsilon,r_s;r) \quad (12) \end{eqnarray} \begin{eqnarray} G_{kL}(\varepsilon,r_s;{\mathbf{r}}) = \Upsilon_L(-\nabla)\left(\frac{1}{r}\frac{\partial^2}{\partial r^2}r\cdot\right)^k g(\varepsilon,r_s;r)<br /> \quad\quad\quad\quad (13) \end{eqnarray}</p> <script type="math/tex; mode=display">\widehat{G}_{kL}(\varepsilon,r_s;\mathbf{q}) = \Upsilon_L(-i\mathbf{q})(-q^2)^k e^{r_s^2(\varepsilon-q^2)/4} \quad\quad\quad\quad\quad\quad (14)</script> <p>The second equation shows that <script type="math/tex">G_{kL}</script> has the structure (polynomial of order <script type="math/tex">k</script> in <script type="math/tex">r^2</script>)<script type="math/tex">\times G_L</script>. These polynomials are related to the generalized Laguerre polynomials of half-integer order in <script type="math/tex">r^2</script>. They obey a recurrence relation (see Ref 1, Eq. 5.19), which is how they are evaluated in practice. They are proportional to the polynomials <i>P<sub>kL</sub></i> used in one-center expansions of smoothed Hankels around remote sites (see Ref 1, Eq. 12.7).</p> <p>Comparing the last form Eq. (14) to Eq. (10) and the definition of <script type="math/tex">H_{kL}</script> Eq. (9), we obtain the useful relations \begin{eqnarray} H_{k+1,L}(\varepsilon,r_s;{\mathbf{r}})+\varepsilon H_{kL}(\varepsilon,r_s;{\mathbf{r}}) =-4\pi G_{kL}(\varepsilon,r_s;{\mathbf{r}})<br /> \quad\quad\quad\quad (15) \end{eqnarray} \begin{eqnarray} \left(\Delta+\varepsilon\right)H_{kL}(\varepsilon,r_s;{\mathbf{r}}) =-4\pi G_{kL}(\varepsilon,r_s;{\mathbf{r}}) \quad\quad\quad\quad\quad\quad\quad (16) \end{eqnarray} This shows that <script type="math/tex">H_{kL}</script> is the solution to the Helmholz operator <script type="math/tex">\Delta+\varepsilon</script> in response to a source term smeared out in the form of a gaussian. A conventional Hankel function is the response to a point multipole at the origin (see Ref 1, Eq. 6.14). <script type="math/tex">H_{kL}</script> is also the solution to the Schrödinger equation for a potential that has an approximately gaussian dependence on <em>r</em> (Ref 1, Eq. 6.30).</p> <h3 id="two-center-integrals-of-smoothed-hankels"><em>Two-center integrals of smoothed Hankels</em></h3> <hr /> <p>One extremely useful property of the <script type="math/tex">H_{kL}</script> is that the product of two of them, centered at different sites <script type="math/tex">{\mathbf{r}}_1</script> and <script type="math/tex">{\mathbf{r}}_2</script>, can be integrated in closed form. The result a sum of other <script type="math/tex">H_{kL}</script>, evaluated at the connecting vector <script type="math/tex">{\mathbf{r}}_1-{\mathbf{r}}_2</script>. This can be seen from the power theorem of Fourier transforms</p> <script type="math/tex; mode=display">\int H^*_1({\mathbf{r}}-{\mathbf{r}}_1) H_2({\mathbf{r}}-{\mathbf{r}}_2) d^3r = (2\pi)^{-3}\int \widehat{H}^*_1(\mathbf{q}) \widehat{H}_2(\mathbf{q}) e^{i\mathbf{q}\cdot({\mathbf{r}}_1-{\mathbf{r}}_2)} d^3q \quad\quad\quad\quad (17)</script> <p>and the fact that <script type="math/tex">\widehat{H}^*_{k_1L_1}(\mathbf{q})\widehat{H}_{k_2L_2}(\mathbf{q})</script> can be expressed as a linear combination of other <script type="math/tex">\widehat{H}_{kL}(\mathbf{q})</script>, or their energy derivatives. This is readily done from the identity \begin{eqnarray} \frac{1}{(\varepsilon_1-q^2)(\varepsilon_2-q^2)} &amp;=&amp;\frac{1}{\varepsilon_1-\varepsilon_2} \left[ \frac{1}{\varepsilon_2-q^2} - \frac{1}{\varepsilon_1-q^2} \right] \mathop{\longrightarrow}\limits^{\varepsilon_2\to\varepsilon_1}&amp; \frac{1}{(\varepsilon_1-q^2)^2} \quad\quad\quad\quad (18) \end{eqnarray}</p> <p>Comparing the first identity and the form Eq.~(10) of <script type="math/tex">\widehat{H}_{p0}(\mathbf{q})</script>, it can be immediately seen that the product of two <script type="math/tex">\widehat{H}_{p0}(\mathbf{q})</script> with different energies can be expressed as a linear combination of two <script type="math/tex">\widehat{H}_{p0}(\mathbf{q})</script>. The second identity applies when the <script type="math/tex">\widehat{H}_{p0}(\mathbf{q})</script> have the same energy; the product will involve the energy derivative of some <script type="math/tex">\widehat{H}_{p0}(\mathbf{q})</script>. For higher <script type="math/tex">L</script>, <script type="math/tex">\Upsilon^*_{L_1}(-i\mathbf{q})\Upsilon_{L_2}(-i\mathbf{q})</script> is expanded as a linear combination of <script type="math/tex">\Upsilon^*_{M}(-i\mathbf{q})</script> using the expansion theorem for spherical harmonics, Eq. (5). In detail,</p> <script type="math/tex; mode=display">{\widehat{H}^*_{k_1L_1}}(\varepsilon_1,r_{s_1};\mathbf{q}) {\widehat{H}_{k_2L_2}}(\varepsilon_2,r_{s_2};\mathbf{q}) = \frac{(4\pi)^2}{(\varepsilon_1-q^2)(\varepsilon_2-q^2)} \Upsilon^*_{L_1}(-i{\mathbf{q}})\Upsilon_{L_2}(-i{\mathbf{q}}) (-q^2)^{k_1+k_2}\,e^{r_{s_1}^2(\varepsilon_1-q^2)/4+r_{s_2}^2(\varepsilon_2-q^2)/4} \quad\quad (19)</script> <p>which can be written as \begin{equation} \frac{(4\pi)^2}{\varepsilon_1-\varepsilon_2} \left[ \frac{e^{r_{s_1}^2(\varepsilon_1-\varepsilon_2)/4}e^{(r_{s_2}^2+r_{s_1}^2)(\varepsilon_2-q^2)/4}}{\varepsilon_2-q^2}- \frac{e^{r_{s_2}^2(\varepsilon_2-\varepsilon_1)/4}e^{(r_{s_1}^2+r_{s_2}^2)(\varepsilon_1-q^2)/4}}{\varepsilon_1-q^2} \right]\times (-q^2)^{k_1+k_2} i^{2\ell_1} \sum_M C_{L_1L_2M} \Upsilon_{M}(-i{\mathbf{q}}) (-q^2)^{(\ell_1+\ell_2-m)/2} \end{equation} where <script type="math/tex">r_{s}^2=r_{s_1}^2+r_{s_2}^2</script>.</p> <p>This last equation is a linear combination of <script type="math/tex">H_{kL}</script> with smoothing radius <script type="math/tex">r_s</script> given as shown.</p> <p>Using the power theorem the two-center integrals can be directly evaluated:</p> <script type="math/tex; mode=display">\int{H^*_{k_1L_1}}(\varepsilon_1,r_{s_1};{\mathbf{r}}-{\mathbf{r}_1}) {H_{k_2L_2}}(\varepsilon_2,r_{s_2};{\mathbf{r}}-{\mathbf{r}_2})\, d^3r = \frac{1}{(2\pi)^3} \int {\widehat{H}^*_{k_1L_1}}(\varepsilon_1,r_{s_1};{\mathbf{q}}) {\widehat{H}_{k_2L_2}}(\varepsilon_2,r_{s_2};{\mathbf{q}})\, e^{i{\mathbf{q}}\cdot\left({\mathbf{r}}_1-{\mathbf{r}}_2\right)} d^3q \quad\quad (20)</script> <p>This can be written as</p> <script type="math/tex; mode=display">(-1)^{\ell_1}\frac{4\pi}{\varepsilon_1-\varepsilon_2} \sum_M C_{L_1L_2M} \times \big[ {\ e^{r_{s_2}^2(\varepsilon_2-\varepsilon_1)/4}{H_{k_1+k_2+{(\ell_1+\ell_2-m)/2},M}}(\varepsilon_1,r_{s};{\mathbf{r}}_1-{\mathbf{r}}_2)} {- e^{r_{s_1}^2(\varepsilon_1-\varepsilon_2)/4}{H_{k_1+k_2+{(\ell_1+\ell_2-m)/2},M}}(\varepsilon_2,r_{s};{\mathbf{r}}_1-{\mathbf{r}}_2)} \ \big]</script> <p>The special case <script type="math/tex">\varepsilon_1=\varepsilon_2=\varepsilon</script> must be handled using the limiting form of Eq. (18). Differentiation of Eq. (10) with respect to energy results in</p> <script type="math/tex; mode=display">\widehat{\dot{H}}_{kL} \equiv \frac{\partial\widehat{H}_{kL}}{\partial\varepsilon} = -\frac{1}{\varepsilon-q^2}\widehat{H}_{kL} + (r_s^2/4) \widehat{H}_{kL}. \quad\quad\quad\quad (21)</script> <p>The two-center integral now becomes</p> <script type="math/tex; mode=display">\int{H^*_{k_1L_1}}(\varepsilon,r_{s_1};\mathbf{r}-\mathbf{r}_1) H_{k_2L_2}(\varepsilon,r_{s_2};\mathbf{r}-\mathbf{r}_2)\, d^3r =</script> <script type="math/tex; mode=display">(-1)^{\ell_1}{4\pi} \sum_M C_{L_1L_2M} \times \big[ {\dot{H}_{k_1+k_2+{(\ell_1+\ell_2-m)/2},M}}(\varepsilon,r_{s};\mathbf{r}_1-\mathbf{r}_2) - (r_s^2/4) {H_{k_1+k_2+{(\ell_1+\ell_2-m)/2},M}}(\varepsilon,r_{s};\mathbf{r}_1-\mathbf{r}_2) \big] \quad\quad\quad\quad (22)</script> <p>If we consider a further limiting case, namely <script type="math/tex">\varepsilon_1=\varepsilon_2=0</script>, Eq. (22) simplifies to</p> <script type="math/tex; mode=display">\widehat{\dot{H}}_{kL} \mathop{\longrightarrow}\limits^{\varepsilon\to 0} - \frac{1}{-q^2}\widehat{H}_{kL} + (r_s^2/4) \widehat{H}_{kL} = - \widehat{H}_{k-1,L} + (r_s^2/4)\widehat{H}_{kL} \quad\quad\quad\quad (23)</script> <p>and the two-center integral simplifies to</p> <script type="math/tex; mode=display">\int {H}^*_{k_1L_1}(0,r_{s_1};{\mathbf{r}}-{\mathbf{r}_1}) {H}_{k_2L_2}(0,r_{s_2};{\mathbf{r}}-{\mathbf{r}_2})\, d^3r = (-1)^{\ell_1}(-{4\pi}) \sum_M C_{L_1L_2M} \times H_{k_1+k_2-1+{(\ell_1+\ell_2-m)/2},M}(0,r_{s};{\mathbf{r}}_1-{\mathbf{r}}_2). \quad\quad (24)</script> <p>When <script type="math/tex">\varepsilon=0</script> and <script type="math/tex">k\ge 1</script> the <script type="math/tex">H_{kL}</script> are generalized Gaussian functions of the type Eq. (12), scaled by <script type="math/tex">-4\pi</script>; see Eq. (16). Eq. (24) is then suitable for two-center integrals of generalized Gaussian functions.</p> <h3 id="smoothed-hankels-for-positive-energy"><em>Smoothed Hankels for positive energy</em></h3> <hr /> <p>The smooth Hankel functions defined in Ref. 1 for negative energy also apply for positive energy. We demonstrate that here, and show that the difference between the conventional and smooth Hankel functions are real functions.</p> <p>Ref. 1 defines <script type="math/tex">{\bar\kappa}</script> in contradistinction to usual convention for <script type="math/tex">\kappa</script></p> <p>\begin{equation} {\bar\kappa}^2 = -\varepsilon \hbox{ with }{\bar\kappa}&gt;0 \end{equation} and restricts <script type="math/tex">\varepsilon {\lt} 0</script>. According to usual conventions <script type="math/tex">\kappa</script> is defined as \begin{equation} \kappa = \sqrt\varepsilon \hbox{, Im}(\kappa) \ge 0. \end{equation} We can define for any energy \begin{equation} \bar\kappa = -i \kappa . \end{equation} Then <script type="math/tex">\bar\kappa</script> is real and positive if <script type="math/tex">\varepsilon \lt 0</script>, while <script type="math/tex">\kappa</script> is real and positive if <script type="math/tex">\varepsilon \gt 0</script>.</p> <p>The smoothed Hankel <em>s</em> orbitals for <script type="math/tex">\ell=0</script> and <script type="math/tex">\ell=-1</script> are real: \begin{eqnarray} h^s_0 (r) &amp;=&amp; (u_+ - u_-) / 2r \hbox{ and } h^s_{-1}(r) &amp;=&amp; (u_+ + u_-) / 2{\bar\kappa} \end{eqnarray}</p> <p>To extend the definition to any energy we define <script type="math/tex">U_{\pm}</script> as: \begin{equation} U_{\pm} = e^{\pm i\kappa r}\, \mathrm{erfc}\left(r/r_s\pm{i\kappa r_s}/2\right) \end{equation} The following relations are useful:</p> <script type="math/tex; mode=display">\mathrm{erfc}(-x)</script> <p>Then for <script type="math/tex">\varepsilon \lt 0</script>, <script type="math/tex">i\kappa</script> is real and \begin{equation} U_+ = 2e^{i\kappa r} - u_+ \hbox{ and } U_- = u_- \end{equation} are also real.</p> <p>The difference in ordinary and smoothed Hankels is \begin{equation} h_0 - h^s_0 = [e^{i \kappa r} - u_+/2 + u_-/2] /r = [U_+/2 + U_-/2] /r \end{equation} \begin{equation} h_{-1} - h^s_{-1} = [e^{i \kappa r} - u_+/2 - u_-/2] /{\bar\kappa} = [U_+/2 - U_-/2] /(-i \kappa) \end{equation}</p> <p>For <script type="math/tex">\varepsilon>0</script>, <script type="math/tex">\kappa</script> is real and <script type="math/tex">U_+</script> = <script type="math/tex">U_-^*</script>. The difference in ordinary and smoothed Hankels is \begin{equation} h_0 - h^s_0 = [U_+/2 + U_-/2] /r = \mathrm{Re}(U_+) /r \end{equation} \begin{equation} h_{-1} - h^s_{-1} = [U_+/2 - U_-/2] / (-i \kappa) = -\mathrm{Im} (U_+) / \kappa \end{equation} Both are real, though <script type="math/tex">h_0</script> and <script type="math/tex">h_{-1}</script> are complex.</p> <h3 id="other-resources"><em>Other Resources</em></h3> <hr /> <!-- /docs/code/smhankels/#other-resources/ --> <ol> <li>Many mathematical properties of smoothed Hankel functions and the <script type="math/tex">H_{kL}</script> family are described in this paper:<br /> E. Bott, M. Methfessel, W. Krabs, and P. C. Schmid, <em>Nonsingular Hankel functions as a new basis for electronic structure calculations</em>, <a href="http://dx.doi.org/10.1063/1.532437">J. Math. Phys. 39, 3393 (1998)</a></li> </ol> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
