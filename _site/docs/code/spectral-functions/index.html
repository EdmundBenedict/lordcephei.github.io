<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Spectral function calculations with lmgf </title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Spectral function calculations with lmgf " /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//docs/code/spectral-functions/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>Spectral function calculations with lmgf </h1> </header> <p class="teaser"> </p> <h3 class="no_toc" id="table-of-contents"><em>Table of Contents</em></h3> <ul id="markdown-toc"> <li><a href="#preliminaries" id="markdown-toc-preliminaries"><em>Preliminaries</em></a></li> <li><a href="#how-to-calculate-spectral-functions" id="markdown-toc-how-to-calculate-spectral-functions"><em>How to calculate spectral functions?</em></a></li> <li><a href="#plotting-of-the-spectral-function" id="markdown-toc-plotting-of-the-spectral-function"><em>Plotting of the spectral function</em></a></li> <li><a href="#site-resolved-spectral-functions" id="markdown-toc-site-resolved-spectral-functions"><em>Site-resolved spectral functions</em></a></li> <li><a href="#notes" id="markdown-toc-notes"><em>Notes</em></a></li> </ul> <h3 id="preliminaries"><em>Preliminaries</em></h3> <hr /> <p>Spectral function was implemented in <strong style="color: blue">lmgf</strong> <strong>v7.10</strong> by <em>Bhalchandra Pujari</em> and <em>Kirill Belashchenko</em> (<em>belashchenko@unl.edu</em>). The details of the theory in the CPA case can be found in</p> <p><em>I. Turek, V. Drchal, J. Kudrnovský, M. Šob, P. Weinberger.</em> <strong>Electronic structure of disordered alloys, surfaces and interfaces</strong>. <em>Kluwer academic publishers (1997), see Eqs. (4.25)-(4.29)</em></p> <h3 id="how-to-calculate-spectral-functions"><em>How to calculate spectral functions?</em></h3> <hr /> <p>The spectral function can be calculated both with and without CPA. The calculation is performed in 3 steps:</p> <ul> <li>Charge self consistency. (The spectral function can be calculated for any potential, but it is usual to work with the self-consistent one).</li> <li>CPA self-consistency in the coherent interactor <script type="math/tex">\Omega</script> (CPA only). Since <script type="math/tex">\Omega</script> is energy dependent, it has to be calculated for the energy points where the spectral function is needed. For drawing spectral functions this is usually a uniform mesh of points close to the real axis.</li> <li>Calculation of the spectral function on some contour, usually a uniform mesh close to the real axis.</li> </ul> <p><strong style="color: orange">Charge self consistency</strong> is performed in the usual manner, for example with the following options:</p><pre><code>BZ       EMESH=31 10 -.9 0 .5 .0
GF       MODE=1 DLM=12 GFOPTS=p3;omgmix=1.0;padtol=1d-3;omgtol=1d-5;lotf;nitmax=50
</code></pre><p>Note the <strong>EMESH mode</strong> (contour type) is elliptical (type 10). If CPA is used, the coherent interactors <script type="math/tex">\Omega</script> for all CPA sites are also iterated to self-consistency during this calculation, but this is done for the complex energy points on the elliptical contour. The following additional step is needed in this case to obtain self-consistent <script type="math/tex">\Omega</script> at those points where the spectral function will be calculated.</p> <p><strong style="color: orange">Omega self-consistency</strong> is turned on by setting <strong>DLM=32</strong>. In this mode only Ω for each CPA site is converged, while the atomic charges are left unchanged. It is important to converge Ω to high precision. Typically <strong>omgtol=1d-6</strong> is a good criterion. The contour type should be set to 2. Example input for this step is</p><pre><code>BZ       EMESH=150 2 -.25 .25  .0005  0
GF       MODE=1 DLM=32  GFOPTS=p3;omgmix=1.0;padtol=1d-3;omgtol=1d-6;lotf;nitmax=50
</code></pre><p>The highlighted parameters are of particular importance. lotf is required to iterate <script type="math/tex">\Omega</script> for convergence (and it is recommended to keep it enabled in all CPA calculations, including charge self-consistency). It is also necessary to monitor the output file (set <strong>--pr41</strong>) and make sure that the required precision has been achieved for all energy points. If convergence appears to be problematic, try to start with a larger imaginary part for the complex energy or reduce the mixing parameter omgmix.</p> <p>Calculation of the spectral function should be done with <strong>EMESH</strong> set to the same mesh as used for <script type="math/tex">\Omega</script> self-consistency, e.g.</p><pre><code>BZ       EMESH=150 2 -.25 .25  .0005  0
GF       MODE=1 DLM=12 GFOPTS=p3;omgmix=1.0;padtol=1d-3;specfun
</code></pre><p><strong>Important: If there are sites treated in CPA, the contour specified by EMESH should be kept exactly as in the previous step when CPA self-consistency was performed.</strong></p> <p>In order to start the calculation, invoke <strong style="color: blue">lmgf</strong> with the <strong>--band</strong> flag referring to the symmetry-line file (same format as used for band structure calculation with <strong style="color: blue">lm</strong>):</p><pre><code>lmgf «sys» --band:fn=syml 
</code></pre><p>where <em>«sys»</em> is the extension of the <strong style="color: green">ctrl</strong> file. Once completed, the program will generate a <strong style="color: green">spf.«sys»</strong> file containing the complete spectral function along the lines given in the <strong style="color: green">syml.«sys»</strong> file. Other options included with <strong>--band</strong> are currently not used.</p> <h3 id="plotting-of-the-spectral-function"><em>Plotting of the spectral function</em></h3> <hr /> <p>Upon successful completion of calculation <strong style="color: green">spf.«sys»</strong> file will be generated. The file has the following format:</p><pre><code>ZP        KP         SF_UP         SF_DN
.
.
-0.250   0.137      5.708839      4.742153
-0.250   0.160     10.658114      4.844647
.
.
</code></pre><p>where <em>ZP</em> are the points on the energy contour, <em>KP</em> are the points of the K-mesh and SF_UP, SF_DN are the spectral functions for Up and Down channel respectively. The very first line of the file indicate the location of the high symmetry points of the Brillouin zone. User can utilize this information to visualize the spectral function using any desired graphics package. A small bash utility, <strong style="color: green">SpectralFunction.sh</strong>, is given for the sake of convenience. This bash script uses Gnuplot to view and save the spectral function. Users with standard Linux/unix distro should be able to use it without special prerequisites. Typical output of the script is shown in the figure. Please see SpectralFunction.sh -h for usage. (The file <strong style="color: green">spf.«sys»</strong> should be renamed <strong style="color: green">specfun.«sys»</strong> to be read by this script. See below why.)</p> <h3 id="site-resolved-spectral-functions"><em>Site-resolved spectral functions</em></h3> <hr /> <p>Site-resolved spectral functions can be obtained by including the option <strong>specfr</strong> in <strong>GFOPTS</strong>. (It supersedes the option specfun.) A series of output files will then be generated, which contain the spectral function on each basis site . The file names are <strong style="color: green">spfN.«sys»</strong>, where N is the index of the site. The format of this file is the same as for <strong style="color: green">spf.«sys»</strong>, and it can be also plotted using the SpectralFunction.sh script (first rename to <strong style="color: green">specfun.«sys»</strong>).</p> <h3 id="notes"><em>Notes</em></h3> <hr /> <ul> <li>Spectral function calculations can be run with MPI parallelization.</li> </ul> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
