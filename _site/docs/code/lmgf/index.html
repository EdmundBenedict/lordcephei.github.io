<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>The ASA Green's function program lmgf</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="The ASA Green's function program lmgf" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//docs/code/lmgf/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>The ASA Green's function program lmgf</h1> </header> <p class="teaser"> </p> <h3 class="no_toc" id="table-of-contents"><em>Table of Contents</em></h3> <hr /> <ul id="markdown-toc"> <li><a href="#purpose" id="markdown-toc-purpose"><em>Purpose</em></a></li> <li><a href="#structure-of-greens-function-program" id="markdown-toc-structure-of-greens-function-program"><em>Structure of Green’s function program</em></a></li> <li><a href="#energy-contours-potential-shifts-and-the-determination-of-the-fermi-level" id="markdown-toc-energy-contours-potential-shifts-and-the-determination-of-the-fermi-level"><em>Energy Contours, Potential Shifts and the Determination of the Fermi Level</em></a> <ul> <li><a href="#some-details-concerning-how-lmgf-works-internally" id="markdown-toc-some-details-concerning-how-lmgf-works-internally"><em>Some details concerning how lmgf works internally</em></a></li> </ul> </li> <li><a href="#gf-specific-input" id="markdown-toc-gf-specific-input"><em>GF specific input</em></a> <ul> <li><a href="#energy-integration" id="markdown-toc-energy-integration"><em>Energy integration</em></a> <ul> <li><a href="#the-bzemesh-token" id="markdown-toc-the-bzemesh-token"><em>The</em> BZ_EMESH <em>token</em></a></li> <li><a href="#modifications-of-energy-contour-for-layer-geometry" id="markdown-toc-modifications-of-energy-contour-for-layer-geometry"><em>Modifications of energy contour for layer geometry</em></a></li> </ul> </li> <li><a href="#greens-function-category" id="markdown-toc-greens-function-category"><em>Green’s function category</em></a> <ul> <li><a href="#the-gfmode-token" id="markdown-toc-the-gfmode-token"><em>The</em> GF_MODE <em>token</em></a></li> <li><a href="#the-gfgfopts-token" id="markdown-toc-the-gfgfopts-token"><em>The</em> GF_GFOPTS <em>token</em></a></li> </ul> </li> </ul> </li> <li><a href="#lmgf-specific-command-line-arguments" id="markdown-toc-lmgf-specific-command-line-arguments"><em>lmgf-specific command-line arguments</em></a></li> <li><a href="#test-cases-and-examples" id="markdown-toc-test-cases-and-examples"><em>Test cases and examples</em></a></li> </ul> <h3 id="purpose"><em>Purpose</em></h3> <hr /> <p>This package implements the ASA local spin-density approximation using Green’s functions. The Green’s functions are contructed by approximating KKR multiple-scattering theory with an analytic potential function. The approximation to KKR is essentially similar to the linear approximation employed in band methods such as LMTO and LAPW. It can be shown that this approximation is nearly equivalent to the LMTO hamiltonian without the “combined correction” term. With this package a new program, <strong style="color: blue">lmgf</strong> is added to the suite of executables. <strong style="color: blue">lmgf</strong> plays approximately the same role as the LMTO-ASA band program <strong style="color: blue">lm</strong>: you can use <strong style="color: blue">lmgf</strong> to make a self-consistent density as you can do with <strong style="color: blue">lm</strong>. A potential is generated from <a href="/docs/code/asaoverview/#generation-of-the-sphere-potential-and-energy-moments-q">energy moments</a> <script type="math/tex">Q_0</script>, <script type="math/tex">Q_1</script>, and <script type="math/tex">Q_2</script>, in the same way as the <strong style="color: blue">lm</strong> code. <strong style="color: blue">lmgf</strong> is a Green’s function method: Green’s functions have less information than wave functions, so in one sense the things you can do with <strong style="color: blue">lmgf</strong> are more limited: you cannot make the bands directly, for example. However, <strong style="color: blue">lmgf</strong> enables you to do things you cannot with <strong style="color: blue">lm</strong>. The most imprortant ones are:</p> <ul> <li>Calculate magnetic exchange interactions</li> <li>Calculate magnetic susceptibility (spin-spin, spin-orbit, orbit-orbit parts)</li> <li>Calculate properties of disordered materials, either chemically disordered or spin disorder from finite temperature, within the Coherent Potential Approximation, or CPA.</li> <li>Calculate the ASA static susceptibility at <script type="math/tex">q=0</script> to help converge calculations to self-consistency.</li> </ul> <h3 id="structure-of-greens-function-program"><em>Structure of Green’s function program</em></h3> <hr /> <p><strong style="color: blue">lmgf</strong> runs in much the same way as <strong style="color: blue">lm</strong>. The band pass routine of <strong style="color: blue">lm</strong>, <strong style="color: green">bndasa.f</strong>, generates the eigenvalues and eigenvectors, which can in turn generate the quantities of interest. <strong style="color: green">bndasa</strong> is replaced by a Green’s function routine, <strong style="color: green">gfasa</strong>. <strong style="color: green">gfasa</strong> can generate output moments, DOS, density-matrix, etc., in the same way as <strong style="color: green">bndasa</strong> does.</p> <p>In contrast to band methods (implemented in <strong style="color: blue">lm</strong>) where the Hamiltonian <script type="math/tex">H</script> is energy independent and all the bands are generated by diagonalizing H, Green’s functions are calculated for a specific energy; information is extracted from <script type="math/tex">G</script> for a particular energy.</p> <p>This fact highlights the strengths and weaknesses of a Green’s function approach. Energy-integrated properties such as the moments, must be obtained by integrating over energy. Calculating <script type="math/tex">G</script> explicitly at a family of energies is more cumbersome than diaonalizing a hamiltonian. On the other hand, Green’s function methods are naturally suited to contexts where the energy-dependence is needed anyway. CPA theory yields an energy-dependent potential; Green’s functions are a natural way to implement it. Similarly, noninteracting susceptibilities can be expressed as G×G (`×’ implies either convolution or product, depending on the space you are working in).</p> <p><strong style="color: blue">lmgf</strong> always loops over some energy contour; what contour you use depends on the context as described below. <strong style="color: green">gfasa</strong> accumulates various kinds of data for each mesh point, such as the point’s contribution from energy moments used in an ASA self-consistent cycle. Finally, an estimate for the Fermi level <script type="math/tex">E_F</script> is determined using a from Pade approximation. If the original guess for <script type="math/tex">E_F</script> is sufficiently close, the cycle is finished as in <strong style="color: blue">lm</strong>. If the estimate is too far off, a new energy mesh is taken and the process is repeated.</p> <h3 id="energy-contours-potential-shifts-and-the-determination-of-the-fermi-level"><em>Energy Contours, Potential Shifts and the Determination of the Fermi Level</em></h3> <hr /> <p>For energy-integrated properties, a very fine energy mesh would be required if the energy integration were carried out close to the real axis. It is much more efficient to deform the integration contour into an elliptical path in the complex plane, approaching the real axis only at the lower and upper integration limits.</p> <p>To integrate quantities over occupied states, integration to the Fermi level <em>E<sub>F</sub></em> is required. <em>E<sub>F</sub></em> is not known but must be fixed by charge neutrality. Thus <script type="math/tex">E_F</script> must be guessed at and iteratively refined until the charge neutrality condition is satisfied. <strong style="color: blue">lmgf</strong> does not vary <em>E<sub>F</sub></em>; the user specifies it at the outset. Instead <strong style="color: blue">lmgf</strong> looks for a constant potential shift that satisfies charge neutrality; this must be searched for iteratively. Both the potential shift and <script type="math/tex">E_F</script> are maintained in a file <em style="color: green">vshft.ext</em>. Inspection of <em style="color: green">vshft.ext</em> may look unecessarily complicated; it’s because you can use the file to add site-dependent shifts. <em style="color: green">vshft.ext</em> is also used by the layer Green’s function code <strong style="color: blue">lmpg</strong>, which requires extra information about shifts on the left and right leads.</p> <p>Metals and nonmetals are distinguished in that in the latter case, there is no DOS in the gap and therefore the Fermi level (or potential shift) cannot be specified precisely.</p> <p><strong>Metal case</strong> (set by <strong>BZ_METAL=1</strong>): once the <script type="math/tex">k</script>- and energy-points are summed over and the deviation from charge neutrality is determined, the code will attempt to find the potential shift that fixes charge neutrality.</p> <div onclick="elm = document.getElementById('metal'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> <b>Click here</b> for description of how the Fermi level is found for a metal. </div> <p><div style="display:none;padding:0px;" id="metal"></p> <p>It finds the Fermi level in one of two ways:</p> <ul> <li> <p>Using a Pade approximant, <strong style="color: blue">lmgf</strong> interpolates the diagonal elements of G. The interpolation is used to evaluate the GF on the starting elliptical contour shifted rigidly by a constant, and the shift is iterated until the charge-neutrality condition is satisfied. At this stage, there are two possibilities:</p> <p>1. repeat the integration of <script type="math/tex">G</script> over <script type="math/tex">k</script> and the energy contour with the constant shift added to the potential.</p> <p>2. Assume that the Pade-approximant to the diagonal <script type="math/tex">G</script> is a sufficiently good estimate for the actual <script type="math/tex">G</script>.</p> <p>If the potential shift is larger than a user-specifed tolerance (see padtol in <strong>GF_GFOPTS</strong> below), option 1 is taken and the Pade shift re-evaluated. A new Pade estimate is made for the potential shift requiring charge neutrality, and it is tested once against the user-specified tolerance.</p> <p>When the shift falls below the tolerance, option 2 is taken and <strong style="color: blue">lmgf</strong> proceeds to the next step. The user is advised to monitor these shifts and the deviation from charge neutrality.</p> </li> <li> <p>The charge is integrated in a contour near the real axis subsequent to the elliptical contour. In this mode, the determination of the potential shift is accomplished by continuing the integration contour on the real axis starting from the originally estimated Fermi level. A trapezoidal rule is used (or Simpson’s rule using a Pade approximate for the midpoint), and new energy points are computed and integrals accumulated until charge neutrality is found. There is no iterative scheme as with the Pade approximation. This option tends to be a little less accurate than the Pade, but somewhat more stable as it is less susceptible to interpolation errors.</p> </li> </ul> <p>One last comment about the METAL case: by default the program will save the potential shift to use in the next iteration. You can suppress this save (see frzvc below), which again can be less accurate, but more stable. In particular, if you are working with an insulator where stability can be an issue (determination of the Fermi level is somewhat ill conditioned), a stable procedure is to use this option together with second energy integration scheme described above (the integration contour on the real axis).</p> <p></div></p> <p><strong>Nonmetal case</strong> (set by <strong>BZ METAL=0</strong>): <strong style="color: blue">lmgf</strong> will not attempt to shift the potential, or ensure charge neutrality. The user is cautioned to to pay rather closer attention to deviations from charge neutrality. It can happen because of numerical integration errors, or because your assumed Fermi level does not fall within the gap. You can use <strong>METAL=1</strong> even if the material is a nonmetal.</p> <h5 id="some-details-concerning-how-lmgf-works-internally"><em>Some details concerning how lmgf works internally</em></h5> <hr /> <p>For each energy point, the BZ integration is accomplished by routine in <strong style="color: green">gf/gfibz.f</strong>, which loops over all irreducible points, generating the “scattering path operator” <script type="math/tex">g</script> and the corresponding <script type="math/tex">g</script> for all the points in the star of <script type="math/tex">k</script> to generate a properly symmetrized <script type="math/tex">g</script>. Within the ASA, second-generation LMTO, <script type="math/tex">g</script> is converted to proper Green’s function <script type="math/tex">G</script>, corresponding to the orthogonal gamma representation by an energy scaling. The scaling is carried out in routine <strong style="color: green">gf/gfg2g.f</strong>. Next the various integrated quantities sought are assembled (done by <strong style="color: green">gf/gfidos.f</strong>). The potential shift to satisfy charge neutrality is found, and stored in <em style="color: green">vshft.ext</em>. The I/O is handled by routine <strong style="color: green">subs/iovshf.f</strong>.</p> <h3 id="gf-specific-input"><em>GF specific input</em></h3> <hr /> <h4 id="energy-integration"><em>Energy integration</em></h4> <hr /> <p>Green’s functions are always performed on some energy contour, which is discretized into a mesh of points in the complex energy plane. (A description of the various kinds of contours this code uses is documented in the comments to <strong style="color: green">gf/emesh.f</strong>.) <script type="math/tex">G</script> is “spikey” for energies on the real axis (it has poles where there are eigenstates).</p> <h5 id="the-bzemesh-token"><em>The</em> BZ_EMESH <em>token</em></h5> <p>To compute energy-integrated properties such as magnetic moments or the static susceptibility, the calculation is most efficiently done by deforming the contour in an ellipse in the complex plane.</p> <p>At other times you want properties on the real axis, e.g. density-of-states or spectral functions. You specify the contour in category <strong>BZ</strong> as:</p><pre><code>EMESH= nz mode emin emax [other args, depending mode]
</code></pre><p>where</p><pre><code>    nz         number of energy points
    mode       specifies the kind of contour; see below
    emin,emax  are the energy window (emax is usually the Fermi level)
</code></pre><p>Right now there are the following contours:</p> <p><strong>mode=10</strong>: a Gaussian quadrature on an ellipse. This is the standard mode for integrating over the occupied states.</p><pre><code>EMESH= nz 10 emin emax ecc eps

       ecc is the eccentricity of the ellipse, ranging from 0 (circle) to 1 (line)
       eps is a 'bunching' parameter that, as made larger, tends to bunch points near emax.  
           As a rule, e2=0 is good, or maybe e2=.5 to emphasize points near the Fermi level.
</code></pre><p>After the integration is completed, there will be some deviation from charge neutrality, because emax will not exactly correspond to the Fermi level. This deviation is ignored if <strong>METAL=0</strong>; otherwise, the mesh is rigidly shifted by a constant amount, and the diagonal GF interpolated using a Pade approximant to the shifted mesh. The shifting+interpolation is iterated until charge neutrality is found, as described in section 2. If the rigid shift exceeds a specified tolerance, the Pade interpolation may be suspect. Thus, the entire cycle is repeated from scratch, on the shifted mesh where the shift is estimated by Pade.</p> <p><strong>mode=0</strong>: a uniform mesh of points between emin and emax, with a constant imaginary component.</p><pre><code>EMESH= nz 0 emin emax Im-z [... + possible args for layer geometry.]
       Im-z is the (constant) imaginary component.
</code></pre><p>This mode is generally not recommended for self-consistent cycles because the GF has a lot of structure close to the real axis (small <script type="math/tex">{\rm Im}\, z</script>), while shifting off the real axis introduces errors. It is used, however, in other contexts, e.g. transport.</p> <p><strong>mode=110</strong>: is a contour input specific to nonequilibrium Green’s function.</p> <div onclick="elm = document.getElementById('mode110'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> <b>Click here</b> for description of this special purpose mode. </div> <p><div style="display:none;padding:0px;" id="mode110"></p> <p>The nonequilibrium Green’s function requires additional information for the energy window between the left and right leads. (The nonequilibrium Green’s function is implemented for the layer geometry in <strong style="color: blue">lmpg</strong>.) Thus the integration proceeds in two parts: first an integration on an elliptical path is taken to the left Fermi level (as in <strong>mode=10</strong>). Then an integration over is performed on the nonequilibrium contour, i.e. the energy window from the left to the right Fermi level. This integration is performed on a uniform mesh close to the real axis, as in <strong>mode=0</strong>. For the nonequilibrium contour, three additional pieces of information must be supplied:</p><pre><code>  nzne  number of (uniformly spaced energy points on the nonequilibrium contour
  vne   difference in fermi energies of right and left leads, ef(R)-ef(L)
  delne Im-z on the nonequilibrium contour
</code></pre><p>The mesh is specified as</p><pre><code>EMESH= nz 110 emin ef(L) ecc eps nzne vne delne [del00]
</code></pre><p>The last argument plays the role of <strong>delne</strong> specifically for computing the self-energy of the left and right leads. There is an incompatibility in the requirements for <script type="math/tex">{\rm Im}\, z</script> in the central and end regions. The same incompatibility applies to transport and is discussed in the <a href="/docs/code/lmgf/#modifications-of-energy-contour-for-layer-geometry">following section.</a></p> <p></div></p> <p><strong>mode=310</strong>: Alternative Pade approximant in finding Fermi level.</p> <div onclick="elm = document.getElementById('mode310'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> <b>Click here</b> for description of this special purpose mode. </div> <p><div style="display:none;padding:0px;" id="mode310"></p> <p>a Gaussian quadrature on an ellipse to a trial emax, as in <strong>mode 2</strong>. However, the search for the Fermi level is not done by Pade approximant, as in <strong>mode 10</strong>. Instead, a second integration proceeds along a uniform mesh from emax to some (Fermi) energy which satisfies charge neutrality. This procedure is not iterative.</p><pre><code>EMESH= nz 310 emin emax e1 e2 delz

       e1 and e2 are just as in mode 10
       delz      is the spacing between energy points for the 
                 second integration on the uniform mesh.
</code></pre><p></div></p> <p><strong>mode=2</strong>: is the same contour as mode=0. However, it is designed for cases when you want to resolve the energy dependence of some quantity, such as the DOS or magnetic exchange coupling. These are discussed in the GF category below.</p> <h5 id="modifications-of-energy-contour-for-layer-geometry"><em>Modifications of energy contour for layer geometry</em></h5> <!-- /docs/code/lmgf/#modifications-of-energy-contour-for-layer-geometry --> <p>When computing transmission coefficients via the Landauer-Buttiker formalism, one chooses a contour as in <strong>mode=0</strong>. However, there is a problem in how to choose <script type="math/tex">{\rm Im}\, z</script>. A small <script type="math/tex">{\rm Im}\, z</script> is needed for a reliable calculation of the transmission coefficient, but using a small <script type="math/tex">{\rm Im}\, z</script> to determine the surface Green’s function may not succeed because the GF can become long range and the iterative cycle used to generate it may not be stable. To accomodate these conflicting requirements, a surface-specific <script type="math/tex">{\rm Im}\, z</script> should be used, called <strong>del00</strong>. The <strong>mode=0</strong> mesh is specified as</p><pre><code>EMESH= nz 0 emin emax delta xx xx xx xx del00
</code></pre><p><strong>delta</strong> is Im <em>z</em> for the central region; <strong>del00</strong> is <script type="math/tex">{\rm Im}\, z</script> for the surfaces.</p> <p>Entries <strong>xx</strong> have no meaning but are put there for compatibility with the contour used in nonequilibrium calculations. (A similar situation applies to the nonequilibrium part of the contour).</p> <p>The mesh for self-consistent nonequilibrium calculations is</p><pre><code>EMESH= nz 110 emin ef(L) ecc eps nzne vne delne del00
</code></pre><h4 id="greens-function-category"><em>Green’s function category</em></h4> <hr /> <p><strong style="color: blue">lmgf</strong> requires a GF-specific category.</p><pre><code>GF  MODE=1 GFOPTS=options
</code></pre><h5 id="the-gfmode-token"><em>The</em> GF_MODE <em>token</em></h5> <p>Token <strong>MODE=</strong> controls what <strong style="color: blue">lmgf</strong> calculates. Options are <strong>MODE=1</strong>, <strong>MODE=10</strong>, <strong>MODE=11</strong>, <strong>MODE=26</strong>, described below.</p> <p><strong>MODE=1</strong> goes through the usual cycle calling <strong style="color: green">gfasa</strong>. It performs a function analogous to <strong style="color: green">bndasa</strong> in the band program, generating output density, moments, and optionally other quantities such as density-of-states.</p> <p>Taken with the special integration contour <strong>mode=2</strong> (see <strong>EMESH</strong> above), <script type="math/tex">N(E)</script> and its integral are computed and tabulated over the window specified.</p> <div onclick="elm = document.getElementById('mode2'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> <b>Click here</b> for description of this special purpose mode. </div> <p><div style="display:none;padding:0px;" id="mode2"></p> <p>With the following sample input segment:</p><pre><code>% const ef=-0.025725
BZ      EMESH=5 2 {ef} {ef+.002*4} .001 0
</code></pre><p>the integration would be tabulated for five points ef, ef+.002, ef+.004, ef+.006, ef+.008 like so (spin-polarized case)</p><pre><code>       Re z       Im z   spin       dos           idos
    -0.025725   0.001000   1      13.55272       0.00000
    -0.025725   0.001000   2      10.38435       0.00000
    -0.025725   0.001000   t      23.93706       0.00000
    -0.023725   0.001000   1       9.17407       0.02273
    -0.023725   0.001000   2       4.13694       0.01452
    -0.023725   0.001000   t      13.31101       0.03725
    -0.021725   0.001000   1      15.33776       0.04724
    -0.021725   0.001000   2       7.42200       0.02608
    -0.021725   0.001000   t      22.75976       0.07332
    -0.019725   0.001000   1      19.58433       0.08216
    -0.019725   0.001000   2       7.52708       0.04103
    -0.019725   0.001000   t      27.11141       0.12319
    -0.017725   0.001000   1      20.83078       0.12258
    -0.017725   0.001000   2       9.31350       0.05787
    -0.017725   0.001000   t      30.14428       0.18045
</code></pre><p>If the partial DOS is generated, the usual tokens in the BZ category specifying the window (<strong>DOS=</strong>) and number of points (<strong>NPTS=</strong>) are overridden by the parameters in <strong>EMESH</strong>.</p> <p></div></p> <p><strong>MODE=10</strong> invokes a special branch that computes magnetic exchange interactions using a linear response technique.</p> <div onclick="elm = document.getElementById('mode10'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> <b>Click here</b> for description of mode 10. </div> <p><div style="display:none;padding:0px;" id="mode10"></p> <p>In particular, <script type="math/tex">J_{ij}</script> is computed for pairs of sites <script type="math/tex">(i,j)</script>, where the <script type="math/tex">J</script>’s are the parameters in the Heisenberg hamiltonian</p> <script type="math/tex; mode=display">E(s_i, s_j) = \sum_{ij} J_{ij} s_i s_j</script> <p>Thus, the <em>J</em>’s are coefficients to energy changes for small rotations of the spins. It can be computed from a change in the band energy, and small rotations can be done analytically.</p> <p>Taken with the usual elliptical integration contour, the <em>J</em>’s are computed by energy integration to the Fermi level. Taken with the special integration contour <strong>mode=2</strong> (see EMESH above), <strong>dJ/dE</strong> is computed instead. There is a shell script</p><pre><code>$ gf/test/getJq0z
</code></pre><p>(invoke with no arguments to see usage) that will collect some of the ouput for you into tables. The data are collected into file <strong style="color: green">dj0dz</strong>. For an example illustrating this mode, invoke</p><pre><code>$ gf/test/test.gf co 5 
</code></pre><p>This test computes the exchange coupling both for the usual elliptical contour and resolves the energy-dependence of <em>J</em> in a small window near the Fermi level.</p> <p>Often only some atoms are magnetic, and all that is desired are the exchange parameters <em>J</em> connecting a partial list of sites to its neighbors. This can be useful, even essential for large systems, because it can be very expensive both in time and memory to compute exchange interactions for all pairs. To compute exchanges only for a list of sites, use command-line argument</p><pre><code>--sites:pair:site-list
</code></pre><p>For more details, see <a href="/docs/code/lmgf/#lmgf-specific-command-line-arguments">command-line arguments</a> invoked with <strong style="color: blue">lmgf</strong>.</p> <p><strong style="color: red">Caution</strong>. <strong style="color: blue">lmgf</strong> reads and writes a potential shift file <em style="color: green">vshft.ext</em> which shifts site potential by a constant to cause the Fermi level to match what is specified by the input. This shift also gets added into the atom file; potential <strong>VES</strong> in line <strong>PPAR</strong> is adjusted. When calculating exchange interactions, <em style="color: green">vshft.ext</em> is not read. However, the shift is preserved because they are held in the potential parameters section of the atom file. But if you run the atom part <strong style="color: blue">lm</strong> or <strong style="color: blue">lmgf</strong> and remake the PP’s from the moments (<strong>START BEGMOM=1</strong>), this causes estat potential to be remade, but the sphere program does not add the contents <strong style="color: green">vshft</strong> (it is done at the start of the Green’s function calculation). The exchange parameters should be evaluated with the potential parameters generated by <strong style="color: blue">lmgf</strong>. If they are alternatively evaluated from the atom files generated by <strong style="color: blue">lm</strong>, the Fermi level needs to be aligned to the Fermi level of <strong style="color: blue">lm</strong> (or close to it; there are slight differences between Fermi levels generated by <strong style="color: blue">lm</strong> and by <strong style="color: blue">lmgf</strong>).</p> <p></div></p> <p><strong>MODE=11</strong> is an exchange branch that is run after <strong>MODE=10</strong>. It prints out the <script type="math/tex">J_{ij}</script> and does several other analyses.</p> <p>Switch <code>--sites:pair:site-list</code> applies to mode 11 as well as mode 10; see <a href="/docs/code/lmgf/#lmgf-specific-command-line-arguments">command-line arguments</a>.</p> <h5 id="the-gfgfopts-token"><em>The</em> GF_GFOPTS <em>token</em></h5> <p>Token <strong>GFOPTS=</strong> option-list causes <strong style="color: green">gfasa</strong> to do a variety of different things.</p> <p>Options are entered as a series of strings <strong>string1;string2;…</strong></p> <p>Option strings are:</p><pre><code>emom   generate the output ASA moments, needed for self-consistency
idos   make integrated properties, such as the sum of one-electron energies
dmat   make the density-matrix G_RL,R'L'
sdmat  make the site-diagonal density-matrix G_RL,RL'
       The density matrix is written to a file 'dmat'
pdos   Make the partial density of states (this has never been checked)
p3     Use third order potential functions
padtol Set the tolerance for maximum potential shift permissible by
       Pade interpolation, as described above
frzvc  Suppress saving the constant potential shift used 
       to determine charge neutrality
</code></pre><h3 id="lmgf-specific-command-line-arguments"><em>lmgf-specific command-line arguments</em></h3> <!-- /docs/code/lmgf/#lmgf-specific-command-line-arguments --> <hr /><pre><code>-ef=# overrides upper limit of energy integration (Fermi level) and assigns to #
</code></pre><p>The following are specific to the exchange calculation <strong>modes 10</strong> and <strong>11</strong>:</p><pre><code>--sites[:pair]:site-list  Make the exchange parameters J_ij only for 
      sites i in the site list.  In mode 11, option :pair means
      that only parameters J_ij where both i and j are printed.
</code></pre><p><em>Example</em>: running <strong style="color: blue">lmgf</strong> using <strong>MODE=10</strong> with this command line argument</p><pre><code>--sites:pair:1,3,5,7
</code></pre><p>generates <em>J</em> connecting sites 1, 3, 5 and 7 to all neighbors. See <a href="/docs/misc/integerlists/">Syntax of Integer Lists</a> for the syntax of <strong>site-list</strong>.</p> <p>Running <strong style="color: blue">lmgf</strong> using <strong>MODE=11</strong> with the same <strong>--sites</strong> argument will print out the exchanges just between pairs of these sites.</p> <p>Running <strong style="color: blue">lmgf</strong> using <strong>MODE=11</strong> without any <strong>--sites</strong> argument will print out the exchanges between these sites and all neighbors.</p><pre><code>--wrsj[:fn=name][:scl=#][:tol=#]  (mode 11 only)
  Writes the Heisenberg exchange parameters in a standard format,
  suitable for use in spin dynamics simulations.
    fn=name writes to file 'name'  (default name is rsj)
    scl=#   scales the parameters by #
    tol=#   writes only parameters with energy &gt; tol

--rcut=# 
  Truncates the range of the R.S exchange paremeters ... 
  useful to assist in the determination of the effect distant neighbors.

--2xmsh
  When integrating over the BZ to estimate Tc from Tablikov formula, this option doubles the k-mesh.
  Can be helpful in testing k-convergence of the singular q-&gt;0 limit entering into the formula.

--amoms=mom1,mom2,...
--amom=mom1,mom2,...
  This switch overrides ASA moments (which are automatically generated).
  The first switch reads a vector of nbas moments, one for each site.
  The first switch reads a vector of nclass moments, one for each class.
</code></pre><p>Sphere magnetic moments are tabulated in the printout at the end of <strong>mode 10</strong>, and the start of <strong>mode 11</strong>. If you are importing exchange parameters (file <em style="color: green">jr.ext</em> , e.g. from the full-potential code, you will want to supply the moments calculated from that program.)</p> <h3 id="test-cases-and-examples"><em>Test cases and examples</em></h3> <hr /> <p>This script:</p><pre><code>$ gf/test/test.gf
</code></pre><p>carries out a number of tests, which also demonstrate various branches of the code. To see the materials and corresponding tests try</p><pre><code>$ gf/test/test.gf --list
</code></pre></article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
