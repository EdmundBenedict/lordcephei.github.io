<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>LM Suite - Full Potential LDA Bandpass</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="LM Suite - Full Potential LDA Bandpass" /> <meta property="og:description" content="»LM Suite« is a program for for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//fpbandpass/" /> <meta property="og:site_name" content="LM Suite" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="show-for-small-only"><a href="https://lordcephei.github.io" class="icon-tree"> LM Suite</a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="right"> <script language="Javascript" type="text/javascript"> function google_search() { var query = document.getElementById("google-search").value; window.open("http://google.com/search?q=" + query + "%20site:" + "https://lordcephei.github.io"); } </script> <li class="divider"></li> <li style="background:#FFFFFF"> <form style="width:200px" onsubmit="google_search()" > <input type="text" id="google-search" placeholder="Enter search term and hit enter"> </form> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> </ul> <ul class="left"> <li><a href="https://lordcephei.github.io/">Start</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/blog/">News and Updates</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io/docs/">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/install/">Installation</a></li> <li><a href="https://lordcephei.github.io/fplmtoverview/">FP Overview</a></li> <li><a href="https://lordcephei.github.io/fpcapabilities/">FP Capabilities</a></li> <li><a href="https://lordcephei.github.io/inputguide/">The Input File</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/buildingfpinput/">Building the FP Input File</a></li> <li><a href="https://lordcephei.github.io/fpnew/">Tutorial for the full-potential LDA program lmf</a></li> <li><a href="https://lordcephei.github.io/fpoptbas/">FP basis optimisation</a></li> <li><a href="https://lordcephei.github.io/extbfield/">Adding external Zeeman field to the potential</a></li> <li><a href="https://lordcephei.github.io/fstut/">Generating a Fermi surface in spin polarized Fe</a></li> <li><a href="https://lordcephei.github.io/lmtut/">LM Tutorial</a></li> <li><a href="https://lordcephei.github.io/asadoc/">ASA tutorial</a></li> </ul> </li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> <li class="divider"></li> </ul> </section> </nav> </div><!-- /#navigation --> <div id="masthead"> <div class="row"> <div class="small-12 columns"> <a id="logo" href="https://lordcephei.github.io" title="LM Suite – Simulating the world one bit at a time."> <img src="https://lordcephei.github.io/assets/img/logo3.png" alt="LM Suite – Simulating the world one bit at a time."> </a> </div><!-- /.small-12.columns --> </div><!-- /.row --> </div><!-- /#masthead --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>LM Suite - Full Potential LDA Bandpass</h1> </header> <p class="teaser"> </p> <p>To go back to the preliminaries click <a href="/fpnew/">here</a>.</p> <p>Start with <strong>lmchk</strong> just to verify some things.</p> <ul> <li> <p>Verify that the preprocessor works as advertised: try</p><pre><code>       lmchk al --showp
</code></pre><p>For example, the line containing RSMH= should have been turned into</p><pre><code>       RSMH=1.8,1.8,1.8 EH=-.1,-.1,-.1
</code></pre></li> <li> <p>Invoke</p><pre><code>       lmchk al
</code></pre><p>and verify from the <a href="FPsamples/out.al.lmchk">output</a> that the sphere overlaps about 0.6% (a safe number) and that sum-of-sphere volumes equals about 75% of the total. That is a pretty large packing fraction, as a consequence of the close packing of the fcc structure.</p> </li> <li> <p>Invoke <strong>lmfa</strong> to generate densities for the free atom. Atomic densities will be overlapped to make a first trial density for the solid (Mattheis construction).</p><pre><code>       lmfa al
</code></pre><p><strong>lmfa</strong>’s main function is to generate atomic densities and store them in atm.<em>ext</em>. Look at the <a href="FPsamples/out.al.lmfa">standard output</a>:</p> <ol> <li> <p>The atomic density is represented inside the MT spheres on a shifted logarithmic radial mesh: the <em>i_th mesh point is _ri</em> = <em>b</em>[exp(<em>a</em>(<em>i</em>−1)−1]. The mesh is determined by the MT radius, mesh spacing parameter and number of points (<a href="FPsamples/out.al.lmfa#species">rmt, a, and nr</a>).</p> </li> <li> <p>The atomic density is completely determined by the charges in each <em>l</em> channel (2,1,0 for <em>spd</em>). These are automatically supplied from an internal default; alternatively you can specify them with <a href="tokens.html#SPECcat">SPEC_ATOM_Q</a>. Self-consistency is reach after 47 iterations; then <a href="FPsamples/out.al.lmfa#energies">total energies and atomic levels</a> and other information about the atomic wave functions are printed out, e.g. the charge spilling outside the MT radius. Total energy is needed to compute the heat formation of a crystal from the free-atom constituents.</p> <p><em>*Note</em> When calculating cohesive energies (the change in energy on forming a solid from separate atoms), the proper reference energy must be computed for the spin polarized case. That is how the number in the input file (EREF=-483.5463) was computed. It is slightly lower than what <strong>lmfa</strong> generates here for the nonmagnetic atom (-483.5325 Ry).</p> </li> <li> <p>Optimal values for envelope parameters <a href="FPsamples/out.al.lmfa#rsmh">RSMH and EH</a> were detemined numerically by minimizing the total energy with respect to them. They are optimal, unfortunately, for the free atom only; but the choices are not bad and you can use the optimizer to improve them. <br /> Also you can have the <strong>lmfa</strong> save these parameters and <strong>lmf</strong> read them, and save the trouble of estimating them yourself. This is accomplished with tokens in <a href="tokens.html#HAMcat">HAM_AUTOBAS</a>. See <a href="Building_FP_input_file.html#autobas">this tutorial</a> for an example.</p> </li> <li> <p>The density for <em>r</em>&gt;rmt is fit to a linear combination of smoothed Hankels of various energies with a fixed smoothing radius specified by <a href="fp.html#spec">SPEC_RSMFA</a>. Coefficients are stored in file atm.al.</p> </li> <li> <p>In this setup the core is allowed to spill into the interstitial (interstitial charge q=3.59e-4). The core tails are fit to a single smoothed Hankel with smoothing radius specified by <a href="fp.html#spec">SPEC_RFOCA</a>. Its contribution to the interstitial density will be included.</p> </li> </ol> </li> <li> <p>Invoke <strong>lmf</strong> in a <a href="#OPTIONS">non self-consistent mode</a></p><pre><code>      lmf al -vhf=1
</code></pre><p><em>*Note</em> You can change how much text is output with token <a href="IOcat">IO_VERBOSE</a>. The default verbosity (31) is relatively terse.</p> <p>Note the following points in the output file (it was doctored slightly to incorporate some hyperlinks) 1. The <a href="FPsamples/out.al.lmf.hf#start">first stages</a> of the output (symmetry group, k-points) follow the <a href="ASAtutorial.html#lm">ASA tutorial</a>. <br /> XC:BH &amp;larr means the Barth Hedin exchange correlation functional is used. <br /> Autoread:none &amp;larr the basis set is taken from the input file. This line looks different if you <a href="Building_FP_input_file.html#autobas">read basis information from a file</a>. <br /> bz: metal(2), tetra, invit &amp;larr the system is to be treated as a metal using <a href="bzintegration.html">tetrahedron integration</a>.</p> <ol> <li> <p>Lattice data and symmetry operations are printed next. In this case no symmetry was specified and 48 operations were found automatically.</p> </li> <li> <p>Next follows a <a href="FPsamples/out.al.lmf.hf#specparm">table</a> of important species data. It is advisable to pay some attention to these parameters, as they can affect the results. In general, apart from the MT radius, and the augmentation lmxa which you must supply, most parameters have good internal defaults.</p> <ul> <li>The augmentation <em>l</em>-cutoff lmxa can be set very low in this FP program. The reason for this is is rather subtle and is connected with the special way augmentation is done; see the <a href="nfp-doc.ps">manual</a> describing this method. It has some elements in common with what amounts to augmentation in the PAW method: this form offers a justification for the <em>a posteriori</em> fact that pseudopotential <em>l</em>-cutoffs can be much lower than corresponding cutoffs in usual all-electron implementations. Try seeing what happens by increasing lmxa to 3 or 4. lmxa=2 is acceptable here; a more typical value is 3; it should be 4 for transition metal elements and 6 for <em>f</em> elements.</li> <li> <p>The choice of rmt was mentioned <a href="#spec">previously</a> and is discussed in the <a href="ASAtutorial.html#SPEC">ASA tutorial</a>.</p> </li> <li>See the <a href="fp.html#spec">FP documentation</a> for a discussion of augmentation smoothing radius rsma, and the polynomial cutoff kmxa connected with it. <br /> <em>*Note</em> The internal default for kmxa is usually adequate for the LMTO basis set. If you include plane waves in the basis, this number should increase (the internal default increases). Even so this cutoff should be monitored especially if you use a relatively high PW cutoff, e.g. 5 Ry.</li> <li>Although the density <em>l</em>-cutoff lmxl is distinct from the augmentation <em>l</em>-cutoff lmxa, usually you just choose lmxl=lmxa. That’s the default unless you specify otherwise.</li> <li>Parameter rg corresponds to token <a href="fp.html#spec">RSMG</a>.</li> <li>Parameters rsmv and kmxv are connected with how the program manages the electrostatic interaction between spheres and interstitial. They not usually of interest.</li> <li>foca corresponds to token <a href="fp.html#spec">LFOCA</a>. LFOCA=1 is safest; LFOCA=2 is a perturbative approximation and is more efficient, and corresponds approximately to the “nonlinear core correction” common in pseudopotential programs. The difference can be important if the atom has shallow core states. In this case, choosing LFOCA=1 or 2 changes the total energy by less than 10−6 Ry.</li> <li>For either choice of lfoca there is a corresponding smoothing radius rfoca, specified by <a href="fp.html#spec">RFOCA</a>. Choosing rfoca large makes the density smoother and easier to manage, but degrades the quality of fit of the core density, which in turn will affect the total energy somewhat. For example it will create some dependence of the total energy on choice of MT radius. Choosing rfoca more sharply peaks the (smoothed) core density, and puts greater demands on the quality of the interstitial mesh density, which slows down the calculation.</li> </ul> </li> <li> <p>Next follows the setting of the <a href="FPsamples/out.al.lmf.hf#meshparm">mesh density</a> which you do by one of the tokens <a href="tokens.html#HAMcat">GMAX</a> or <a href="tokens.html#HAMcat">FTMESH</a> in HAM. Finer meshes are more accurate, but the computation time scales in proportion to the total number of points. Column “last term” is an estimate of the error in the envelope function when expanded in plane waves. It should not be too large: 10−5 is usually quite acceptable. If it is too large, the FT mesh should be increased (larger GMAX or FTMESH). If the numbers in the “cutoff” column are all small compared to the total number of <strong>G</strong> vectors in the the mesh, you can safely reduce the fineness of the mesh. This particular choice of gmax=7 is extremely conservative: a.u. generated 10×10×10 divisions, or 609 G vectors. The cutoff column of the table show many G vectors are needed for each orbital to be converged with the specified tolerance (you specify tolerance with <a href="tokens.html#HAMcat">TOL</a>). It is evident from the table that the most G vectors any orbital needs is less than 200, far less than the 609 possible with gmax=7. In this case, reducing gmax to as low as 4 reduces the maximum number of G vectors to 113, and changes the total energy by ~10−5 Ry. In general the mesh density must be fine as the most strongly peaked orbital in the basis. <a href="Building_FP_input_file.html#gmax">This tutorial</a> shows how mesh requirements are strongly affected by the character of states entering into the basis, and how you can use <strong>lmfa</strong> to select a reasonable value for you.</p> </li> <li> <p>The lines around <a href="FPsamples/out.al.lmf.hf#meshparm">Makidx</a> show the dimensions of the hamiltonian. In the present FP context, the only meaningful number is the `Low’ dimension. This calculation uses a standard minimal basis of 9 <em>spd</em> orbitals.</p> </li> <li>Next <strong>lmf</strong> looks for an <a href="fp.html#programs">input density</a>. It can start from free-atom files or from a restart file. Unless you specify with command-line switch <a href="Command-line-options.html#section1lmf">–rs=</a>, <strong>lmf</strong> will: <ul> <li>try to read from (binary) restart file rst.<em>ext</em>.</li> <li>If this fails, it will to read <a href="#lmfa">atm.<em>ext</em></a> and create a density by overlapping free-atom charges. That is what is done <a href="FPsamples/out.al.lmf.hf#startingrho">here</a> as no rst file is yet available.</li> <li>If this also fails, <strong>lmf</strong> aborts.</li> </ul> </li> <li> <p>Next <strong>lmf</strong> begins the <a href="FPsamples/out.al.lmf.hf#iteration1">iterations cycle</a>. First the interstitial potential is created, followed by local potentials and potential parameters for each site in the lattice (there is only one site in this example).</p> </li> <li> <p>Next follows a <a href="FPsamples/out.al.lmf.hf#iteration1table1">table</a> summarizing the charge, magnetic moment (in the spin polarized case) and all parameters needed to compute the total energy, except the eigenvalue sum, which it determines after a band pass.</p> </li> <li> <p>Next follows the <a href="FPsamples/out.al.lmf.hf#bzint">Brillouin zone</a> integration over k-points. Because the input file chose tetrahedron integration with <a href="tokens.html#BZcat">METAL=2</a>, <strong>lmf</strong> tries to read k-point weights from the `wkp’ file, so that it can <em>use weights from a prior iteration</em> for the present band pass. Since the file doesn’t have the right number of k-points, <strong>lmf</strong> makes a special band pass to create the weights. Use <a href="tokens.html#BZcat">METAL=3</a> if you want <strong>lmf</strong> to create the weights every band pass. This is safer, because there is a guaranteed connection between the weights and the eigenvalues, but slower because two passes are required each iteration. The recommended choice is METAL=5: it combines the best of METAL=2 and METAL=3. But this mode keeps eigenvectors in memory, and is more memory intensive, so don’t use METAL=5 for large systems.</p> </li> <li> <p>The determination of the <a href="FPsamples/out.al.lmf.hf#efermi">Fermi level</a> proceeds in the same way as in the ASA; see the <a href="ASAtutorial.html#efermi">ASA tutorial</a>, and also <a href="bzintegration.html">this page</a> for a detailed discussion of the tetrahedron method for Brillouin zone integration. Note that the total density-of-states was made. This is because BZ_SAVDOS=t. Setting this token causes the DOS to be generated and written to dos.<em>ext</em>.</p> </li> <li>The Harris-Foulkes total energy is calculated (it requires only the input density and band energy to evaluate). This is a <a href="#OPTIONS">non self-consistent</a> calculation, so no output density is generated and the program stops.</li> </ol> </li> </ul> <hr style="height:10pt; visibility:hidden;" /> <p>To go back to the preliminaries click <a href="/fpnew/">here</a>.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> »LM Suite« is a program for for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> <li class="sitemap-link" > <a href="https://lordcephei.github.io/download/" title="Download the program">Downloads</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> <div id="subfooter"> <nav class="row"> <section id="subfooter-left" class="b30 small-12 medium-6 columns"> <ul class="inline-list"> <li>Created with &hearts; by <a style="display:inline;" href="http://phlow.de/">Phlow</a> with <a style="display:inline;" href="http://jekyllrb.com/" target="_blank">Jekyll</a> using <a style="display:inline;" href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a> </li> </ul> </section> <section id="subfooter-right" class="small-12 medium-6 columns social-icons"> <ul class="inline-list"> <li><a href="http://www.youtube.com/PhlowMedia" target="_blank" class="icon-youtube" title="Videos, Video-Anleitungen und Filme von Phlow auf YouTube"></a></li> <li><a href="http://twitter.com/phlow" target="_blank" class="icon-twitter" title="Immer das Neuste von Phlow gibt es auf Twitter"></a></li> <li><a href="http://www.facebook.com/phlow.media" target="_blank" class="icon-facebook" title="Lass uns Freunde sein!"></a></li> <li><a href="http://soundcloud.com/phlow" target="_blank" class="icon-soundcloud" title="Sounds und Downloads und mehr"></a></li> <li><a href="http://github.com/phlow" target="_blank" class="icon-github" title="Code und mehr..."></a></li> <li><a href="http://instagram.com/phlowmedia" target="_blank" class="icon-instagram" title="Bilder und Impressionen mit und ohne Filter..."></a></li> <li><a href="http://www.pinterest.com/phlowmedia/" target="_blank" class="icon-pinterest" title="Bilder, Fotos, Illustrationen, Grafiken sammeln..."></a></li> <li><a href="http://www.mixcloud.com/phlow/" target="_blank" class="icon-cloud" title="Mixe, was sonst?"></a></li> </ul> </section> </nav> </div><!-- /#subfooter --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> $("#masthead").backstretch("http://lordcephei.github.io/images/header_drop.jpg", {fade: 700}); $("#masthead-with-text").backstretch("http://lordcephei.github.io/images/header_drop.jpg", {fade: 700}); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
