<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Second tutorial on QSGW+DMFT</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Second tutorial on QSGW+DMFT" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/qsgw_dmft/dmft2/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <h1>Second tutorial on QSGW+DMFT</h1> </header> <hr style="height:5pt; visibility:hidden;" /> <h1 id="running-the-dmft-loop">Running the DMFT loop</h1> <hr style="height:5pt; visibility:hidden;" /> <h3 id="introduction">Introduction</h3> <p>As explained in the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0">introduction to QSGW+DMFT</a>, the fundamental step of DMFT is the self-consistent solution of the local Anderson impurity problem. This is connected to the electronic structure of the material (bath) through the hybridization function, the impurity level and the effective interactions <script type="math/tex">U</script> and <script type="math/tex">J</script>. The sequence of operations leading to the self-consistent impurity self-energy is called DMFT loop.</p> <p>The DMFT loop is composed by the following steps:</p> <ul> <li>The lattice Green’s function is projected onto the local correlated subsystem (<script type="math/tex">G_{\rm loc}(i\omega_n)</script>), where <script type="math/tex">\omega_n=(2n-1)\pi/\beta</script> are the fermionic Matsubara’s frequencies. This leads to the definition of the hybridization function (<script type="math/tex">\Delta(i\omega_n)</script>) and the impurity levels (<script type="math/tex">E_{\rm imp}</script>).</li> <li>These two quantities together with the effective interactions <script type="math/tex">U</script> and <script type="math/tex">J</script> are passed to the Continuous Time Quantum Monte Carlo (CTQMC) solver which computes the corresponding impurity self-energy and the impurity Green’s function (<script type="math/tex">G_{\rm imp}(i\omega_n)</script>).</li> <li>The double-counting self-energy is subtracted from it and the result is embedded into an updated lattice Green’s function. After adjusting the chemical potential, the loop starts again from the starting point until the self-consistent relation <script type="math/tex">G_{\rm imp}(i\omega_n)=G_{\rm loc}(i\omega_n)</script> is met.</li> </ul> <p>From a software perspective, these operations are accomplished in a four-step procedure. Each step relies on a specific program (<strong style="color: blue">lmfdmft</strong>, <strong style="color: blue">atom_d.py</strong>, <strong style="color: blue">ctqmc</strong> and <strong style="color: blue">broad_sig.x</strong>). The operations performed by each code and the input/output handling needed to cycle the loop are indicated schematically in the figure below.</p> <p><img src="https://lordcephei.github.io/assets/img/inout_dmftloop.svg" alt="Input/Output in DMFT loop" /></p> <p>In this tutorial, we will go through all these steps and we will indicate what quantity to monitor to judge the convergence of the DMFT loop. We will assume that you followed all the steps of the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1">previous tutorial</a>.</p> <h3 id="running-the-loop">Running the loop</h3> <p>The DMFT loop is composed by alternated runs of <strong style="color: blue">lmfdmft</strong> and <strong style="color: blue">ctqmc</strong>, the output of each run being the input for the successive. To do that, do the following steps:</p> <h5 id="prepare-and-launch-the-lmfdmft-run"><em><strong>(1) Prepare and launch the lmfdmft run</strong></em></h5> <p>First you have to copy the input files. If you are going to run the first iteration then</p> <p><code> mkdir it1_lmfrun cp lmfinput/*.ni it1_lmfrun # copy standard input files cp siginp0/sig.inp it1_lmfrun/sig.inp # copy vanishing sig.inp </code></p> <p>Otherwise you are going to run iteration number X&gt;1, then</p> <p><code> mkdir itX_lmfrun # X&gt;1 number of the iteration cp lmfinput/*.ni itX_lmfrun # copy standard input files cp it(X-1)_qmcrun/Sig.out.brd itX_lmfrun/sig.inp # copy sigma from last CTQMC run </code></p> <p>Let now <em>U</em>=10 eV and <em>J</em>=0.9 eV be the Hubbard on-site interaction and Hunds coupling respectively, and <em>n</em>=8 the nominal occupancy of the correlated subsystem (<em>n</em>=8 for Ni). Then launch <strong style="color: blue">lmfdmft</strong> with the command</p> <p><code> cd it1_lmfrun lmfdmft ni --ldadc=71.85 -job=1 -vbxc0=1 &gt; log cd .. </code></p> <p>where 71.85 is the double-counting self-energy, computed according to the formula <script type="math/tex">Edc=U(n-1/2)-J(n-1)/2</script>.</p> <p>At the end of the run, the hybridization function <script type="math/tex">\Delta(i\omega_n)</script> is stored in <em style="color: green">delta.ni</em> (first column are Matsubara’s energies and then five <em>d</em>-channels with real and imaginary parts).The impurity levels <script type="math/tex">E_{\rm imp}</script> are recorded in <em style="color: green">eimp1.ni</em>. These two output files are essential to initialise the corresponding CTQMC run.</p> <h5 id="prepare-and-launch-the-ctqmc-run"><em><strong>(2) Prepare and launch the ctqmc run</strong></em></h5> <p>At the Xth iteration you can launch the following commands</p> <p><code> mkdir itX_qmcrun # the running folder cp qmcinput/* itX_qmcrun/ # copy input files and relevant executables cp itX_lmfrun/delta.ni itX_qmcrun/Delta.inp # copy hybridization function output from lmfdmft cp itX_lmfrun/eimp1.ni itX_qmcrun/Eimp.inp # copy impurity levels from lmfdmft cp it(X-1)_qmcrun/status* itX_qmcrun/ # If X&gt;1. See the third tutorial for details </code></p> <p>Now there are some manual operations to do:</p> <ul> <li> <p>Look for ‘????’ in the provided <em style="color: green">PARAMS</em>. Assign the <strong>Ed</strong> variable the values reported in the forth line of <em style="color: green">Eimp.inp</em>. <strong style="color: red">Warning: be careful in erasing the ‘=’ sign before the brakets!</strong>. Then change <strong>mu</strong> accordingly as the first value of <strong>Ed</strong> with opposite sign. Finally add the correct values of <strong>U</strong>, <strong>J</strong>, <strong>beta</strong> and <strong>nf0</strong> (equivalent of n: nominal occupation of correlated orbitals). <strong style="color: red">Warning: Be careful in being consistent with the values in the ctrl.ni and the double counting used in the lmfdfmt run.</strong></p> <div onclick="elm = document.getElementById('ParamsDmft1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Example of PARAMS - Click to show.</button></div> <p><div style="display:none;margin:0px 25px 0px 25px;"id="ParamsDmft1"></p> <p>At this point the PARAMS file should look like this</p> <p><code> Ntau 1000 OffDiagonal real Sig Sig.out Naver 100000000 SampleGtau 1000 Gf Gf.out Delta Delta.inp cix actqmc.cix Nmax 700 # Maximum perturbation order allowed nom 150 # Number of Matsubara frequency points sampled exe ctqmc # Name of the executable tsample 50 # How often to record measurements nomD 150 # Number of Matsubara frequency points sampled Ed [ -71.710134, -71.710132, -71.796795, -71.710130, -71.796792, -71.732934, -71.732932, -71.820596, -71.732930, -71.820593 ] # Impurity levels M 20000000.0 # Total number of Monte Carlo steps per core Ncout 200000 # How often to print out info PChangeOrder 0.9 # Ratio between trial steps: add-remove-a-kink / move-a-kink CoulombF 'Ising' # Ising Coulomb interaction mu 71.710134 # QMC chemical potential warmup 500000 # Warmup number of QMC steps GlobalFlip 200000 # How often to try a global flip OCA_G False # No OCA diagrams being computed - for speed sderiv 0.02 # Maximum derivative mismatch accepted for tail concatenation aom 3 # Number of frequency points used to determin the value of sigma at nom HB2 False # Should we compute self-energy with the Bullas trick? U 10.0 J 0.9 nf0 8.0 beta 50.0 </code></p> <p></div></p> </li> <li> <p>Run <strong style="color: blue">atom_d.py</strong> using the command</p> <p><code> python atom_d.py J=0.9 l=2 cx=0.0 OCA_G=False qatom=0 "CoulombF='Ising'" HB2=False "Eimp=[ 0.000000, 0.000002, -0.086661, 0.000004, -0.086658, -0.022800, -0.022798, -0.110462, -0.022796, -0.110459]" </code></p> <p>where the argument <strong>Eimp</strong> is a copy of the third line of <em style="color: green">Eimp.inp</em> (to be changed at each iteration accordingly to the previous <strong style="color: blue">lmfdmft</strong> run) and the argument <strong>J</strong> is the Hund’s coupling. All other argument should not be changed. <strong style="color: red">Warning: Pay attention to quotes and double quotes!</strong></p> <p>Running <strong style="color: blue">atom_d.py</strong> generates a file called <em style="color: green">actqmc.cix</em> used by the ctqmc solver.</p> </li> <li> <p>Run <strong style="color: blue">ctqmc</strong> using a submission script on, let’s say, 20 cores. Important parameters (that may need to be adjusted during the loop) are <strong>nom</strong>, <strong>Nmax</strong> and <strong>M</strong>. Their explanation is reported as a comment in the <em style="color: green">PARAMS</em> file itself but further information is available in the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3">next tutorial</a>. For this tutorial, you can set them to <strong>nom 150</strong>, <strong>Nmax 700</strong> and <strong>M 20000000</strong> (as illustrated in one dropdown box above).</p> <p>At the end of the run (it will take a while… e.g. on 20 cores around 30 minutes) a series of files have been produced. Among them we are especially interested in <em style="color: green">Sig.out</em>, <em style="color: green">histogram.dat</em> and the <em style="color: green">status</em> files. To learn how to use them to judge on the quality of the QMC calculation we refer to the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3">third tutorial</a>.</p> </li> <li> <p>Now you must broad <em style="color: green">Sig.out</em> to smooth out the noise. If you use the program <strong style="color: blue">brad_sig.x</strong> you will run it with following commands</p> <p><code> cd itX_qmcrun cp ../qmcinput/broad_sig.x . echo 'Sig.out 150 l "55 20 150" k "1 2 3 2 3"'| ./broad_sig.x &gt; broad.log </code></p> <p>For a clearer explanation of how to use <strong style="color: blue">broad_sig.x</strong>, we refer to its commented header.</p> </li> </ul> <h5 id="cycling-the-loop"><em><strong>(3) Cycling the loop</strong></em></h5> <p>At this point you have a new self-energy to be fed to <strong style="color: blue">lmfdmft</strong>. You can go back to the point <em><strong>(1)</strong></em> and repeat all the operations with a higher iteration number X.</p> <p>As the required input/output handling is not being automatised yet, cycling the loop results pretty annoying. However, once you have familiarised with the procedure, you can write a script to do most of the work using <a href="https://lordcephei.github.io/assets/download/inputfiles/HandleIO_dmft.sh">this one</a> as a basic template.</p> <h3 id="converging-to-the-sc-solution">Converging to the SC-solution</h3> <p>The self-consistent condition holds when <script type="math/tex">G_{\rm loc}(i\omega_n)</script> of iteration <em>N</em> is equal (within a certain tolerance) to <script type="math/tex">G_{\rm imp}(i\omega_n)</script> of iteration <em>N-1</em>. You can add the flag <strong style="color: blue">--gprt</strong> when running <strong style="color: blue">lmfdmft</strong> to get <script type="math/tex">G_{\rm loc}(i\omega_n)</script> printed on a file called <em style="color: green">gloc.ni</em>. This can be compared with the file <em style="color: green">Gf.out</em> produced by the previous CTQMC run. However in the comparison remember that the latter is not broadened, while the former is obtained by smoothened quantities.</p> <p>An easier though accurate way is to look at the convergence of the chemical potential. This can be done by typing <strong style="color: blue">grep ‘ mu = ‘ it*_lmfrun/log</strong>.</p> <p>A third method is of course to visualise the convergence of each separate channel of local quantities like <em style="color: green">Sig.out.brd</em> or <em style="color: green">Gf.out</em>.</p> <p>In this tutorial, a reasonable convergence is achieved after around 10 iterations. How to handle the converged DMFT result is the subject of the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4">fourth</a> and the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5">fifth</a> tutorials, while in the <a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3">third one</a> we will focus on possible source of errors, technical aspects to speed up the convergence and rule of thumbs to define the input parameters.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
