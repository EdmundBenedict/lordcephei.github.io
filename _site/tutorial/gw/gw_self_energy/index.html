<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Making the dynamical GW self energy</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Making the dynamical GW self energy" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/gw/gw_self_energy/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>Making the dynamical GW self energy</h1> </header> <p class="teaser"> </p> <h3 id="purpose"><em>Purpose</em></h3> <hr /> <p>This tutorial explains how to make and analyze the dynamical self-energy Σ(<b>k</b>,ω) using the GW package.</p> <h3 id="table-of-contents"><em>Table of Contents</em></h3> <hr /> <ul class="no_toc" id="markdown-toc"> <li><a href="#purpose" id="markdown-toc-purpose"><em>Purpose</em></a></li> <li><a href="#table-of-contents" id="markdown-toc-table-of-contents"><em>Table of Contents</em></a></li> <li><a href="#preliminaries" id="markdown-toc-preliminaries"><em>Preliminaries</em></a></li> <li><a href="#command-summary" id="markdown-toc-command-summary"><em>Command summary</em></a></li> <li><a href="#introduction" id="markdown-toc-introduction"><em>Introduction</em></a></li> <li><a href="#theory" id="markdown-toc-theory"><em>Theory</em></a> <ul> <li><a href="#z-factor-renormalization" id="markdown-toc-z-factor-renormalization"><em>Z</em> factor renormalization</a></li> <li><a href="#coherent-part-of-the-spectral-function" id="markdown-toc-coherent-part-of-the-spectral-function">Coherent part of the spectral function</a></li> <li><a href="#simulation-of-photoemission" id="markdown-toc-simulation-of-photoemission">Simulation of Photoemission</a></li> </ul> </li> <li><a href="#make-the-gw-self-energy" id="markdown-toc-make-the-gw-self-energy"><em>Make the GW self-energy</em></a></li> <li><a href="#generate-spectral-functions-for-q0" id="markdown-toc-generate-spectral-functions-for-q0"><em>Generate spectral functions for q=0</em></a></li> <li><a href="#dynamical-self-energy-editor" id="markdown-toc-dynamical-self-energy-editor"><em>Dynamical self-energy editor</em></a> <ul> <li><a href="#editor-instructions" id="markdown-toc-editor-instructions">Editor instructions</a></li> </ul> </li> <li><a href="#compare-interacting-and-independent-particle-density-of-states-in-fe" id="markdown-toc-compare-interacting-and-independent-particle-density-of-states-in-fe"><em>Compare interacting and independent-particle density-of-states in Fe</em></a></li> <li><a href="#spectral-function-of-fe-near-the-h-point" id="markdown-toc-spectral-function-of-fe-near-the-h-point"><em>Spectral Function of Fe near the H point</em></a></li> <li><a href="#simulation-of-photoemission-midway-between-the-gamma-and-h-points" id="markdown-toc-simulation-of-photoemission-midway-between-the-gamma-and-h-points"><em>Simulation of photoemission midway between the Γ and H points</em></a></li> </ul> <h3 id="preliminaries"><em>Preliminaries</em></h3> <hr /> <p>This tutorial assumes you have completed a QSGW calculation for Fe, following <a href="/tutorial/gw/qsgw_fe/">this tutorial</a>, which requires that the GW script <strong style="color: blue">lmgwsc</strong> is in your path, along with the executables it requires. In addition it requires <strong style="color: blue">spectral</strong> and <strong style="color: blue">lmfgws</strong>.</p> <p>This tutorial assumes the GW executables are in <strong>~/bin/code2</strong>.</p> <h3 id="command-summary"><em>Command summary</em></h3> <hr /> <div onclick="elm = document.getElementById('foobar'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Commands - Click to show.</button></div> <p><div style="display:none;margin:0px 25px 0px 25px;"id="foobar"></p> <p>LDA self-consistency (starting from <em style="color: green">init.fe</em>)</p><pre><code>blm --nit=20 --nk=16 --gmax=7.9 --mag --nkgw=8 --gw fe
cp actrl.fe ctrl.fe
lmfa fe
cp basp0.fe basp.fe
lmf fe &gt; out.lmf
</code></pre><p>QSGW self-consistency (starting from the LDA)</p><pre><code>lmfgwd --jobgw=-1 ctrl.fe
lmgwsc --mpi=6,6 --wt --code2 --sym --metal --tol=1e-5 --getsigp fe &gt; out.lmgwsc
</code></pre><p>Making the spectral function (starting from QS<i>GW</i>)</p><pre><code>... to be finished
</code></pre><p></div></p> <h3 id="introduction"><em>Introduction</em></h3> <p>This tutorial starts after a QSGW calculation for Fe has been completed, in <a href="/tutorial/gw/qsgw_fe/">this tutorial</a>.</p> <p>The QSGW static self-energy was made with the following command:</p><pre><code>$ lmgwsc --wt --code2 --sym --metal --tol=1e-5 --getsigp fe
</code></pre><p><em style="color: red">Note:</em> until that tutorial is written, perform the setup as follows (where <strong>~/lm</strong> is your Questaal source directory)</p><pre><code>~/lm/gwd/test/test.gwd --mpi=#,# fe 4
</code></pre><p>This tutorial will do the following:</p> <ul> <li><a href="/tutorial/gw/gw_self_energy/#generate-spectral-functions-for-q0">Generate spectral function</a> at <strong>q</strong>=0 directly from the <em>GW</em> output files <em style="color: green">SEComg.UP</em> and <em style="color: green">SEComg.DN</em>. (For nonmagnetic calculations, only <em style="color: green">SEComg.UP</em> is made).</li> <li>Use <strong style="color: blue">lmfgws</strong> to generate <a href="/tutorial/gw/gw_self_energy/#compare-interacting-and-independent-particle-density-of-states-in-fe">the interacting density-of-states</a> (DOS) from Im <em>G</em>, compare it to the noninteracting DOS from Im <i>G</i><sub>0</sub> and to the noninteracting DOS generated as an output of an <strong>lmf</strong> band calculation.</li> <li>Use <strong style="color: blue">lmfgws</strong> to generate to calculate the <a href="/tutorial/gw/gw_self_energy/#spectral-function-of-fe-near-the-h-point">spectral function</a> <i>A</i>(<b>k</b>,ω) for <b>k</b> near the H point, and also simulate <a href="/tutorial/gw/gw_self_energy/#simulation-of-photoemission-midway-between-the-gamma-and-h-points">photoemission spectra</a></li> </ul> <h3 id="theory"><em>Theory</em></h3> <!-- /tutorial/gw/gw_self_energy/#theory --> <h4 id="z-factor-renormalization"><em>Z</em> factor renormalization</h4> <!-- /tutorial/gw/gw_self_energy/#z-factor-renormalization --> <p>Begin with a noninteracting Green’s function <i>G</i><sub>0</sub>, defined through an hermitian, energy-independent exchange-correlation potential <i>V<sup>j</sup><sub>xc</sub></i>(<em>k</em>).   <em>j</em> refers to a particular QP state (pole of <i>G</i><sub>0</sub>). There is also an interacting Green’s function, <em>G</em>.</p> <p>The contribution to <i>G</i><sub>0</sub> from QP state <em>j</em> is</p> <script type="math/tex; mode=display">G_0^j(k,\omega ) = \frac{1}{\omega - \omega^j(k)}</script> <p>where <script type="math/tex">\omega^j(k)</script> is the pole of <em>G</em><sub>0</sub>.</p> <p>Write the contribution to <em>G</em> from QP state <em>j</em> as</p> <script type="math/tex; mode=display">G^j(k,\omega) = \frac{1}{\omega - \omega^j - \Sigma (k,\omega ) + V^j_{xc}(k)}</script> <p>Note that this equation is only true if <script type="math/tex">\Sigma</script> is diagonal in the basis of noninteracting eigenstates. We will ignore the nondiagonal elements of <script type="math/tex">\Sigma(k,\omega)</script>. Note that if <i>V<sub>xc</sub><sup>j</sup></i> is constructed by QS<i>GW</i>, this is a very good approximation, since <script type="math/tex">{\mathrm{Re}\Sigma (k,\omega ){=}V^j_{xc}(k)}</script> at <script type="math/tex">\omega{=}\omega^j(k)</script>. Approximate <em>G</em> by its coherent part:</p> <script type="math/tex; mode=display">G^{j,\mathrm{coh}}(k,\omega) = \frac{1}{\omega - \omega^j - \mathrm{Re} \Sigma (k,\omega^j) + V^j_{xc}(k) - (\omega - \omega^j)(1 - 1/Z^j) - i\mathrm{Im} \Sigma (k,\omega )}</script> <p>where</p> <script type="math/tex; mode=display">1 - 1/{Z^j} = \left. {\partial \Sigma (k,\omega )/\partial \omega } \right|_{\omega ^j } .</script> <p>defines the <em>Z</em> factor. The dependence of <i>ω<sup>j</sup></i> and <i>Z<sup>j</sup></i> on <em>k</em> is suppressed.</p> <p>Define the QP peak as the value of <i>ω</i> where the real part of the denominator vanishes.</p> <script type="math/tex; mode=display">({\omega^*} - \omega^j)/Z^j = \mathrm{Re} \Sigma(k,\omega^j) - V^j_{xc}(k)</script> <p>and so</p> <script type="math/tex; mode=display">{\omega^*} = \omega^j + Z^j\left( {\mathrm{Re} \Sigma (k,\omega^j) - V^j_{xc}(k)} \right)</script> <p>Note that in the QS<i>GW</i> case, the second term on the r.h.s. vanishes by construction: the noninteracting QP peak corresponds to the (broadened) pole of <em>G</em>.</p> <p>The group velocity is <i>dω</i>/<i>dk</i>. For the interacting case it reads</p> <script type="math/tex; mode=display">\frac{d\omega^*}{dk} = \frac{d\omega ^j }{dk} + \frac{d}{dk}Z^j \left( {\text{Re}\Sigma(k,\omega^j) - V_{xc}^j (k)} \right)</script> <p>Use the ratio of noninteracting and interacting group velocities as a definition of the ratio of inverse masses. From the chain rule</p> <script type="math/tex; mode=display">\frac{m_0}{m^*} \equiv \frac{d\omega^*}{dk}/\frac{d\omega^j}{dk} = 1 + Z^j \left( \frac{\partial}{\partial\omega} \left. \text{Re}\Sigma (k,\omega ^j ) \right|_{\omega^j} \frac{d\omega ^j }{dk} + \frac{\partial}{\partial k}\left. \text{Re}\Sigma(k,\omega^j) \right|_{\omega ^j } - \frac{\partial }{\partial k}V_{xc}^j (k) \right) + \left(\frac{dZ^j}{dk}\right) \left(\text{Re}\Sigma(k,\omega^j) - V_{xc}^j (k) \right)</script> <p>Ignore the dependence of <em>Z</em><sup>j</sup> on <em>k</em>. Write <i>dω<sup>j</sup></i>/<i>dk</i> as $v_0^j$, and use the definition of <em>Z</em> to get</p> <script type="math/tex; mode=display">\frac{m_0}{m^*} = 1 + \frac{1}{v_0^j}Z^j \left( {\left( {1 - 1/{Z^j}} \right) v_0^j + \frac{\partial}{\partial k} \left.\text{Re}\Sigma(k,\omega^j) \right|_{\omega^j} - \frac{\partial }{\partial k}V_{xc}^j(k)} \right)</script> <p>So \frac{m_0}{m^*} = Z^j + \frac{Z^j}{v_0^j }\left( {\frac{\partial}{\partial k}\left. \text{Re}\Sigma (k,\omega^j) \right|<em>{\omega ^j } - \frac{\partial }{\partial k}V</em>{xc}^j (k)} \right)</p> <p>In the QS<i>GW</i> case the quantity in parenthesis vanishes.</p> <h4 id="coherent-part-of-the-spectral-function">Coherent part of the spectral function</h4> <!-- /tutorial/gw/gw_self_energy/#coherent-part-of-the-spectral-function --> <p>Write <script type="math/tex">G^{j,\mathrm{coh}}(k,\omega)</script> as</p> <script type="math/tex; mode=display">G^{j,\mathrm{coh}}(k,\omega) = \left[(\omega - \omega^j){Z^j}^{-1} - \mathrm{Re} \Sigma (k,\omega^j) + {V_{xc}}(k) - i\mathrm{Im} \Sigma (k,\omega )\right]^{-1}</script> <p>Rewrite as</p> <script type="math/tex; mode=display">G^{j,\mathrm{coh}}(k,\omega) = \frac{Z^j}{\omega - \omega^* - iZ\mathrm{Im} \Sigma (k,\omega )} = Z^j\frac{\omega - \omega^* + iZ\mathrm{Im} \Sigma (k,\omega )}{(\omega - {\omega^*})^2 + (Z^j\mathrm{Im} \Sigma (k,\omega ))^2}</script> <p>Using the standard definition of the spectral function, e.g. Hedin 10.9:</p> <script type="math/tex; mode=display">A(\omega ) = {\pi ^{ - 1}}\left| {\operatorname{Im} G(\omega )} \right|</script> <p>the approximate spectral function is</p> <p>which shows that the spectral weight of the coherent part is reduced by <em>Z</em>.</p> <script type="math/tex; mode=display">A_k^{j,\mathrm{coh}}(\omega ) = \frac{Z^j}{\pi}\frac{Z^j\mathrm{Im} \Sigma (k,\omega )}{(\omega - {\omega^*})^2 + (Z^j\mathrm{Im} \Sigma (k,\omega ))^2}</script> <h4 id="simulation-of-photoemission">Simulation of Photoemission</h4> <!-- /tutorial/gw/gw_self_energy/#simulation-of-photoemission --> <p>(needs cleaning up)</p> <p><em>Energy conservation</em> : requires (see Marder, p735, Eq. 23.58)</p> <script type="math/tex; mode=display">\hbar\omega=E_{kin}+{\varphi_s}-E_b</script> <p>where <i>E<sub>b</sub></i> is the binding energy and <script type="math/tex">E_{kin}+{\varphi_s}</script> is the energy of the electron after being ejected. (Marder defines <script type="math/tex">E_{b}</script> with the opposite sign, making it positive).</p> <p><i>Momentum conservation</i> : The final wave vector <b>k</b><sub><i>f</i></sub> of the ejected electron must be equal to its initial wave vector, apart from shortening by a reciprocal lattice vector to keep <b>k</b><sub><i>f</i></sub> in the first Brillouin zone.</p> <p>Let <script type="math/tex">E_{kin}</script> be the energy on exiting the crystal, <script type="math/tex">\varphi_s</script> the work function and <script type="math/tex">E_b</script> and <script type="math/tex">V_0</script> are called the electron binding energy and “inner potential.”</p> <p>Then</p> <p>\begin{eqnarray} \frac{\hbar^2}{2m}(k_\parallel^2 + k_\bot^2) = E_{kin} + {V_0}, \text{ where } E_{kin} = \hbar \omega - \varphi _s + E_b \quad\quad\quad\quad (1) \label{eq:keconst} \end{eqnarray}</p> <p>The total momentum inside the crystal, <script type="math/tex">\mathbf{k}_\parallel{+}\mathbf{k}_\bot</script>, is linked to the kinetic energy measured outside the crystal through Eq.(1). The kinetic energy is linked to the binding energy through the equation <script type="math/tex">{E_{kin}}=\hbar\omega-{E_b}-{\varphi_a}</script> where <script type="math/tex">{\varphi_a}</script> is the work function of the analyzer. Usually <script type="math/tex">{\varphi_a}{=}{\varphi_s}</script>. The Fermi level is defined such that <script type="math/tex">E_b{=}0</script>. The inner potential is defined by scanning the range of photon energy under the constraint of normal emission: then the <script type="math/tex">\Gamma</script>-point can be identified and by using Eq.(1), and the inner potential experimentally determined.</p> <p>The momentum of the particle in free space is</p> <script type="math/tex; mode=display">\frac{\hbar ^2 k_0^2 }{2m} = E_{kin}</script> <p>Resolve <script type="math/tex">\mathbf{k}_f</script> into components parallel and perpendicular to the surface</p> <script type="math/tex; mode=display">\mathbf{k}_f = \mathbf{k}_\parallel + \mathbf{k}_\bot</script> <p>After passing through the surface, <script type="math/tex">\mathbf{k}_f</script> is modified to <script type="math/tex">\overline{\mathbf{k}}_f</script>; this is what is actually measured.</p> <p>The conservation condition requires</p> <script type="math/tex; mode=display">k_0^2 = \bar k_\parallel^2 + \bar k_\bot^2</script> <p><script type="math/tex">\mathbf{k}_\parallel</script> is conserved on passing through the surface; thus <script type="math/tex">\bar k_\parallel{=} k_\parallel</script>. <script type="math/tex">\mathbf{k}_\bot</script> is not conserved; therefore</p> <script type="math/tex; mode=display">\bar k_\bot = \sqrt{k_0^2{-}k_\parallel^2}</script> <p>The wave number shift is then</p> <script type="math/tex; mode=display">\Delta{\mathbf{k}} = (\overline{k}_\bot-{k}_\bot)\hat{\mathbf{k}}_\bot</script> <p>and the crystal momentum actually being probed by the experiment is</p> <script type="math/tex; mode=display">{\mathbf{k}}_f = \overline{\mathbf{k}}_f - \Delta{\mathbf{k}}</script> <h3 id="make-the-gw-self-energy"><em>Make the GW self-energy</em></h3> <!-- /tutorial/gw/gw_self_energy/#make-the-gw_self_energy --> <ul> <li>If you have removed intermediate files, you must remake them up to the point where the self-energy is made. Do:</li> </ul><pre><code>$ lmgwsc --wt --code2 --sym --metal --tol=1e-5 --getsigp --stop=sig fe
</code></pre><p>This step is not necessary if you have completed the <a href="/tutorial/gw/qsgw_fe/">QSGW Fe tutorial</a> without removing any files.</p> <ul> <li>With your text editor, modify <em style="color: green">GWinput</em>. Change these two lines:</li> </ul><pre><code> --- Specify qp and band indices at which to evaluate Sigma

</code></pre><p>into these four lines:</p><pre><code>***** ---Specify the q and band indices for which we evaluate the omega dependence of self-energy ---
   0.01 2   (Ry) ! dwplot omegamaxin(optional)  : dwplot is mesh for plotting.
                   : this omegamaxin is range of plotting -omegamaxin to omegamaxin.
                   : If omegamaxin is too large or not exist, the omegarange of W by hx0fp0 is used.
</code></pre><p>The next step will make Σ(<b>k</b><i><sub>n</sub></i>,<i>ω</i>) on a uniform energy mesh −2 Ry &lt; <i>ω</i> &lt; 2 Ry, spaced by 0.01 Ry at irreducible points <b>k</b><i><sub>n</sub></i>, for QP levels specified in <em style="color: green">GWinput</em>. This is a fairly fine spacing so the calculation is somewhat expensive.</p> <ul> <li>Run <strong style="color: blue">hsfp0</strong> (or better <strong style="color: blue">hsfp0_om</strong>) in a special mode <strong>--job=4</strong> to make the dynamical self-energy.</li> </ul><pre><code>export OMP_NUM_THREADS=8
export MPI_NUM_THREADS=8
~/bin/code2/hsfp0_om --job=4 &gt; out.hsfp0
</code></pre><p>This step should create <em style="color: green">SEComg.UP</em> and <em style="color: green">SEComg.DN</em>. These files contain Σ(<b>k</b>,<i>ω</i>), albeit in a not particularly readable format.</p> <h3 id="generate-spectral-functions-for-q0"><em>Generate spectral functions for q=0</em></h3> <!-- /tutorial/gw/gw_self_energy/#generate-spectral-functions-for-q0 --> <p><em style="color: green">SEComg.UP</em> and <em style="color: green">SEComg.DN</em> contain the diagonal matrix element Σ<sub><i>jj</i></sub>(<b>k</b>,<i>ω</i>) for each QP level <i>j</i>, for each irreducible point <b>k</b><i><sub>n</sub></i> in the Brillouin zone, on a uniform mesh of points <i>ω</i> as specified in the <em style="color: green">GWinput</em> file of the last section. If the absence of interactions, Σ<sub><i>ii</i></sub>(<b>k</b>,<i>ω</i>)=0 so the spectral function would be proportional to δ(<i>ω</i>−<i>ω</i><sup>*</sup>), where <i>ω</i>* is the QP level (see <a href="/tutorial/gw/gw_self_energy/#theory">Theory section</a>).</p> <p>Interactions give Σ<sub><i>ii</i></sub>(<b>k</b>,<i>ω</i>) an imaginary part which broadens out the level, and in general, ReΣ<sub><i>ii</i></sub>(<b>k</b>,<i>ω</i>) shifts and renormalizes the quasiparticle weight by <em>Z</em>. As noted in the <a href="/tutorial/gw/gw_self_energy/#theory">Theory section</a>, there is no shift if <i>V<sub>xc</sub><sup>j</sup></i> is the QS<i>GW</i> self-energy; there remains, however, a reduction in the quasiparticle weight. This will be apparent when <a href="/tutorial/gw/gw_self_energy/#interacting-density-of-states">comparing the interacting and noninteracting DOS</a>.</p> <p>The <strong style="color: blue">spectral</strong> tool has a limited ability to convert raw files <em style="color: green">SEComg.{UP,DN}</em> into spectral functions, which this section demonstrates.</p> <p>Do the following:</p><pre><code>$ spectral --eps=.005 --domg=0.003 --cnst:iq==1&amp;eqp&gt;-10&amp;eqp&lt;30
</code></pre><p>Command-line arguments have the following meaning:</p> <ul> <li> <p><strong>–eps=.005</strong> :   0.005 eV is added to the imaginary part of the self-energy. This is needed because as <i>ω</i>→0,  ImΣ→0. Peaks in <i>A</i>(<b>k</b>,<i>ω</i>) become infinitely sharp for QP levels near the Fermi level.</p> </li> <li> <p><strong>–domg=.003</strong> :   interpolates Σ(<b>k</b><i><sub>n</sub></i>,<i>ω</i>) to a finer frequency mesh. <i>ω</i> is spaced by 0.003 eV. The finer mesh is necessary because Σ varies smoothly with <i>ω</i>, while <i>A</i> will be sharply peaked around QP levels.</p> </li> <li> <p><strong>–cnst:<i>expr</i></strong> :   acts as a constraint to exclude entries in <em style="color: green">SEComg.{UP,DN}</em> for which <strong><em>expr</em></strong> is zero.<br /> <strong><i>expr</i></strong> is an integer expression using standard Questaal <a href="/docs/input/preprocessor/#syntax-of-algebraic-expressions">syntax for algebraic expressions</a>. It can that can include the following variables:</p> <ul> <li>ib (band index)</li> <li>iq (k-point index)</li> <li>qx,qy,qz,q (components of q, and amplitude)</li> <li>eqp (quasiparticle energy, in eV)</li> <li>spin (1 or 2)</li> </ul> <p>The expression in this example, <strong>iq==1&amp;eqp&gt;-10&amp;eqp&lt;30</strong>, does the following: <br />    generates spectral functions only for the first <em>k</em> point (the first k point is the Γ point)<br />    eliminates states below the bottom of the Fe <em>s</em> band (i.e. shallow core levels included in the valence through local orbital)<br />    eliminates states 30 eV or more above the Fermi level.</p> </li> </ul> <p><strong style="color: blue">spectral</strong> writes files <em style="color: green">sec_ib</em>j<i style="color: green">_iq</i>n<i style="color: green">.up</i> and <em style="color: green">sec_ib</em>j<i style="color: green">_iq</i>n<i style="color: green">.dn</i> which contain information about the <em>G</em> for band <em>j</em> and the <em>k</em> point <b>k</b><i><sub>n</sub></i>. A <em style="color: green">sec</em> files takes the following format:</p><pre><code># ib=   5  iq=   1  Eqp=   -0.797925  q=   0.000000   0.000000   0.000000
#     omega         omega-Eqp     Re sigm-vxc    Im sigm-vxc      int A(w)      int A0(w)       A(w)           A0(w)
  -0.2721160D+02 -0.2641368D+02 -0.6629516D+01  0.1519810D+02  0.2350291D-04  0.6897219D-08  0.7774444D-02  0.2281456D-05
  -0.2720858D+02 -0.2641065D+02 -0.6629812D+01  0.1520157D+02  0.4701215D-04  0.1379602D-07  0.7776496D-02  0.2281979D-05
  ...
</code></pre><p><strong style="color: blue">spectral</strong> also makes the <em>k</em>-integrated DOS. However, the <em>k</em> mesh is rather coarse and a <a href="/tutorial/gw/gw_self_energy/#interacting-density-of-states">better DOS</a> can be made using <strong style="color: blue">lmfgws</strong>.</p> <hr /> <div onclick="elm = document.getElementById('spectral'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Click to see spectral's standard output</button></div> <p><div style="display:none;margin:0px 0px 0px 0px;"id="spectral"></p><pre><code> spectral: read 29 qp from QIBZ
 Dimensions from file(s) SEComg.(UP,DN):
 nq=1  nband=9  nsp=2  omega interval (-27.2116,27.2116) eV with (-200,200) points
 Energy mesh spacing = 136.1 meV ... interpolate to target spacing 3 meV.  Broadening = 5 meV
 Spectral functions starting from band 1, spin 1, for 9 QPs

          file            Eqp      int A(G)   int A(G0) rat[G] rat[G0]
      sec_ib1_iq1.up   -8.760788     0.8610     0.9998     T     T
      sec_ib2_iq1.up   -1.666774     0.8394     0.9999     T     T
      sec_ib3_iq1.up   -1.666703     0.8394     0.9999     T     T
      sec_ib4_iq1.up   -1.666635     0.8394     0.9999     T     T
      sec_ib5_iq1.up   -0.797925     0.8451     0.9999     T     T
      sec_ib6_iq1.up   -0.797795     0.8451     0.9999     T     T
      sec_ib7_iq1.up   25.315312     0.7142     0.9992     T     T
      sec_ib8_iq1.up   25.315316     0.7142     0.9992     T     T
      sec_ib9_iq1.up   25.315318     0.7142     0.9992     T     T

 writing q-integrated dos to file dos.up ...
 Spectral functions starting from band 1, spin 2, for 9 QPs

          file            Eqp      int A(G)   int A(G0) rat[G] rat[G0]
      sec_ib1_iq1.dn   -8.488402     0.8576     0.9998     T     T
      sec_ib2_iq1.dn   -0.006985     0.8805     0.9999     T     T
      sec_ib3_iq1.dn   -0.006625     0.8823     0.9999     T     T
      sec_ib4_iq1.dn   -0.006271     0.8836     0.9999     T     T
      sec_ib5_iq1.dn    1.530201     0.8499     0.9999     T     T
      sec_ib6_iq1.dn    1.530937     0.8499     0.9998     T     T
      sec_ib7_iq1.dn   25.497064     0.7042     0.9991     T     T
      sec_ib8_iq1.dn   25.497074     0.7042     0.9991     T     T
      sec_ib9_iq1.dn   25.497083     0.7042     0.9991     T     T

 writing q-integrated dos to file dos.dn ...
</code></pre><p></div></p> <h3 id="dynamical-self-energy-editor"><em>Dynamical self-energy editor</em></h3> <!-- /tutorial/gw/gw_self_energy/#dynamical-self-energy-editor --> <p><strong style="color: blue">lmfgws</strong> contains the dynamical self-energy editor, which peforms a variety of manipulations of the <em>GW</em> self-energy Σ(<b>k</b><i><sub>n</sub></i>,<i>ω</i>) for different purposes. It requires the same files <strong style="color: blue">lmf</strong> needs to compute the QS<i>GW</i> band structure, e.g. <em style="color: green">ctrl.ext</em> and <em style="color: green">sigm.ext</em>.</p> <p>In addition it requires the dynamical self-energy se.ext_{: style=”color: green”} in special a format written by the <strong style="color: blue">spectral</strong> tool.</p> <p>For definiteness this section assumes that <em>ext</em> is <em>fe</em>. Starting from <em style="color: green">SEComg.UP</em> (and <em style="color: green">SEComg.DN</em> in the magnetic case) <a href="/tutorial/gw/gw_self_energy/#make-the-gw_self_energy">generated by the <em>GW</em> code</a>, use <strong style="color: blue">spectral</strong> to generate <em style="color: green">se.fe</em>:</p><pre><code>$ spectral --ws --nw=1
$ mv se se.fe
</code></pre><ul> <li><strong>–ws</strong> tells <strong style="color: blue">spectral</strong> to write the self-energy to file <em style="color: green">se</em> for all <em>k</em> points, in a special format designed for <strong style="color: blue">lmfgws</strong>. Individual files are not writen.</li> <li><strong>–nw=1</strong> tells <strong style="color: blue">spectral</strong> to write the self-energy on the frequency mesh it was generated; no interpolation takes place.</li> </ul> <p>Try starting the dynamical self-energy editor:</p><pre><code>$ lmfgws ctrl.fe `cat switches-for-lm` --sfuned
</code></pre><p>You should see:</p><pre><code> Welcome to the spectral function file editor.  Enter '?' to see options.

 Option :
</code></pre><p>The editor operates interactively. It reads a command from standard input, executes the command, and returns to the  <b>Options</b> prompt waiting for another instruction. The editor will print a short summary of instructions if you type  <b>? &lt;RET&gt;</b>.</p> <h4 id="editor-instructions">Editor instructions</h4> <!-- /tutorial/gw/gw_self_energy/#editor-instructions --> <p>The following summarizes the instruction set of the dynamical self-energy editor.</p> <ul> <li><strong>readsek [<i>fn</i>]</strong><br /> reads the self-energy from an ASCII file. In the absence <strong><i>fn</i></strong>, the file name defaults to <em style="color: green">se.ext</em>.</li> <li> <p><strong>readsekb [<i>fn</i>]</strong><br /> reads the self-energy from a binary file. In the absence <strong><i>fn</i></strong>, the file name defaults to <em style="color: green">seb.ext</em>.</p> </li> <li>units Ry<br /> select Rydberg units for which data is to be output</li> <li> <p>units eV<br /> select electron vole units for which data is to be output</p> </li> <li> <p><strong>evsync</strong><br /> replace quasiparticle levels read from <em style="color: green">se.ext</em> by recalculating them with the same algorithm <strong style="color: blue">lmf</strong> uses.</p> </li> <li> <p><strong>eps <i>val</i></strong><br /> add a constant <strong><i>val</i></strong> to Im Σ, needed to broaden spectral functions so that integrations are tractable.</p> </li> <li> <p><strong>ef <em>ef</em></strong><br /> Use <strong><em>ef</em></strong> for the Fermi level, overriding the internally calculated value.</p> </li> <li><strong>dos [nq=#1,#2,#3]   [nw=#|domg=#]   [range=#1,#2]   [isp=#]</strong><br /> Integrate spectral function to make both the QP and spectrum DOS. Options are: <ul> <li><strong>nq=#1,#2,#3</strong>     Interpolate Σ<i><sub>j</sub></i>(<b>k</b><i><sub>n</sub></i>,<i>ω</i>) to a new uniform mesh of <strong>k</strong> points, defined by (<strong>#1,#2,#3</strong>) divisions.</li> <li><strong>nw=<em>n</em></strong>                    Refine the given energy mesh by interpolating Σ to an <em>n</em> multiple of the given energy mesh. <em>n</em> must be an integer.</li> <li><strong>range=#1,#2</strong>     Generate DOS in a specified energy window (<strong>#1,#2</strong>), in eV.</li> <li><strong>isp=<em>i</em></strong>                      Generate DOS for spin <strong><em>i</em></strong> (1 or 2). Default value is 1.</li> </ul> </li> <li><strong>se iq=<em>n</em>|q=#1,#2,#3   ib=<em>list</em>   [getev[=#1,#2,#3]]   [nw=<em>n</em>|domg=#]   [isp=#]   [range=#1,#2]</strong><br /> Make Σ(<i>ω</i>) and <i>A</i>(<i>ω</i>) for given <strong>q</strong> and range of bands.<br />      Required arguments are: <ul> <li><strong>iq=<em>n</em></strong>                            index to <b>q</b><i><sub>n</sub></i>, from list in <em style="color: green">QIBZ</em>. Alternatively specify <strong>q</strong> by:</li> <li><strong>q=#1,#2,#3</strong>           <strong>q</strong>-point in units of 2<i>π</i>/alat. <strong style="color: blue">lmfgws</strong> will interpolate Σ(<b>q</b><i><sub>n</sub></i>) to any <strong>q</strong>.</li> <li><strong>ib=<em>list</em></strong>                      Sum together <i>A<sup>j</sup></i>(<i>ω</i>) derived from QP states <i>j</i> in <strong><em>list</em></strong>. See <a href="/docs/misc/integerlists/">here</a> for the syntax of integer lists.<br /> Options are:</li> <li><strong>getev</strong>                         Do not interpolate energy but calculate it at <strong>q</strong>.</li> <li><strong>getev=#1,#2,#3</strong> Generate evals on independent mesh with <strong>#1,#2,#3</strong> divisions of uniformly spaced points.</li> <li><strong>nw=<em>n</em></strong>                         Refine the given energy mesh by interpolating Σ to an <em>n</em> multiple of the given energy mesh. <em>n</em> must be an integer.</li> <li><strong>range=#1,#2</strong>         Generate spectral function in a specified energy window (<strong>#1,#2</strong>)</li> </ul> </li> <li><strong>pe|peqp iq=<em>n</em>|q=#1,#2,#3   ib=#   [getev[=#1,#2,#3]]   [nw=#|domg=#]   [nqf=#]   [ke0=#]   [isp=<em>i</em>]   [range=#1,#2]</strong><br /> Model ARPES for given q and band(s).<br />      Required arguments are: <ul> <li><strong>iq=<em>n</em></strong>                            index to <b>q</b><i><sub>n</sub></i>, from list in <em style="color: green">QIBZ</em>. Alternatively specify <strong>q</strong> by:</li> <li><strong>q=#1,#2,#3</strong>           <strong>q</strong>-point in units of 2<i>π</i>/alat. <strong style="color: blue">lmfgws</strong> will interpolate Σ(<b>q</b><i><sub>n</sub></i>) to any <strong>q</strong>.</li> <li><strong>ib=<em>list</em></strong>                       Sum together PE spectrum derived from QP states <i>j</i> in <strong><em>list</em></strong>. See <a href="/docs/misc/integerlists/">here</a> for the syntax of integer lists.<br /> Options are:</li> <li><strong>getev</strong>                        Do not interpolate energy but calculate it at <strong>q</strong>.</li> <li><strong>getev=#1,#2,#3</strong> Generate evals on independent mesh with <strong>#1,#2,#3</strong> divisions of uniformly spaced points.</li> <li><strong>nw=<em>n</em></strong>                         Refine the given energy mesh by interpolating Σ to an <em>n</em> multiple of the given energy mesh. <em>n</em> must be an integer.</li> <li><strong>isp=<em>i</em></strong>                          Generate spectra for spin <strong><em>i</em></strong> (1 or 2). Default value is 1.</li> <li><strong>nqf=<em>n</em></strong>                       number of mesh points for final state integration. Default is 200.</li> <li><strong>ke0=#</strong>                       kinetic energy of emitted electron. KE+V0=ℏ<i>ω−φ<sub>s</sub>+V<sub>0</sub></i></li> <li><strong>range=#1,#2</strong>      Generate spectral function in a specified energy window (<strong>#1,#2</strong>)</li> </ul> </li> <li> <p><strong>savesea [fn]</strong><br /> saves spectrum DOS or self-energy + spectral function, in ASCII format. In the absence <strong><i>fn</i></strong>, the file name defaults to <em style="color: green">seia.ext</em> or <em style="color: green">seia2.ext</em> when writing band and <em>k</em>-resolved spectral functions (<strong>se</strong> or <strong>pe</strong>) and to <em style="color: green">sdos.ext</em> or <em style="color: green">sdos2.ext</em> when writing spectrum dos (<strong>dos</strong>).</p> </li> <li> <p><strong>savese [fn]</strong><br /> saves q-interpolated self-energy + spectral function in binary format. In the absence <strong><i>fn</i></strong>, the file name defaults to <em style="color: green">seib.ext</em>.</p> </li> <li><strong>q</strong><br /> quits the editor unless information has generated that has not been saved. Program terminates.</li> <li><strong>a</strong><br /> (abort) unconditionally quits the editor. Program terminates.</li> </ul> <p>You can also run the editor in a batch mode by stringing instructions together:</p><pre><code>$ lmfgws ctrl.fe `cat switches-for-lm` '--sfuned~first command~second command~...'
</code></pre><p><strong>\~</strong>  is the delimiter separating instructions (you can use another character). <strong style="color: blue">lmfgws</strong> will parse through all the commands given, and return to the  <strong>Option</strong>  prompt, unless the editor encounters “quit” instruction <code>a</code> or <code>q</code>. See the next section for an example.</p> <h3 id="compare-interacting-and-independent-particle-density-of-states-in-fe"><em>Compare interacting and independent-particle density-of-states in Fe</em></h3> <!-- /tutorial/gw/gw_self_energy/#compare-interacting-and-independent-particle-density-of-states-in-fe --> <p>This section uses the self-energy editor, <strong style="color: blue">lmfgws</strong>, to interpolate Σ(<b>k</b><i><sub>n</sub></i>,<i>ω</i>) to a fine <b>k</b>- and <i>ω</i>- mesh to obtain a reasonably well converged density-of-states.</p><pre><code>$ lmfgws fe `cat switches-for-lm` '--sfuned~units eV~readsek~eps .030~dos isp=1 range=-10,10 nq=32 nw=30~savesea~q'
</code></pre><p>This invocation runs <strong style="color: blue">lmfgws</strong> in batch mode, and writes the spectral and noninteracting DOS to file <em style="color: green">sdos.fe</em>. The editor’s instructions do the following (as explained <a href="/tutorial/gw/gw_self_energy/#editor-instructions">here</a>):</p> <ul> <li>units eV<br /> Set units to eV; spectrum DOS will be written in eV.</li> <li>readsek<br /> Read <em style="color: green">se.fe</em></li> <li>eps .030<br /> Add 30 meV smearing to Im Σ</li> <li>dos isp=1 range=-10,10 nq=32 nw=30<br /> Make the DOS for spin 1, in the energy range (-10,10) eV, interpolating Σ to a <strong>k</strong> mesh 32×32×32 divisions, and refining the energy mesh by a factor of 30. The as-given <strong>k</strong> mesh is 8×8×8 divisions.</li> <li>savesea<br /> Write the DOS.</li> <li>q<br /> Exit the editor.</li> </ul> <p><em style="color: red">Notes:</em></p> <ul> <li>The mesh is very fine, so the interpolation takes a little while (2 to 3 minutes). The frequency and <strong>k</strong> meshes are both pretty fine and the DOS is rather well converged, as the figure below demonstrates.</li> <li>The spectrum DOS is written to file <em style="color: green">sdos.fe</em>. Columns 1,2,3 are <i>ω</i>, <i>A</i>(<i>ω</i>), and <i>A</i><sub>0</sub>(<i>ω</i>), respectively.</li> <li><i>A</i><sub>0</sub>(<i>ω</i>) should compare directly to the DOS calculated as a byproduct of <strong style="color: blue">lmf</strong>.</li> </ul> <p><em style="color: red">Note:</em> for now, copy the <strong style="color: blue">lmf</strong>-generated DOS to your working directory.</p><pre><code>cp ~/lm/gwd/test/fe/dosp.fe dosp.fe
</code></pre><p>The following draws a figure comparing the DOS generated three different ways. It uses the <a href="/docs/misc/fplot/"><strong style="color: blue">fplot</strong> tool</a>. Cut and paste the contents of the box below into script file <em style="color: green">plot.dos</em>.</p><pre><code>%char0 ltdos="1,bold=3,col=0,0,0"
% var ymax=1.4 dy=0.4 dw=.00 ymax+=dy emin=-10 emax=5 ef=0
fplot

% var ymax-=dy+dw dy=0.4 dmin=0 dmax=3
 -frme 0,1,{ymax-dy},{ymax} -p0 -x {emin},{emax} -y {dmin},{dmax} -tmy 1 -1p
 -colsy 3 -lt 1,bold=3,col=.5,.5,.5 -qr sdos.fe
 -colsy 2 -lt {ltdos} -ord y -qr dosp.fe
 -colsy 2 -lt 1,bold=3,col=1,0,0 -qr sdos.fe
 -lt 2,bold=3,col=0,0,0,2,.5,.05,.5 -tp 2~{ef},{dmin},{ef},{dmax}
</code></pre><div onclick="elm = document.getElementById('figd'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> Run the commands in the box below to create and view the postscript file, or click here to see the figure.</div> <p><div style="display:none;padding:0px;" id="figd"> <img src="https://lordcephei.github.io/assets/img/fedos.svg" alt="k-integrated spectral function in Fe" /> </div></p><pre><code>$ fplot -f plot.dos
$ open fplot.ps   [choose your postscript file viewer]
</code></pre><p><em style="color: red">Notes on the figure:</em></p> <ul> <li>The <a href="/docs/misc/fplot/#color-specification">black line</a> (<strong>col=0,0,0</strong>) is the noninteracting DOS generated by <strong style="color: blue">lmf</strong>.</li> <li>The <a href="/docs/misc/fplot/#color-specification">grey line</a> (<strong>col=.5,.5,.5</strong>) is the <em>noninteracting</em> DOS <i>A</i><sub>0</sub>(<i>ω</i>), generated by <strong style="color: blue">lmfgws</strong></li> <li>The <a href="/docs/misc/fplot/#color-specification">red line</a> (<strong>col=1,0,0</strong>) is the <em>interacting</em> DOS <i>A</i>(<i>ω</i>), generated by <strong style="color: blue">lmfgws</strong></li> <li>Grey and black lines nearly coincide, as they should if the DOS is well converged. Note that the black line was generated from energy bands with the tetrahedron method, the other effectively by integrating <i>G</i><sub>0</sub>(<b>k</b>,<i>ω</i>) by sampling with a smearing of 30 meV.</li> <li>The noninteracting DOS at the Fermi level is <i>D</i>(<i>E<sub>F</sub></i>)≅1/eV (one spin). The Stoner criterion for the onset of ferromagnetism is <i>I</i>×<i>D</i>(<i>E<sub>F</sub></i>)&gt;1, where <i>I</i> is the Stoner parameter, which DFT predicts to be approximately 1 eV for 3_d_ transition metals. Combining DOS for the two spins would indicate that the Stoner criterion is well satisfied.</li> <li>The interacting DOS is smoothed out, and is roughly half the amplitude of the noninteracting DOS. This is also expected: the <em>Z</em> factor for the <em>d</em> states is about 0.5.</li> </ul> <h3 id="spectral-function-of-fe-near-the-h-point"><em>Spectral Function of Fe near the H point</em></h3> <!-- /tutorial/gw/gw_self_energy/#spectral-function-of-fe-near-the-h-point --> <p>This example computes the self-energy for a <strong>q</strong> point near the H point. It is calculated from band 2 for the majority spin and bands 2,3 for the minority spin. These bands were chosen because of their proximity to the Fermi level.</p><pre><code>$ lmfgws fe `cat switches-for-lm` '--sfuned~units=eV~eps .01~readsek~evsync~se q=1.05,2.91,1.01 ib=2 nw=10 getev=12 isp=1~savesea~q'
$ lmfgws fe `cat switches-for-lm` '--sfuned~units=eV~eps .01~readsek~evsync~se q=1.05,2.91,1.01 ib=2,3 nw=10 getev=12 isp=2~savesea~q'
</code></pre><p>The first command writes a file <em style="color: green">seia.fe</em>, the second <em style="color: green">seia2.fe</em></p> <p>The following makes a picture comparing <em>A</em> (solid lines) and <i>A</i><sub>0</sub> (dashed lines), majority spin (black) and minority spin (red)</p><pre><code>$ fplot -x -9,5 -y 0,1 -colsy 6 -lt 1,col=0,0,0 seia.fe -colsy 7 -lt 2,col=0,0,0 seia.fe -colsy 2 -lt 1,col=1,0,0 seia2.fe -colsy 3 -lt 2,col=1,0,0 seia2.fe
$ open fplot.ps   [choose your postscript file viewer]
</code></pre><p>You can see a weak plasmon peak near −8 eV.</p> <h3 id="simulation-of-photoemission-midway-between-the-gamma-and-h-points"><em>Simulation of photoemission midway between the Γ and H points</em></h3> <!-- /tutorial/gw/gw_self_energy/#spectral-function-of-fe-near-the-h-point --> <p>This test simulates an ARPES measurement for a point approximately midway between Γ and H, at <strong>q</strong>≅0,0,0.45 near where bands cross the Fermi level. It is done in two ways:</p> <ul> <li>with the interacting spectral function, but without SO coupling</li> <li>with The QP spectral function broadened by 0.01 eV, and including SO coupling.</li> </ul><pre><code>$ lmfgws fe `cat switches-for-lm` '--sfuned~units=eV~eps .01~readsek~evsync~pe q=0,0,0.450980392 ib=2,3 nw=10 getev nqf=220 ke0=139-5+14.8 isp=2~savesea~q'
$ lmfgws fe -vso=1 `cat switches-for-lm` '--sfuned~units=eV~eps .01~qpse~evsync~peqp q=0,0,0.450980392 ib=1:8 nw=10 getev nqf=220 ke0=139-5+14.8 isp=1~savesea~q'
</code></pre><p>The first command writes a file <em style="color: green">pes2.fe</em>, the second <em style="color: green">pesqp.fe</em>.</p> <p>… need to complete</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
