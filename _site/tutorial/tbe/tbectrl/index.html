<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Empirical tight-binding program TBE</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Empirical tight-binding program TBE" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/tbe/tbectrl/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw/">QSGW Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <h1>Empirical tight-binding program TBE</h1> </header> <h3 id="purpose"><em>Purpose</em></h3> <hr /> <p>The purpose of this tutorial is to outline the steps to produce very simple cells within TBE, first a bcc unit cell and then a more complex super-cell containing a vacancy, and show generally what the output will look like. All of the tokens and categories are defined and explained in the LMTO <a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/">tokens</a> page, and so will not be explained fully here. More information specific to TBE is given in the <a href="http://www.lmsuite.org/lm-suite-tutorials/tbe/">TBE</a> page</p> <h3 class="no_toc" id="table-of-contents"><em>Table of Contents</em></h3> <ul id="markdown-toc"> <li><a href="#purpose" id="markdown-toc-purpose"><em>Purpose</em></a> <ul> <li><a href="#producing-the-ctrl-file" id="markdown-toc-producing-the-ctrl-file">Producing the ctrl file</a></li> <li><a href="#running-the-simulation" id="markdown-toc-running-the-simulation">Running the simulation</a></li> <li><a href="#producing-a-more-complex-simulation" id="markdown-toc-producing-a-more-complex-simulation">Producing a more complex simulation</a></li> <li><a href="#running-the-simulation-1" id="markdown-toc-running-the-simulation-1">Running the simulation</a></li> </ul> </li> </ul> <h4 id="producing-the-ctrl-file">Producing the ctrl file</h4> <hr /> <p>First have to state the versions of each program being used in the <a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#VERScat">VERS</a> category and some details of the output can be set in <a href="file:///home/edmund/BROYDEN/lmto/lm/doc/tokens.html#IOcat">IO</a>.</p><pre><code>     VERS TB=10 LM=7 FP=7
     IO      SHOW=0 HELP=F VERBOS=31 WKP=F
</code></pre><p>Constants used elsewhere in the file may be defined as follows:</p><pre><code>     %const amass=1.09716d-3 r0=5.423516
</code></pre><p>Constants declared by <strong>% const</strong> are <a href="/docs/input/preprocessor/#variable-declarations-and-assignments">variables parsed by the preprocessor</a>. Alternatively they may be defined in the <a href="/docs/input/inputfile/#const&quot;"><strong>CONST</strong></a> category, but will then are separate from the preprocessor and are referenced without <em>{}</em> brackets. They can then be used in the subsequent categories.</p><pre><code>     STRUC   ALAT={r0} NBAS=2
             PLAT= 1.0 0.0 0.0   0.0 1.0 0.0   0.0 0.0 1.0

     SPEC ATOM=Fe Z=26 AMASS=55.845/{amass} NL=3 IDXDN=3 3 1
</code></pre><p><a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#STRUCcat">STRUC</a>, as may be expected, defines the details of the structure, here setting the lattice spacing using the constant <em>r0</em>, setting the number of atoms in the unit cell with <em>NBAS</em> and the three primitive lattice vectors, note that these, like the atom positons unless specified otherwise, are scaled by the lattice parameter, which must be given in atomic units.</p> <p><a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#SPECcat">SPEC</a> will define the details of the species involved, here we only have iron, where <em>NL</em> sets the number of l’s per site value and IDXDN determines which of the spd orbitals are included, where 3 means the orbital is excluded and 1 is included, so this Fe atom will only have d-orbitals. For simple sp-carbon atoms it would be:</p><pre><code>      ATOM=C Z=6 AMASS=12.0107/{amass} IDXDN=1 1 3 
</code></pre><p>The positions of these atoms may then be defined using the category <a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#SITEcat">SITE</a></p><pre><code>     SITE 
          ATOM=Fe POS=0.0 0.0 0.0  RELAX= 1 1 1
          ATOM=Fe POS=0.5 0.5 0.5  RELAX= 1 1 1
</code></pre><p>The atom coordinates will be scaled by the lattice parameter, unless they are specified using <em>XPOS</em>, causing them to be scaled instead by the lattice vectors. <em>RELAX</em> defines the directions that the atoms may be relaxed along (if the structure is being relaxed), where a value of 0 will prevent relaxation along that axis.</p><pre><code>     HAM	  NSPIN=1

     BZ    NKABC=4 4 4 METAL=3 TETRA=F EF0=0.643 DELEF=0.01 N=1 W=0.002

     TB    RMAXH=1.01*{r0}  FORCES=1

     ME      0
             Fe Fe | 0 0 0 0 0 0 0 -0.6 0.4 -0.1

     START   CNTROL=T
             ATOM=Fe P=4 4 3
                     Q=0 0.15 1
                       0 0.45 1
                       6 0.00 1
</code></pre><p><a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#HAMcat">HAM</a> includes details of the Hamiltonian, here only being used to set the number of spins to one.</p> <p><a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#BZcat">BZ</a> will specify details of the Brillouin zone integration, including the number of k-point divisions alnog each axis with <em>NKABC</em> and the method of integration used, here using Methfessel-Paxton sampling.</p> <p><a href="http://www.lmsuite.org/lm-suite-tutorials/tbe/#section2">TB</a> includes the Tight Binding specific switches <em>FORCES</em> will decide whether or not the forces are calculated, <em>RMAXH</em> sets the range for finding neighbours in the lattice.</p> <p><a href="http://www.lmsuite.org/lm-suite-tutorials/tbe/#section1">ME</a> sets the matrix elements for interactions between atoms, here it is set to the simplest case of fixed hopping integrals, where their values are set in the string of numbers below, here all have been set to zero apart from the d-orbital sigma, pi and delta integrals which are set to their canonical values.</p> <p><a href="http://www.lmsuite.org/lm-suite-tutorials/tbe/#section2">START</a> defines some of the diagonal elements of the Hamiltonian for each species, where the P values are not used but must be set and the Q values refer to the number of electrons, the onsite energy and the Hubbard U for the s, p and d orbitals respectively, here there are 6 electrons in the d-orbital and the onsite energy is set to zero.</p><pre><code>     ITER
        CONV=1d-4
        CONVC=5d-7
        NIT=100
        MIX=A5,b=0.5
</code></pre><p><a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#ITERcat">ITER</a> defines mixing details, but the quantities being mixed will be defined in the command line, it defaults to mixing elements of the Hamiltonian, but it will often be more effective to use <em>tbe –mxq</em> to mix charges or <em>tbe –mxq2</em> to mix charges and magnetic moments seperately.</p> <p>TBE has two methods of mixing available: Andersen, which can be more stable but take longer to converge, and Broyden, these are chosen by using <em>A</em> and <em>B</em> in the <em>MIX</em> token. How they are specified is similar to the <a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#mixing">LMTO</a>, however Broyden has some differences. When –mxq2 is being used with Broyden mixing w=w1,w2 will still set the weights used for charge and magnetic moment mixing respectively, however if <em>wa=1</em> is set it will do an alternate method called “clock mixing”, whereby it will mix the charges to self consistency before each iteration of magnetic mixing. Now <em>CONV</em> will set the charge rms difference requirement and <em>CONVC</em> will set that for magnetic moments. This method can generally produce better converged magnetic moments than the alternatives.</p> <p>Note that these categories may be written in other files and included using:</p><pre><code>          % include /path/to/file/SPECfile
</code></pre><h4 id="running-the-simulation">Running the simulation</h4> <hr /> <p>The simulation may then be run with:</p><pre><code>     tbe --mxq ctrl.file
</code></pre><p>So it will read everything from ctrl.file and use charge mixing. First it will read in the structure and build the k-point map, reducing the number required unless –nosym is specified in the command line. The values specified will be used to build the lattice. At each iteration it will also print the eigenvalues at selected k-points:</p><pre><code>     SECMTB:  kpt 1 of 10, k=  0.00000  0.00000  0.00000
     -3.9667 -3.9667 -0.2333 -0.2333  0.1556  0.1556  0.1556  2.6444  2.6444

     SECMTB:  kpt 10 of 10, k=  0.50000  0.50000  0.50000
     -1.4000 -1.4000 -1.4000 -1.4000 -1.4000 -1.4000  2.1000  2.1000  2.1000
</code></pre><p>It will then mix the charges as follows:</p><pre><code>     QMIX mixing multipole moments:
     Anderson iteration   1. 2 elements; mixed 0 of 0, beta=0.5, rms diff: 8.88178e-16
</code></pre><p>Here it has 2 elements, the charge from each atom, and zero prior iterations to mix as it is the first, but it would build to 5 if it didn’t complete so quickly due to the simplicity of this system. <em>rms diff</em> is the convergence criterion defined in <em>MIX</em> and so it only has to get lower than 1d-4.</p> <p>The forces will be calculated once the charges have been mixed to self consistency, although they will obviously be zero here as this is a perfect lattice.</p><pre><code>Site                pos                              force
1 Fe         0.00000   0.00000   0.00000      0.00000   0.00000   0.00000
2 Fe         0.50000   0.50000   0.50000      0.00000   0.00000   0.00000
</code></pre><p>Finally it will print the results of the calculation, giving the trace of the density matrix <em>Tr[rho]</em> (or the total number of electrons), the trace of the density matrix with the Hamiltonian <em>Tr[rho][H_0]</em> (which will just give the band structure energy here), the second order correction <em>E_2</em>, the internal Virial <em>3PV</em> and the electrostatic energy <em>emad</em>. A description of the rest of these terms may be found in the source code file tbtote.f. Note that due to the simplicity of this calculation most of these values are zero, but as the calculation becomes more complex with the inclusion of a pair potential, multiple spins, charge transfer, polarisation and so on more values will be calculated.</p><pre><code>    Tr[rho]                 :       12.00000000
    Tr[rho][H_0]            :      -11.12658182
    band structure energy   :      -11.12658182
    E_2                     :       -0.00000000
    pair potential energy   :        0.00000000
    reference energy        :        0.00000000
    total energy            :      -11.12658182
    free energy             :      -11.12676850
    3PV              pair   :        0.00000000
 
    c mmom=0 sev=-11.126582 erep=0 etot=-11.126582 emad=0 3pv=0 TS=.000187
</code></pre><h4 id="producing-a-more-complex-simulation">Producing a more complex simulation</h4> <hr /> <p>Now attempt relaxation of a structure with two spins per atom and a more complex description of the hopping integrals.</p> <p>The <a href="http://www.lmsuite.org/lm-suite-tutorials/input-reference/#DYNcat">DYN</a> category can be used to relax a static structure as follows:</p><pre><code>DYN
      MSTAT[MODE=5 HESS=F XTOL=1d-3 GTOL=1d-3
	    STEP=0.01 NKILL=100] NIT=1000
</code></pre><p>This sets the relaxation scheme to Fletcher-Powell and sets the tolerance for displacement and forces with <em>XTOL</em> and <em>GTOL</em> respectively, although only one is really necessary, A more interesting structure to relax may be a 54 atom super-cell with one atom removed to produce a vacancy:</p><pre><code>  STRUC   NBAS=53 NSPEC=1 NL=3 ALAT=5.423516
      PLAT=3 0 0   0 3 0   0 0 3
  SITE    
  ATOM=Fe POS=0      0      0
  ATOM=Fe POS=1.0    0      0
  ATOM=Fe POS=0      1.0    0
  ATOM=Fe POS=1.0    1.0    0
  ATOM=Fe POS=2.0    0.0    0
  ATOM=Fe POS=2.0    1.0    0
  ATOM=Fe POS=2.0    2.0    0
  ATOM=Fe POS=0     2.0    0
  ATOM=Fe POS=1.0    2.0    0
  ATOM=Fe POS=0.5    0.5    0.5
  ATOM=Fe POS=1.5    0.5    0.5
  ATOM=Fe POS=0.5    1.5    0.5
  ATOM=Fe POS=1.5    1.5    0.5
  ATOM=Fe POS=2.5    0.5    0.5
  ATOM=Fe POS=2.5    1.5    0.5
  ATOM=Fe POS=2.5    2.5    0.5
  ATOM=Fe POS=1.5    2.5    0.5
  ATOM=Fe POS=0.5    2.5    0.5
  ATOM=Fe POS=0       0     1.0
  ATOM=Fe POS=1.0     0     1.0
  ATOM=Fe POS=0      1.0    1.0
  ATOM=Fe POS=1.0    1.0    1.0
  ATOM=Fe POS=2.0    0.0    1.0
  ATOM=Fe POS=2.0    1.0    1.0
  ATOM=Fe POS=2.0    2.0    1.0
  ATOM=Fe POS=0      2.0    1.0
  ATOM=Fe POS=1.0    2.0    1.0
  ATOM=Fe POS=0.5    0.5    1.5
  ATOM=Fe POS=1.5    0.5    1.5
  ATOM=Fe POS=0.5    1.5    1.5
  ATOM=Fe POS=1.5    1.5    1.5
  ATOM=Fe POS=2.5    0.5    1.5
  ATOM=Fe POS=2.5    1.5    1.5
# ATOM=Fe POS=2.5    2.5    1.5
  ATOM=Fe POS=1.5    2.5    1.5
  ATOM=Fe POS=0.5    2.5    1.5
  ATOM=Fe POS=0       0     2.0
  ATOM=Fe POS=1.0     0     2.0
  ATOM=Fe POS=0      1.0    2.0
  ATOM=Fe POS=1.0    1.0    2.0
  ATOM=Fe POS=2.0    0.0    2.0
  ATOM=Fe POS=2.0    1.0    2.0
  ATOM=Fe POS=2.0    2.0    2.0
  ATOM=Fe POS=0      2.0    2.0
  ATOM=Fe POS=1.0    2.0    2.0
  ATOM=Fe POS=0.5    0.5    2.5
  ATOM=Fe POS=1.5    0.5    2.5
  ATOM=Fe POS=0.5    1.5    2.5
  ATOM=Fe POS=1.5    1.5    2.5
  ATOM=Fe POS=2.5    0.5    2.5
  ATOM=Fe POS=2.5    1.5    2.5
  ATOM=Fe POS=2.5    2.5    2.5
  ATOM=Fe POS=1.5    2.5    2.5
  ATOM=Fe POS=0.5    2.5    2.5
</code></pre><p>Here the atom was removed by inserting # before it, which will cause any line to become a comment. Due to the more complex structure it may be advisable to change the mixing parameters in order to accelerate convergence:</p><pre><code>ITER    CONV=1d-4 CONVC=1d-3 NIT=1000 MIX=b13,b=0.008,bv=0.008,wc=-1,w=-1,-1
</code></pre><p>Now TBE will use Broyden mixing, with a smaller beta and increased number of prior mixing iterations to improve stability, and with the weights for charge and spin mixing set separately, with <em>w=</em>, if –mxq2 is specified in the command line, otherwise only wc will be used. Note that wc is set to a negative number, this causes new weights to be calculated on each iteration from the previous RMS. Another way to improve the stability of the mixing is to use the clock-mixing scheme, as mentioned, by setting <em>wa=1</em> in <strong>ITER</strong>, which could be useful for this simulation. Note: in order to include magnetism, and use clock mixing, the number of spins must be set to 2 in the <strong>HAM</strong> category.</p><pre><code>  HAM         NSPIN=2 ELIND= -0.7 PWMODE=11 PWMAX=5 PWMIN=1

  SPEC    
      ATOM=Fe Z=26 R=R I=0.05 A=0.025 AMASS=55.845/{amass}
      IDU= 0 0 0 0 UH= 0 0 0 0  JH=0.05 0.05 0.05 0.05 
      COLOUR=0.1 0.1 0.1  RADIUS=0.5
      IDXDN=3 3 1 


  START   CNTROL=T
      ATOM=Fe   P= 4 4 3 4 4 3
		Q= 0            0.15   1
		  0            0.45   1
		  (8.8)/2       0.0   1
		  0            0.15   1
		  0            0.45   1
		  (4.8)/2       0.0   1
</code></pre><p>The spin channels must now be specified separately using two sets of Q values, so that the number of electrons in each may be specified. In order for the relaxation to be actually meaningful the matrix elements for the interactions should be changed from their fixed form.</p><pre><code>  ME     2
      Fe Fe MEMODE=2 PPMODE=10 POLY=5 CUTMOD=2 CUTPP=4.88116 7.592922
	  | -0.35 0 0 0 -0.14067 0 0 -2.43826 1.99715735 -0.90723918
      DECAY=0.3 1 1 1    0.3 1  1    0.9 0.9 0.9
	CUT=5.9658 10.847 0 0 0 0 0 0 5.96586 10.847 0 0 0 0 4.88116 7.5929 4.88116 7.5929 4.88116 7.5929
	    @ 0.45 0 0 0 0.5 0 0 0 0 0
	DECAY=0.3 1 1 1   0.3 1  1    0.9 0.9 0.9
	CUT=5.9658 10.847 0 0 0 0 0 0 5.96586 10.847 0 0 0 0 4.88116 7.5929 4.88116 7.5929 4.88116 7.5929
	    ! 683.1 0 1.5376   -459.5 0 1.4544   0 0 0
	    
  TB      FORCES=1 EVDISC=T RMAXH=7.59292 TRH=T RHO=T 3PV=1
      UL=1 IODEL=0 OVLP=0
	
  SYMGRP  find
	
  BZ      NKABC=8 TETRA=T METAL=3
          EFMAX=5 
</code></pre><p>Here the interaction between iron atoms has been chosen to have an exponential decay, where the first set of numbers set the actual values for the elements, then <em>DECAY</em> sets the exponents of the decay function and CUT will set the points where the decay starts and where the function goes to zero for each interaction. There are values set for the overlaps after @, and has a similar form for its decay parameter, although this will not be relevant here as there are no electrons in the s-bands and OVLP is set to false. PPMODE defines the form of the pair potential, here set to a sum of power law multiplied by an exponential, the values of which are set after !. More details are given on the <a href="http://www.lmsuite.org/lm-suite-tutorials/tbe/">TBE</a> page.<br /> Finally the value of RMAXH must be changed to reflect the new range of the interactions. Note that IODEL is set to zero here so the simulation must be started fresh each time it is interrupted, but if set to 1 the delta and qmom files can be used to pick up the simulation where it left off.</p> <h4 id="running-the-simulation-1">Running the simulation</h4> <hr /> <p>This time, in order to use the clock-mixing scheme, the simulation must be run with:</p><pre><code>     tbe --mxq2 ctrl.file
</code></pre><p>Now it will first mix the charges to a consistency of at least <em>CONV</em>:</p><pre><code>     Broyden iteration   62:   53 charges; mixed 13 of 13, rms diff: 2.61389e-5 (tol: 1e-4)
</code></pre><p>Before it mixes the moments once:</p><pre><code>     Broyden iteration   63:   53 spins;   mixed  1 of 13, rms diff: 2.8871 (tol: 1e-3)
</code></pre><p>This will continue until the spins reach a consistency of <em>CONVc</em>, then it will calculate the forces on each atom, broken down into contributions:</p><pre><code>      Forces on atom    1    Species: Fe  
        Coordinates        :    0.00000000    0.00000000    0.00000000
        From bands         :    0.00007160    0.00007160    0.00000000
        From e'stx         :    0.00000201    0.00000201    0.00000000
        From pairs         :   -0.00000000   -0.00000000    0.00000000
        Total              :    0.00007361    0.00007361    0.00000000
</code></pre><p>And the maximum force:</p><pre><code>      Maximum force= 0.013959 on atom 25 (Fe)
</code></pre><p>This is what will be used to determine whether the structure is relaxed or not with <em>GTOL</em>, it will then use the process <strong>gradzr</strong> to update the site postions using the Fletcher-Powell scheme:</p><pre><code>      gradzr: begin F.P. xtol=1e-3 and gtol=1e-3  gtll=0.25  dxmx=0.01  isw=161
      gradzr new line 1:  g.h=-0.00271  g.(h-g)=0  max g=-0.0135  |grad|=0.0521  
        p= 0.00000000 0.00000000 0.00000000 1.00000000 0.00000000 0.00000000
        g= -7.3610e-5 -7.3610e-5 -6.367e-21 -6.832e-21 -5.1871e-4 6.9440e-18
        h= 7.36102e-5 7.36102e-5 6.3673e-21 6.8323e-21 5.18712e-4 -6.944e-18
      rfalsi: new start  (c) xtol=0.074  dxmn=0.037  dxmx=0.74
      rfalsi ir=-1: seek xn=0.73960125
      RELAX line 1:  new line minimization;  max shift=0.01000  |g|=0.0521
</code></pre><p>And will print out the new coordinates:</p><pre><code>      Updated atom positions:
        Site   Class                      Position(relaxed)
        1      Fe         0.00005444(T)    0.00005444(T)    0.00000000(T)
</code></pre><p>Before it begins mixing again with the atoms in their new positions, this will continue until the structure is sufficently relaxed, then it will print the final energies and coordinates:</p><pre><code>        Tr[rho]         total   :      360.40000000
                        moment   :      153.91791280
        Tr[rho][H_0]       up   :       -0.93026638
                          down   :       -9.09863081
                        total   :      -10.02889719
        band structure energy   :      -21.16528983
        E_2                     :       -5.58942732
        pair potential energy   :       -0.78950422
        reference energy        :        0.00000000
        Stoner magnetic energy  :       -5.58999333
        Magnetic moment         :      153.91791280
        total energy            :      -16.40782873
        free energy             :      -16.40783056
        3PV              pair   :       42.22590387
                        bands   :      -45.87326581
                        charges :       -0.00061289
                        total   :       -3.64797484
</code></pre><p>Due to the increased complexity of the interactions and the inclusion of two spins there is a lot more information printed here than previously.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
