<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Self-Consistent ASA calculation for PbTe</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Self-Consistent ASA calculation for PbTe" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/asa/lm_pbte_tutorial/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>Self-Consistent ASA calculation for PbTe</h1> </header> <p class="teaser"> </p> <hr /> <h3 class="no_toc" id="purpose"><em>Purpose</em></h3> <p>This tutorial covers the basics for running a self consistent LDA calculation in the Atomic Spheres Approximation (ASA), starting with the creation of an input file. We will use PbTe for the tutorial.</p> <hr /> <h3 id="command-summary"><em>Command summary</em></h3> <p>The tutorial starts under the heading “Tutorial”; you can see a synopsis of the commands by clicking on the box below.</p> <div onclick="elm = document.getElementById('1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Commands - Click to show</button></div> <p><div style="display:none;margin:0px 25px 0px 25px;"id="1"></p><pre><code>$ blm --express=0 --asa --wsitex --findes init.pbte
$ blm --h
$ cp actrl.pbte ctrl.pbte
$ blm --express=0 --asa --wsitex --addes init.pbte
$ cp actrl.pbte ctrl.pbte

... the following from section 2.2 are optional
$ lmchk ctrl.pbte
$ lmchk --findes --wsitex ctrl.pbte
 
$ lmstr ctrl.pbte
$ lm -vnit=0 ctrl.pbte
$ lm -vnit=20 ctrl.pbte
$ lmctl ctrl.pbte
$ cat log.pbte &gt;&gt; ctrl.pbte
</code></pre><p></div></p> <hr /> <h3 id="preliminaries"><em>Preliminaries</em></h3> <hr /> <p>Executables <strong style="color: blue">blm</strong>, <strong style="color: blue">lmchk</strong>, <strong style="color: blue">lmstr</strong> and <strong style="color: blue">lm</strong> are required and are assumed to be in your path. The last step (not essential for the tutorial) uses <strong style="color: blue">lmctl</strong>. The source code for all Questaal executables can be found <a href="https://bitbucket.org/lmto/lm">here</a>.</p> <h3 id="tutorial"><em>Tutorial</em></h3> <hr /> <p>This tutorial consists of two main sections:</p> <ol> <li>Building a suitable input file for an ASA-LDA calculation</li> <li>Running a self consistent calculation</li> </ol> <p>A detailed theoretical description of the ASA and its uses can be found <a href="ASA-notes.pdf">here</a>.</p> <h5 id="building-input-file"><em>1.Building input file</em></h5> <p>Under normal atmospheric conditions PbTe crystallises in the rocksalt structure with lattice constant <em>a</em>=6.428Å. <br /> To build an input file, the first step is to construct file <em style="color: green">init.ext</em> (<em style="color: green">ext</em> is replaced by a name of your choosing, usually related to the material being studied, pbte in this case). <em style="color: green">init.pbte</em> will contain the structural information needed for the calculations demonstrated here. For PbTe it will look similar to the following. Copy the content of the box below into <em style="color: green">init.pbte</em>:</p><pre><code>LATTICE
    ALAT=6.427916  UNITS=A
        PLAT=    0.0000000    0.5000000    0.5000000
                 0.5000000    0.0000000    0.5000000
                 0.5000000    0.5000000    0.0000000
SITE
	ATOM=Pb   X=     0.0000000    0.0000000    0.0000000
	ATOM=Te   X=     0.5000000    0.5000000    0.5000000
</code></pre><p>File <em style="color: green">init.pbte</em> shown above has two sections: <strong>LATTICE</strong> and <strong>SITE</strong>. The lattice section includes information regarding the lattice structure such as lattice constant (<strong>ALAT=</strong>) and its units (<strong>UNITS</strong>=, Å in this case) plus the primitive lattice translation vectors (<strong>PLAT=</strong>). The site section of the init file includes the basis information. In the case of PbTe there are two atoms, one Pb and one Te at the position indicated by “X=” (X= indicates positions as fractional multiples of the lattice vectors. Alternatively, you can supply the position with <strong>POS=</strong>, which specifies positions in Cartesian coordinates, in units of the lattice constant).</p> <p>Now that <em style="color: green">init.pbte</em> has been created, <strong style="color: blue">blm</strong> will create the ctrl file, which is the primary input file for the Questaal suite. Invoke it this way:</p><pre><code>$ blm --express=0 --asa --wsitex --findes  init.pbte
</code></pre><p>This command will generate three new files which are <em style="color: green">site.pbte</em>, <em style="color: green">actrl.pbte</em>, and <em style="color: green">log.pbte</em>. (The log file keeps track of key information generated by each program and will not be considered here.) The site file contains structural information in a form the Questaal package can read, and the ctrl file contains all other information needed to carry out a self-consistent calculation (LDA-ASA calculation in this case). The switches <strong style="color: blue">blm</strong> used have the following meanings:</p><pre><code>--express=0  controls the brevity of the input file (smaller numbers make more verbose files with more information. 
	     It is worth experimenting with this switch to find which style of control file you are most confortable with.
--asa        tells blm that you are preparing to do an ASA calculation
--wsitex     causes blm to write site positions as fractional multiples of the lattice vectors.
--findes     causes blm to find empty spheres to fill the unit cell. 
</code></pre><p>The last switch is necessary when using ASA, because the sum of sphere volumes must equal the cell volume. The ASA only works well when sites are closely packed. Close packing of open systems can be artificially accomplished by adding “empty” sites with Z=0.</p> <p><strong style="color: blue">blm</strong> has a number of other command-line switches; to see what they are, type:</p><pre><code>$ blm --h
</code></pre><p>Now the only thing left to do is to rename <em style="color: green">actrl.pbte</em> to <em style="color: green">ctrl.pbte</em>, which is the name of the main input file.</p><pre><code>$ cp actrl.pbte ctrl.pbte
</code></pre><p><strong style="color: blue">blm</strong> writes to actrl, rather than ctrl, to avoid overwriting a file you may wish to keep.</p> <p><em style="color: red">Note</em></p> <ul> <li>Lines which begin with <strong>#* are comment lines and are ignored. (More generally, text following a **#</strong> in any line is ignored).</li> <li>Lines beginning with <strong>%</strong> directives to the preprocessor. Directives can perform various functions similar to a normal programming language, such as assigning variables, evaluating expressions, conditionally readings some lines, and repeated loops over sections of input.</li> </ul> <h5 id="building-the-input-file"><em>2.Building the input file</em></h5> <p>If you used <strong style="color: blue">blm</strong> as above to find the empty spheres (ES) you can skip section 2.1 below. It is included here to explain how to add empty spheres to an already existing ctrl file.</p> <h6 id="empty-spheres"><em>2.1 Empty Spheres</em></h6> <p>Begin by running <strong style="color: blue">blm</strong> with a slightly different set of switches:</p><pre><code>$ blm --express=0 --asa --wsitex --addes init.pbte
$ cp actrl.pbte ctrl.pbte
</code></pre><p><code>--addes</code> differs from <code>--findes</code> in that in the former case, <strong style="color: blue">blm</strong> prepares the input file for adding empty spheres, without actually adding them, while in the latter case <strong style="color: blue">blm</strong> addes them automatically.</p> <p>To check ES and volume packing invoke:</p><pre><code>$ lmchk ctrl.pbte
</code></pre><p>The full output can be viewed by clicking here (waiting for file storing system), however the important informations regarding the volume packing and overlap are towards the end of the standard output (stdout) and in this particular case it can be seen (in the case of no ES) in one line</p><pre><code>Cell volume= 448.07190   Sum of sphere volumes= 301.06511 (0.67191)
</code></pre><p>Here the cell volume, sum of all sphere volumes and their ratio are presented, the latter of which has to be equal to 1 for an ASA calculation. Another important value is the overlap percentage, which in this case is given by</p><pre><code>  OVMIN, 38 pairs:  fovl = 4.24366e-7   &lt;ovlp&gt; = 8.7%   max ovlp = 8.7%
</code></pre><p>This line tells us about the average and maximum sphere overlaps. Generally, for ASA the overlaps should be kept below 16% where possible. For full potential calculations generally 5% and below is safe. For <em>GW</em> calculations it should be below 2%. As the sum of sphere volumes is less than the cell volume, we have to add artificial atoms with <em>Z</em>=0 (“empty spheres”) to meet this requirement.</p> <p>The appropiate space filling spheres can be found using <strong style="color: blue">lmchk</strong> by invoking:</p><pre><code>$ lmchk --findes --wsitex ctrl.pbte
</code></pre><p>We have added two command-line switches: the first is to invoke the procedure to find the empty spheres and the second is to write the information into a new site file called <em style="color: green">essite.pbte</em>. At the end of the stdout generated by <strong style="color: blue">lmchk</strong> you will see the following snippet:</p><pre><code> ... Final sphere sizes and packing fraction (2 new spheres)

 SCLWSR:  mode = 30  vol = 448.072 a.u.   Initial sphere packing = 81.3%  scaled to 100%
 constr omax1=  16.0  18.0  20.0 %    omax2=  40.0 100.0 100.0 %
 actual omax1=   8.7  12.1   0.0 %    omax2=  16.0  24.6   0.0 %

 spec  name        old rmax    new rmax     ratio
    1   Pb          3.300000    3.300000    1.000000
    2   Te          3.300000    3.300000    1.000000
    3   E           1.959808    2.598601    1.325947
</code></pre><p>which indicates two new empty spheres have been found, and the new sphere packing is 100%. The control file has to be changed to reflect the new basis. First, change:</p><pre><code>  NBAS=2+{les?0:0}  NL=4  NSPEC=2+{les?0:0}
</code></pre><p>to</p><pre><code>  NBAS=2+{les?2:0}  NL=4  NSPEC=2+{les?1:0}
</code></pre><p>Quantities in brackets <strong>{…}</strong> are algebraic expressions. In particular, <strong>{les?2:0}</strong> uses C-like syntax consisting of three expressions separated by ‘<strong>?</strong>’ and ‘<strong>:</strong>’. The first (<strong>les</strong> in this case) is evaluated. If <strong>les</strong> is nonzero, the result of the entire bracket is the result of the second expression (<strong>2</strong> in this case) and otherwise the result of the third (<strong>0</strong>). In the line above, the contents of tag <strong>NBAS=</strong> can be interpreted as “if <strong>les</strong>&gt;0 then <strong>NBAS=4</strong> else <strong>NBAS=2</strong>”. Similarly the contents of <strong>NSPEC</strong> can be interpreted as “if <strong>les</strong>&gt;0 <strong>NSPEC</strong>=3 else <strong>NSPEC=2</strong>”. “<strong>les</strong>” is a variable that is defined in the control file through the following line</p><pre><code>  % const nit=10 les=1
</code></pre><p>Here we have also defined <strong>nit</strong> with value of 10. Finally, we have to pass the information about the empty sphere sites to the control file. We do this by commenting both instances of the line beginning <strong>FILE=site</strong> and uncommenting the line <strong>FILE=essite</strong>, as <em style="color: green">essite.pbte</em> has the new appropiate information. <em style="color: red">Note:</em> there are <em>two</em> instances of <strong>FILE=site</strong> : the first occurs in the <strong>STRUC</strong> category, where lattice information is read. The second occurs in the <strong>SITE</strong> category, where basis information is read. Be sure to comment/uncomment both instances.</p> <p>The last step is to copy the new species information from file <em style="color: green">poses.pbte</em> file to the <strong>SPEC</strong> category within the ctrl file, including the new empty spheres.</p> <h6 id="self-consistency"><em>2.2 Self-consistency</em></h6> <p>Before a self consistent calculation can be performed the real-space structure constants have to be generated. They are made once, for a given structure, with a separate tool</p><pre><code>$ lmstr ctrl.pbte
</code></pre><p>The penultimate step, is to generate a starting potential. In the ASA, the potential is determined <a href="/docs/code/asaoverview/">through multipole moments</a> <script type="math/tex">Q_0</script>, <script type="math/tex">Q_1</script>, <script type="math/tex">Q_2</script>. For this we first change the nkabc variable within the control file to (<strong>nkabc=4</strong>, this variable represents the k-mesh density). Use your text editor to change:</p><pre><code>% const nkabc=0
</code></pre><p>to</p><pre><code>% const nkabc=4
</code></pre><p>Invoke <strong style="color: blue">lm</strong> executable with zero number of iterations as:</p><pre><code>$ lm -vnit=0 ctrl.pbte
</code></pre><p>This command takes <script type="math/tex">Q_0</script>, <script type="math/tex">Q_1</script>, <script type="math/tex">Q_2</script> and makes a trial potential from it. You supply <script type="math/tex">Q_0</script>, <script type="math/tex">Q_1</script>, <script type="math/tex">Q_2</script>; if you do not will take some simple default guesses. <strong style="color: blue">blm</strong> does not supply these values.</p> <p>For a self consistent LDA-ASA calculation invoke <strong style="color: blue">lm</strong> with <strong>nit</strong>&gt;0, e.g.</p><pre><code>$ lm -vnit=20 ctrl.pbte
</code></pre><p>You should see “Jolly good show” at the end of the standard output will indicate if self-consistency has been achieved, which in this case it has.</p> <p><em style="color: red">Note:</em> <code>-vnit=20</code> does not <em>directly</em> set the number of iterations. This number is determined by token <strong>NIT</strong> in this line:</p><pre><code>ITER  MIX=B2,b=.3,k=7  NIT={nit}  CONVC=1e-5
</code></pre><p>The preprocessor sees the the curly brackets (<strong>{nit}</strong>), treats the contents as an expression (a trivial one in this case) and substitutes the result (20) for <strong>{nit}</strong>.</p> <p>As a final step, you can collect the self-consistent moments generated by <strong style="color: blue">lm</strong> and add them to the ctrl file. Type</p><pre><code>$ lmctl ctrl.pbte
</code></pre><p><strong style="color: blue">lmctl</strong> clears the log file, <em style="color: green">log.pbte</em>, and overwrites it with linearization parameters <em>P</em> and moments <script type="math/tex">Q_0</script>, <script type="math/tex">Q_1</script>, <script type="math/tex">Q_2</script>, in a form suitable for the ctrl file. Append <em style="color: green">log.pbte</em> with, e.g.</p><pre><code>$ cat log.pbte &gt;&gt; ctrl.pbte
</code></pre><p>In this way the ctrl file retains the essential information for the self-consistent density.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
