<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Self-Consistent LDA calculation for PbTe</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content=""/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Self-Consistent LDA calculation for PbTe" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/lmf/lmf_pbte_tutorial/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit program</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw/">QSGW Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <p class="subheadline"></p> <h1>Self-Consistent LDA calculation for PbTe</h1> </header> <p class="teaser"> </p> <h3 id="purpose"><em>Purpose</em></h3> <hr /> <p>This tutorial carries out a self-consistent density-functional calculation for PbTe using the <strong style="color: blue">lmf</strong> code. It has a purpose <a href="/tutorial/lmf/lmf_tutorial/">similar to the basic tutorial</a> but shows some additional features. It:</p> <ol> <li>explains the input file’s structure and illustrates some of its programming language capabilities</li> <li>generates a self consistent potential within the LDA</li> <li>makes neighbour tables using the <strong style="color: blue">lmchk</strong> tool</li> <li>synchronizes with an <a href="/tutorial/asa/lm_pbte_tutorial/">ASA tutorial</a> on the same system, enabling a comparison of the ASA and full potential methods.</li> <li>forms the starting point for other tutorials on optics, a QSGW calculation of PbTe, and compares energy bands computed in different ways.</li> </ol> <h3 id="table-of-contents"><em>Table of Contents</em></h3> <hr /> <ul class="no_toc" id="markdown-toc"> <li><a href="#purpose" id="markdown-toc-purpose"><em>Purpose</em></a></li> <li><a href="#table-of-contents" id="markdown-toc-table-of-contents"><em>Table of Contents</em></a></li> <li><a href="#preliminaries" id="markdown-toc-preliminaries"><em>Preliminaries</em></a></li> <li><a href="#command-summary" id="markdown-toc-command-summary"><em>Command summary</em></a></li> <li><a href="#tutorial" id="markdown-toc-tutorial"><em>Tutorial</em></a> <ul> <li><a href="#building-the-input-file" id="markdown-toc-building-the-input-file">1. <em>Building the input file</em></a></li> <li><a href="#how-the-input-file-is-organized" id="markdown-toc-how-the-input-file-is-organized">2. <em>How the input file is organized</em></a></li> <li><a href="#the-express-category" id="markdown-toc-the-express-category">3. <em>The <strong>EXPRESS</strong> category</em></a></li> <li><a href="#determining-what-input-an-executable-seeks" id="markdown-toc-determining-what-input-an-executable-seeks">4. <em>Determining what input an executable seeks</em></a></li> <li><a href="#initial-setup" id="markdown-toc-initial-setup">4. <em>Initial setup</em></a> <ul> <li><a href="#local-orbitals" id="markdown-toc-local-orbitals">4.1 Local orbitals</a></li> <li><a href="#valence-core-partitioning-of-the-free-atomic-density" id="markdown-toc-valence-core-partitioning-of-the-free-atomic-density">4.2 Valence-core partitioning of the free atomic density</a></li> <li><a href="#relativistic-core-levels" id="markdown-toc-relativistic-core-levels">Relativistic core levels</a></li> <li><a href="#automatic-determination-of-basis-set" id="markdown-toc-automatic-determination-of-basis-set">4.3 Automatic determination of basis set</a></li> </ul> </li> <li><a href="#self-consistency" id="markdown-toc-self-consistency">5. <em>Self consistency</em></a></li> <li><a href="#annotation-of-lmfs-output" id="markdown-toc-annotation-of-lmfs-output">6. <em>Annotation of lmf’s output</em></a></li> </ul> </li> <li><a href="#other-resources" id="markdown-toc-other-resources"><em>Other Resources</em></a></li> <li><a href="#additional-exercises" id="markdown-toc-additional-exercises"><em>Additional exercises</em></a></li> </ul> <h3 id="preliminaries"><em>Preliminaries</em></h3> <hr /> <p>Some of the basics are covered in the basic <a href="/tutorial/lmf/lmf_tutorial/">lmf tutorial for Si</a>, which you may wish to go through first.</p> <p>Executables <strong style="color: blue">blm</strong>, <strong style="color: blue">lmchk</strong>, <strong style="color: blue">lmfa</strong>, and <strong style="color: blue">lmf</strong> are required and are assumed to be in your path.</p> <hr /> <h3 id="command-summary"><em>Command summary</em></h3> <p>The tutorial starts under the heading “Tutorial”; you can see a synopsis of the commands by clicking on the box below.</p> <div onclick="elm = document.getElementById('1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Commands - Click to show</button></div> <p><div style="display:none;margin:0px 25px 0px 25px;"id="1"></p><pre><code>$ blm init.pbte                                 #makes template actrl.pbte and site.pbte
$ cp actrl.pbte ctrl.pbte
$ lmfa ctrl.pbte                                #use lmfa to make basp file, atm file and to get gmax
$ cp basp0.pbte basp.pbte                       #copy basp0 to recognised basp prefix   

... to be finished
</code></pre><p></div></p> <hr /> <h3 id="tutorial"><em>Tutorial</em></h3> <h4 id="building-the-input-file">1. <em>Building the input file</em></h4> <!-- /tutorial/lmf/lmf_pbte_tutorial/#building-the-input-file --> <p>PbTe crystallizes in the rocksalt structure with lattice constant <em>a</em> = 6.428Å. You need the structural information in the box below to construct the main input file, <em style="color: green">ctrl.pbte</em>. Start in a fresh working directory and cut and paste the box’s contents to <em style="color: green">init.pbte</em>.</p><pre><code>LATTICE
    ALAT=6.427916  UNITS=A
        PLAT=    0.0000000    0.5000000    0.5000000
                 0.5000000    0.0000000    0.5000000
                 0.5000000    0.5000000    0.0000000
SITE
	ATOM=Pb   X=     0.0000000    0.0000000    0.0000000
	ATOM=Te   X=     0.5000000    0.5000000    0.5000000
</code></pre><p>The primitive lattice vectors are in row format (i.e. the first row contains the <em>x</em>, <em>y</em> and <em>z</em> components of the first lattice vector and so forth). In the <strong>SITE</strong> section, the atom type and coordinates are shown. <strong>X=</strong> specifies the site coordinates. They are specified in “direct” representation, i.e., as fractional multiples of lattice vectors <strong>PLAT</strong>. You can also use Cartesian coordinates; instead of <strong>X=</strong> you would use <strong>POS=</strong> (see additional exercises below). Positions in Cartesian coordinates are in units of <strong>ALAT</strong>, like the lattice vectors.</p> <p>Use the <strong style="color: blue">blm</strong> tool as in the box below to create the input file (<em style="color: green">ctrl.pbte</em>) and the site file (<em style="color: green">site.pbte</em>):</p><pre><code>$ blm init.pbte
$ cp actrl.pbte ctrl.pbte
</code></pre><h4 id="how-the-input-file-is-organized">2. <em>How the input file is organized</em></h4> <p>In this tutorial, <strong style="color: blue">blm</strong> is used in “standard” mode. (The <a href="/tutorial/lmf/lmf_tutorial/">basic tutorial</a> creates a simpler file with <code>blm --express init.si</code>). Standard mode makes limited use of the <a href="/docs/input/inputfile/">preprocessing capabilities</a> of the Questaal input system : it uses algebraic variables which can be modified on the command line. Thus <code>lmf -vnit=10 ...</code> sets variable <strong>nit</strong> to 10 before doing anything else. Generally:</p> <ul> <li>Lines which begin with ‘<strong>#</strong>’ are comment lines and are ignored. (More generally, text following a `#’ in any line is ignored). s* Lines beginning with ‘<strong>%</strong>’ are directives to the <a href="/docs/input/preprocessor/">preprocessor</a>.</li> </ul> <div onclick="elm = document.getElementById('variablesexplained'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see how variables can be set and used in the ctrl file.</div> <p><div style="display:none;padding:5px;" id="variablesexplained"></p> <p>The beginning of the ctrl file you just generated should look like the following:</p><pre><code># Variables entering into expressions parsed by input
% const nit=10
% const met=5
% const so=0 nsp=so?2:1
% const lxcf=2 lxcf1=0 lxcf2=0     # for PBE use: lxcf=0 lxcf1=101 lxcf2=130
% const pwmode=0 pwemax=3          # Use pwmode=1 or 11 to add APWs
% const nkabc=0 gmax=0
</code></pre><p><strong>% const</strong> tells the proprocessor that it is declaring one or more variables. <strong>nit</strong>, <strong>met</strong>, etc, used in expressions later on. The parser interprets the contents of brackets <strong>{…}</strong> as algebraic expressions: The contents of <strong>{…}</strong> is evaluated and the numerical result is substituted for it. Expression substitution works for input lines proper, and also in the directives.</p> <p>For example this line</p><pre><code>metal=  {met}                    # Management of k-point integration weights in metals
</code></pre><p>becomes</p><pre><code>metal=  5
</code></pre><p>because <strong>met</strong> is a numerical expression (admittedly a trivial one). It evaluates to 5 because <strong>met</strong> is declared as an algebraic variable and assigned value 5 near the top of the ctrl file. The advantage is that you can do algebra in the input file, and you can also re-assign values to variables from the command line, as we will see shortly.</p> <p></div></p> <p>Lines corresponding to actual input are divided into <strong style="color: red">categories</strong> and <strong style="color: blue">tokens</strong> within the categories. A category begins when a character (other than <strong>%</strong> or <strong>#</strong>) occurs in the first column. Each token belongs to a category; for example in box below <strong style="color: red">IO</strong> contains three tokens, <strong style="color: blue">SHOWMEM</strong>, <strong style="color: blue">IACTIV</strong> and <strong style="color: blue">VERBOS</strong> :</p><pre><code>IO    SHOWMEM=f
      IACTIV=f VERBOS=35,35
</code></pre><p>(Internally, a complete identifier (aka <em>tag</em>) would be <strong>IO_IACTIV=</strong>, though it does not appears in that form in the ctrl file.)</p> <p><a href="/docs/input/inputfile/#input-file-structure">This link</a> explains the structure of the input file in more detail.</p> <h4 id="the-express-category">3. <em>The <strong>EXPRESS</strong> category</em></h4> <p><strong style="color: blue">blm</strong> normally includes an <strong>EXPRESS</strong> category in <em style="color: green">ctrl.pbte</em>.</p> <div onclick="elm = document.getElementById('express'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see the beginning of the EXPRESS category.</div> <p><div style="display:none;padding:0px;" id="express"></p><pre><code>EXPRESS
# Lattice vectors and site positions
  file=   site

# Basis set
  gmax=   {gmax}                   # PW cutoff for charge density
  autobas[pnu=1 loc=1 lmto=5 mto=4 gw=0]
</code></pre><p></div></p> <p>Tags in the <strong>EXPRESS</strong> category are effectively aliases for tags in other categories, e.g. <strong>EXPRESS_gmax</strong> corresponds to the same input as <strong>HAM_GMAX</strong>. If you put a tag into <strong>EXPRESS</strong>, it will be read there and ignored in its usual location; thus in this instance adding <strong>GMAX</strong> to the <strong>HAM</strong> category would have no effect.</p> <p>The purpose of <strong>EXPRESS</strong> is to simplify the input file, collecting the most commonly used tags in one place.</p> <h4 id="determining-what-input-an-executable-seeks">4. <em>Determining what input an executable seeks</em></h4> <p><strong style="color: blue">blm</strong> builds input files with only a subset of the tags an executable will try to read. Defaults are used for the vast majority of tags. In any case each executable reads its own particular set, though most executables share many tags in common.</p> <p>Executables accept input from two primary streams : tags in the ctrl file and additional information through command-line switches.</p> <p>To see what an executable looks for in the ctrl file, invoke the executable with <code>--input</code>, e.g.</p><pre><code>$ lmchk --input
</code></pre><p><code>--input</code> puts <strong style="color: blue">lmchk</strong> in a special mode. It doesn’t attempt to read anything; instead, it prints out a (large) table of all the tags it would try to read, including a brief description of the tag, and then exits.</p> <p><code>$ lmchk --help</code> performs a similar function for the command line arguments: it prints out a brief summary of arguments effective in the executable you are using.</p> <p><code>$ lmchk --show</code> tells <strong style="color: blue">lmchk</strong> to print out tags as it reads them (or the defaults it uses)</p> <p>The remainder of this section is not essential to this tutorial and you can safely skip to section 5. It explains what information is printed when you use <code>--input</code>; it is useful if you want to see how tags and categories are organized, and how missing or partial tags are handled.</p> <div onclick="elm = document.getElementById('input'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here for a description of the `--input` function.</div> <p><div style="display:none;padding:0px;" id="input"></p> <p>Below is snippet of output from <code>lmchk --input</code>:</p><pre><code>    Tag                    Input   cast  (size,min)
    ------------------------------------------

    ...

    --- Parameters for species data ---
    ... The next four tokens apply to the automatic sphere resizer
    SPEC_SCLWSR            opt    r8       1,  1     default = 0
      Scales sphere radii, trying to reach volume = SCLWSR * cell volume
      SCLWSR=0 turns off this option.
      Add  10  to initially scale non-ES first;
       or  20  to scale ES independently.
    SPEC_OMAX1             opt    r8v      3,  1     default = 0.16 0.18 0.2
      Limits max sphere overlaps when adjusting MT radii

    ...

    SPEC_ATOM              reqd   chr      1,  0
      Species label
    SPEC_ATOM_Z            reqd   r8       1,  1
      Atomic number
    SPEC_ATOM_R            reqd*  r8       1,  1
      Augmentation sphere radius rmax

    ...
     SPEC_ATOM_LMX          opt    i4       1,  1     (default depends on prior input)
       l-cutoff for basis
     SPEC_ATOM_LMXA         opt    i4       1,  1     (default depends on prior input)
       l-cutoff for augmentation

    ...

    BZ_NKABC               reqd   i4v      3,  1
      (Not used if data read from EXPRESS_nkabc)
      No. qp along each of 3 lattice vectors.
      Supply one number for all vectors or a separate number for each vector.
</code></pre><p><strong style="color: blue">lmchk</strong> prints the full name of each tag, e.g. <strong>SPEC_ATOM</strong> and <strong>SPEC_ATOM_Z</strong>, even though components of the tag are separated in the ctrl file. <em style="color: green">ctrl.pbte</em> contains these lines</p><pre><code>SPEC 
  ATOM=Pb         Z= 82  R= 3.044814  LMX=3  LMXA=4
</code></pre><p>Many tags (<strong>SPEC_SCLWSR</strong>, <strong>SPEC_ATOM_LMX</strong>, <strong>SPEC_ATOM_LMXA</strong>) are optional: <strong style="color: blue">lmchk</strong> will substitute defaults if you don’t supply them. Those marked <strong>reqd</strong> (<strong>SPEC_ATOM</strong>, <strong>SPEC_ATOM_Z</strong>, <strong>SPEC_ATOM_R</strong>) you must supply.</p> <p>The cast (real, integer, character) of each tag is indicated, and also how many numbers are to be read. Sometimes tags will look for more than one number, but allow you to supply fewer. For example, <strong>BZ_NKABC</strong> looks for three numbers to determine the k-mesh, which are the number of divisions only each of the reciprocal lattice vectors. If you supply only one number it is copied to elements 2 and 3.</p> <p></div></p> <h4 id="initial-setup">4. <em>Initial setup</em></h4> <p>To carry out a self-consistent calculation, we need to prepare the following:</p> <p>4.1 Find any high-lying core states that should be included in the valence as local orbitals.<br /> 4.2 Make atomic densities, which <strong style="color: blue">lmf</strong> will overlap to make a starting trial density<br /> 4.3 Provide a reasonable basis set with parameters <strong>RSMH</strong> and <strong>EH</strong> defining the envelope functions<br /> 4.4 Supply an automatic estimate for the mesh density plane wave cutoff <strong>GMAX</strong>.</p> <p><strong style="color: blue">lmfa</strong> is a tool that will provide all of this information automatically. It will writes writes basis set information to template <em style="color: green">basp0.pbte</em>, The Questaal package reads from <em style="color: green">basp.pbte</em>, but it is written to file basp0 to avoid overwriting a file you may want to preserve. You can customize the basis set by editing the file.</p> <p>As a first step, do:</p><pre><code>$ lmfa ctrl.pbte                                #use lmfa to make basp file, atm file and to get gmax
$ cp basp0.pbte basp.pbte                       #copy basp0 to recognised basp prefix   
</code></pre><h5 id="local-orbitals">4.1 Local orbitals</h5> <!-- /tutorial/lmf/lmf_pbte_tutorial/#local-orbitals/ --> <p>Part of <strong style="color: blue">lmfa</strong>’s function is to identify <em>local orbitals</em> that <a href="/docs/package_overview/#linear-methods-in-band-theory">extend the linear method</a>. Linear methods are reliable only over a limited energy window; certain elements may require an extension to the linear approximation for accurate calculations. This is accomplished with <a href="/docs/package_overview/#linear-methods-in-band-theory">local orbitals</a>. <strong style="color: blue">lmfa</strong> will automatically look for atomic levels that if certain criteria are satisfied (as described in “lmfa output” below) it designates as a local orbital, and includes this information in the basp0 file.</p> <div onclick="elm = document.getElementById('localorbitals'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> Click here for a description of how local orbitals are specified in the basp file.</div> <p><div style="display:none;padding:0px;" id="localorbitals"></p> <p>Inspect <em style="color: green">basp.pbte</em>. Note in particular this text connected with the Pb atom:</p><pre><code>    PZ= 0 0 15.934
</code></pre><p><strong style="color: blue">lmfa</strong> is suggesting that the Pb 5_d_ state is shallow enough that it be included in the valence. Since this state is far removed from the fermi level, we would badly cover the hilbert space spanned by Pb 6_d_ state were we to use Pb 5_d_ as the valence partial wave. (In a linear method you are allowed to choose a single energy to construct the partial wave; it is usually the “valence” state, which is near the Fermi level.)</p> <p>This problem is resolved with local orbitals : these are partials wave at an energy far removed from the Fermi level. The three numbers following <strong>PZ</strong> correspond to specifications for local orbitals in the <em>s</em>, <em>p</em>, and <em>d</em> channels. Zero indicates “no local orbital;” there is only a <em>d</em> orbital here.</p> <p><strong>15.934</strong> is actually a compound of <strong>10</strong> and the “<a href="/docs/code/asaoverview/#augmentation-sphere-boundary-conditions-and-continuous-principal-quantum-numbers">continuous principal quantum number</a>” <strong>5.934</strong>. The 10’s digit tells <strong style="color: blue">lmf</strong> to use an “enhanced” local orbital as opposed to the usual variety found in most density-functional codes. Enhanced orbitals append a tail so that the density from the orbital spills into the interstitial. You can specify a “traditional” local orbital by omitting the 10, but this kind is more accurate, and there is no advantage to doing so.</p> <p>The continuous principal quantum number (<strong>5.934</strong>) specifies the <a href="/docs/code/asaoverview/#augmentation-sphere-boundary-conditions-and-continuous-principal-quantum-numbers">number of nodes and boundary condition</a>. The large fractional part of <em>P</em> is <a href="/docs/code/asaoverview/#continuous-principal-quantum-number-for-core-levels-and-free-electrons">large for core states</a>, typically around 0.93 for shallow cores. <strong style="color: blue">lmfa</strong> determines the proper value for the atomic potential. In the self-consistency cycle the potential will change and <strong style="color: blue">lmf</strong> will update this value.</p> <p><strong style="color: blue">lmfa</strong> automatically selects the valence-core partitioning; the information is given in <em style="color: green">basp.pbte</em>. You can set the partitioning manually by editing this file.</p> <p><em style="color: red">Note:</em> high-lying states can also be included as local orbitals; they improve on the hilbert space far above the Fermi level. In the LDA they are rarely needed and <strong style="color: blue">lmfa</strong> will not add them to the <em style="color: green">basp.pbte</em>. But they can sometimes be important in <em>GW</em> calculations, since in contrast to the LDA, unoccupied states also contribute to the potential.</p> <p></div></p> <h5 id="valence-core-partitioning-of-the-free-atomic-density">4.2 Valence-core partitioning of the free atomic density</h5> <!-- /tutorial/lmf/lmf_pbte_tutorial/#4.2-valence-core-partitioning-of-the-free-atomic-density/ --> <p>After <em style="color: green">basp.pbte</em> has been modified, you must run <strong style="color: blue">lmfa</strong> a second time</p><pre><code>$ lmfa ctrl.pbte
</code></pre><p>This is necessary whenever the valence-core partitioning changes through the addition or removal of a local orbital.</p> <h5 id="relativistic-core-levels">Relativistic core levels</h5> <!-- /tutorial/lmf/lmf_pbte_tutorial/#relativistic-core-levels/ --> <p>Normally <strong style="color: blue">lmfa</strong> determines the core levels and core density from the scalar Dirac equation. However there is an option to use the full Dirac equation.</p> <div onclick="elm = document.getElementById('diraccore'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> Click here to about calculating core levels from the Dirac equation.</div> <p><div style="display:none;padding:0px;" id="diraccore"></p> <p>Tag <strong>HAM_REL</strong> controls how the Questaal package manages different levels of relativistic treatment. Run <code>lmfa --input</code> and look for <strong>HAM_REL</strong>. You should see:</p><pre><code> HAM_REL                opt    i4       1,  1     default = 1
   0 for nonrelativistic Schr&amp;ouml;dinger equation
   1 for scalar relativistic Schr&amp;ouml;dinger equation
   2 for Dirac equation (ASA only for now)
   10s digit 1: compute core density with full Dirac equation
   10s digit 2: Like 1, but neglect coupling (1,2) pairs in 4-vector
</code></pre><p>Set <strong>HAM_REL=11</strong> to make <strong style="color: blue">lmfa</strong> calculate the core levels and core density with the full Dirac equation.</p> <p>You might want to see the core level eigenvalues; they can shift significantly relative to the scalar Dirac solution. Also, <em>l</em> is no longer a good quantum number so there can be multiple eigenvalues connected with the scalar Dirac <em>l</em>. To see these levels, invoke <strong style="color: blue">lmfa</strong> with a sufficiently high verbosity. In the present instance insert <strong>HAM REL=11</strong> into <em style="color: green">ctrl.pbte</em> and do</p><pre><code>$ lmfa --pr41 ctrl.pbte
</code></pre><p>You should see the following table:</p><pre><code> Dirac core levels:
 nl  chg    &lt;ecore(S)&gt;     &lt;ecore(D)&gt;     &lt;Tcore(S)&gt;     &lt;Tcore(D)&gt;   nre
 1s   2   -6461.412521   -6461.420614    9160.575645    9160.568216   439
 ec(mu)   -6461.420614   -6461.420614
 2s   2   -1154.772794   -1154.777392    2201.484620    2201.485036   473
 ec(mu)   -1154.777392   -1154.777392
 3s   2    -277.137428    -277.136313     700.148783     700.160432   501
 ec(mu)    -277.136313    -277.136313
 4s   2     -62.683976     -62.678557     231.671152     231.686270   531
 ec(mu)     -62.678557     -62.678557
 5s   2     -10.589828     -10.580503      60.826909      60.833608   567
 ec(mu)     -10.580503     -10.580503
 2p   6    -990.094400   -1001.984462    1702.510726    1772.365432   475
 ec(mu)    -948.389636   -1109.174115    -948.389636   -1109.174115    -948.389636    -948.389636
 3p   6    -229.993746    -232.623198     568.649082     585.156080   505
 ec(mu)    -220.667558    -256.534478    -220.667558    -256.534478    -220.667558    -220.667558
 4p   6     -47.246014     -47.902771     184.751871     189.523363   537
 ec(mu)     -44.969950     -53.768412     -44.969950     -53.768412     -44.969950     -44.969950
 5p   6      -6.300710      -6.422904      43.507054      44.670581   577
 ec(mu)      -5.869706      -7.529300      -5.869706      -7.529300      -5.869706      -5.869706
 3d  10    -182.032939    -182.146340     501.452676     502.171493   509
 ec(mu)    -179.091564    -186.728504    -179.091564    -186.728504    -179.091564    -186.728504    -179.091564    -186.728504    -179.091564    -179.091564
 4d  10     -29.432703     -29.453418     150.979227     151.198976   545
 ec(mu)     -28.796634     -30.438595     -28.796634     -30.438595     -28.796634     -30.438595     -28.796634     -30.438595     -28.796634     -28.796634
 5d  10      -1.566638      -1.562069      23.907636      23.945913   605
 ec(mu)      -1.485638      -1.676716      -1.485638      -1.676716      -1.485638      -1.676716      -1.485638      -1.676716      -1.485638      -1.485638
 4f  14      -9.755569      -9.751307     117.412788     117.457023   569
 ec(mu)      -9.592725      -9.962749      -9.592725      -9.962749      -9.592725      -9.962749      -9.592725      -9.962749      -9.592725      -9.962749      -9.592725      -9.962749      -9.592725      -9.592725

 qcore(SR) 78.000000  qcore(FR)  78.000000  rho(rmax)  0.00000
 sum ec :    -25841.9031 (SR)    -25934.9233 (FR) diff       -93.0203
 sum tc :     48113.1010 (SR)     48677.3220 (FR) diff       564.2210
</code></pre><p>The scalar Dirac Pb 5_d_ eigenvalue (<strong>-1.566638 Ry</strong>) gets split into 6 levels with energy <strong>-1.485638 Ry</strong> and four with <strong>-1.676716 Ry</strong>. The mean (<strong>-1.56207 Ry</strong>) is close to the scalar Dirac value. In the absence of a magnetic field a particular <em>l</em> will split into two distinct levels with degeneracies 2_l_ and 2_l_+2, respectively.</p> <p>The bottom part of the table shows how much the free atom’s total energy changes as a consequence of the fully relativistic Dirac treatment.</p> <p></div></p> <h5 id="automatic-determination-of-basis-set">4.3 Automatic determination of basis set</h5> <!-- /tutorial/lmf/lmf_pbte_tutorial/#automatic-determination-of-basis-set --> <p><strong style="color: blue">lmfa</strong> automatically generates parameters for the basis set, including</p> <ul> <li>finding estimates for parameters <strong>RSMH</strong> and <strong>EH</strong> that define the shape of envelope functions</li> <li>finding suitable <a href="/docs/code/asaoverview/#augmentation-sphere-boundary-conditions-and-continuous-principal-quantum-numbers">boundary conditions</a> for linearization energies</li> <li>deciding on which high-lying cores should be included as local orbitals</li> </ul> <div onclick="elm = document.getElementById('lmfaoutput'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"> Click here for an interpretation of lmfa's output, and how it determines the parameters outlined above</div> <p><div style="display:none;padding:0px;" id="lmfaoutput"></p> <p><strong style="color: blue">lmfa</strong> loops over each species, generating a self-consistent density from the charges given to it. Core levels are assumed to be filled; you supply the charges of the valence <em>s</em>, <em>p</em>, … orbitals. The Pb atom, for example has atomic configuration of <script type="math/tex">s^2p^2d^{10}</script> and <strong style="color: blue">lmfa</strong>’s printout for Pb begins with:</p><pre><code> Species Pb:  Z=82  Qc=68  R=3.044814  Q=0
 mesh:   rmt=3.044814  rmax=47.629088  a=0.025  nr=497  nr(rmax)=607
  Pl=  6.5     6.5     5.5     5.5     5.5    
  Ql=  2.0     2.0     10.0    0.0     0.0    

  iter     qint         drho          vh0          rho0          vsum     beta
    1   82.000000   2.667E+04      410.0000    0.4078E+03     -164.7879   0.30
   55   82.000000   4.614E-05     1283.9616    0.3612E+08     -309.4131   0.30
</code></pre><p>The first lines show the augmentation radius and radial mesh parameters. It uses a shifted logarithmic mesh: point <em>i</em> has a radius</p> <script type="math/tex; mode=display">r_i = b[exp^{a(i-1)}-1]</script> <p>The <strong>Pl</strong> are the <a href="/docs/code/asaoverview/#boundary-conditions-and-continuous-principal-quantum-numbers">continuous principal quantum numbers</a>. Note that because 5_d_ states are included in the valence through local orbitals, it treats the 5_d_ as valence with 10 electrons.</p> <p>You can specify the charges <strong>Ql</strong> in the ctrl file; if you do not it has a lookup table of default values for every atom.</p> <p>The <strong>Ql</strong> and the boundary condition (wave function decays exponentially as <i>r</i>→∞) are sufficient to completely determine the charge density.</p> <p><strong style="color: blue">lmfa</strong> starts with a crude guessed density and after 55 iterations converges to the self-consistent one.</p> <p>Next follow information about the eigenvalues of the valence and core states it finds along with some additional information, such as what fraction of the state falls outside the augmentation radius.</p><pre><code> valence:      eval       node at      max at       c.t.p.   rho(r&gt;rmt)
   6s      -0.91143         1.014       1.961       2.814     0.168779
   6p      -0.27876         1.185       2.643       4.790     0.524423
   5d      -1.56879         0.523       1.073       2.252     0.007786
...

 core:        ecore       node at      max at       c.t.p.   rho(r&gt;rmt)
   1s   -6465.77343         0.000       0.010       0.022     0.000000
   2s   -1155.91509         0.020       0.057       0.090     0.000000
...
   5p      -6.31315         0.486       0.882       1.314     0.000052
</code></pre><p>For Pb 5_d_, <strong>0.007786</strong> electrons spill out: this is on the ragged edge of whether it needs to be included as a local orbital (see Additional Exercises). <em style="color: red">Note:</em> for <em>GW</em> calculations this state is too shallow to be treated as a core.</p> <p>Next <strong style="color: blue">lmfa</strong> finds parameters related to the local orbitals: what shape of envelope function is needed to fit the tail (<strong>Eh</strong> and <strong>Rsm</strong>), the “continuous principal quantum number” <strong>Pnu</strong>, and finally an estimate for plane wave cutoff <strong>Gmax</strong> that will be needed for the density mesh.</p><pre><code> Fit local orbitals to sm hankels, species Pb, rmt=3.044814
 l   Rsm    Eh     Q(r&gt;rmt)   Eval      Exact     Pnu     K.E.   fit K.E.  Gmax
 2  1.041 -1.083   0.00792  -1.56878  -1.56879   5.934  -0.8111  -0.8111    7.8
</code></pre><p>Next <strong style="color: blue">lmfa</strong> finds corresponding parameters for the valence envelope functions. This constitutes a reasonable (but not optimal) guess for the shape of crystal envelope functions.</p><pre><code> Make LMTO basis parms for species Pb to lmxb=3, rmt=3.0448  vbar=0
 l  it    Rsm       Eh        Eval      Exact     Pnu    Ql   Gmax
 0  30   1.803   -0.706    -0.91141  -0.91143    6.89   2.00   3.9
 1  18   2.024   -0.160    -0.27825  -0.27876    6.81   2.00   3.6
 2   1   2.030+  -0.100+   -0.11512   0.01352    6.24  10.00
 3   1   2.030+  -0.100+    0.20219   0.02051    5.18   0.00
</code></pre><p>The basis data for the valence and local orbitals is later written to the basp0 file.</p> <p>It searches for core states which are shallow enough to be treated as local orbitals, using the core energy and charge spillout as criteria.</p><pre><code> Find local orbitals which satisfy E &gt; -2 Ry  or  q(r&gt;rmt) &gt; 5e-3
 l=2  eval=-1.569  Q(r&gt;rmt)=0.0078  PZ=5.934  Use: PZ=15.934
 l=3  eval=-9.796  Q(r&gt;rmt)=3e-8  PZ=4.971  Use: PZ=0.000
</code></pre><p>We had already specified that the Pb 5_d_ as a local orbital, information obtained from a prior run. <strong style="color: blue">lmfa</strong> uses this information to appropriately partition the valence and core densities.</p> <p>As a last step it fits the valence and core densities to a linear combination of smooth Hankel functions. This information will be used to overlap free-atomic densities to obtain a trial starting density.</p> <p></div></p> <p>After looping over all species <strong style="color: blue">lmfa</strong> writes basis information to <em style="color: green">basp0.pbte</em>, atomic charge density data to file <em style="color: green">atm.pbte</em>, and exits with the following printout:</p><pre><code> FREEAT:  estimate HAM_GMAX from RSMH:  GMAX=4.3 (valence)  7.8 (local orbitals)
</code></pre><p>This is the <em>G</em> cutoff <strong>gmax</strong> that the ctrl file needs in the next section. It determines the mesh spacing for the charge density.</p> <h4 id="self-consistency">5. <em>Self consistency</em></h4> <!-- /tutorial/lmf/lmf_pbte_tutorial/#self-consistency --> <p>We are almost ready to carry out a self-consistent calculation. It proceeds in a manner <a href="/tutorial/lmf/lmf_tutorial/#tutorial">similar to the basic tutorial</a>. Try the following:</p><pre><code>$ lmf ctrl.pbte
</code></pre><p><strong style="color: blue">lmf</strong> stops with this message:</p><pre><code> Exit -1 bzmesh: illegal or missing k-mesh
</code></pre><p>We haven’t yet specified a k mesh: You must supply it yourself since there are too many contexts to supply a sensible default value. In this case a k-mesh of 6×6×6 divisions is adequate. With your text editor change <strong>nkabc=0</strong> in the ctrl file to <em>*nkabc=6</em>8, or alternatively assign variable <em>*nkabc</em> on the command line (which is what this tutorial will do).</p> <p>We also haven’t specified the <em>G</em> cutoff for the density mesh. <strong style="color: blue">blm</strong> does not determine this parameter automatically because it is sensitive to the selection of basis parameters, hich local orbitals are included. <strong style="color: blue">lmfa</strong> conveniently supplied that information for us, based in the shape of envelope functions it found. In this case the valence <em>G</em> cutoff is quite small (<strong>4.388</strong>), but the Pb 5_d_ local orbital is a much sharper function, and requires a larger cutoff (<strong>7.8</strong>). You must use use the larger of the two.</p> <p><em style="color: red">Note:</em> if you change the shape of the envelope funnctions you must take care that <strong>gmax</strong> is large enough. This is described in the lmf output below.</p> <p>Change variable <strong>gmax=0</strong> in the ctrl file, or alternatively add a variable to the command line. Now run</p><pre><code>$ lmf ctrl.pbte -vnkabc=6 -vgmax=7.8
</code></pre><p><strong style="color: blue">lmf</strong> should converge to self-consistency in 10 iterations. At the end of the file it prints out</p><pre><code>                ↓        ↓
 diffe(q)=  0.000000 (0.000005)    tol= 0.000010 (0.000030)   more=F
c nkabc=6 gmax=7.8 ehf=-55318.1620974 ehk=-55318.1620958
</code></pre><p>The first line prints out the change in Harris-Foulkes energy relative to the prior iteration and some norm of RMS change in the (output-input) charge density (see arrows), followed by the tolerances required for self-consistency.</p> <p>The last line prints out a table of variables you specify on the command line, and total energies from the Harris-Foulkes and Kohn-Sham functionals. Theses are different functionals but they should approach the same value at self-consistency. The <strong>c</strong> at the beginning of the line indicates that this iteration is self-consistent.</p> <h4 id="annotation-of-lmfs-output">6. <em>Annotation of lmf’s output</em></h4> <p>Click <a href="/docs/outputs/lmf_output/" title="lmf standard output">here</a> to see the <strong style="color: blue">lmf</strong>’s standard output annotated.</p> <h3 id="other-resources"><em>Other Resources</em></h3> <ol> <li> <p>An input file’s structure, and features of the programming language capability, is explained in some detail <a href="/docs/input/inputfile/">here</a>. The full syntax of categories and tokens can be found in <a href="input.pdf">this reference</a>.</p> </li> <li> <p><a href="https://lordcephei.github.io/buildingfpinput/">This tutorial</a> more fully describes some important tags the <strong style="color: blue">lmf</strong> reads. It also presents alternative ways to build input files from various sources such as the VASP <em style="color: green">POSCAR</em> file.</p> </li> <li> <p><a href="/tutorial/lmf/lmf_bi2te3_tutorial/">This tutorial</a> more fully explains the <strong style="color: blue">lmf</strong> basis set.<br /> There is a corresponding tutorial on the basics of a <a href="https://github.com/lordcephei/lordcephei.github.io/blob/master/pages/fptut-pbte.md">self-consistent ASA calculation for PbTe</a>. <a href="/docs/properties/optics/">A tutorial on optics</a> can be gone through after you have understood this one.</p> </li> <li> <p><a href="https://lordcephei.github.io/docs/lmf/overview/">This document</a> gives an overview of some of <strong>lmf</strong>’s unique features and capabilities.</p> </li> <li> <p>The theoretical formalism behind the <strong style="color: blue">lmf</strong> is described in detail in this book chapter: M. Methfessel, M. van Schilfgaarde, and R. A. Casali, ``A full-potential LMTO method based on smooth Hankel functions,’’ in <em>Electronic Structure and Physical Properties of Solids: The Uses of the LMTO Method</em>, Lecture Notes in Physics, <b>535</b>, 114-147. H. Dreysse, ed. (Springer-Verlag, Berlin) 2000.</p> </li> </ol> <h3 id="additional-exercises"><em>Additional exercises</em></h3> <p>You can try self-consistent calculations with the Pb 5_d_ in the valence as a local orbital</p> <p>Specify symops yourself</p> <p>Tetrahedron vs sampling vs fermi function</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
