<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Extremal points and calculating effective mass</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Extremal points and calculating effective mass" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/lmf/lmf_bandedge/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <h1>Extremal points and calculating effective mass</h1> </header> <hr /> <h3 class="no_toc" id="purpose"><em>Purpose</em></h3> <p>This tutorial demonstrates how to find extremal points in k-space and calcualte effective masses using the band-edge program. This is done for silicon starting from a self-consistent LDA density. Silicon is a trivial example as its extremal points are found on lines that pass through high-symmetry points. The band-edge program is particularly useful when looking for multiple extremal points that do not fall on high-symmetry lines. A more complicated example can be found in the additional exercises.</p> <hr /> <h3 id="command-summary"><em>Command summary</em></h3> <p>The tutorial starts under the heading “Tutorial”; you can see a synopsis of the commands by clicking on the box below.</p> <div onclick="elm = document.getElementById('foobar'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Commands - Click to show</button></div> <p><div style="display:none;margin:0px 25px 0px 25px;"id="foobar"></p><pre><code>$ cp lm/doc/demos/qsgw-si/{init.si,syml.si} .          #copy init and syml files to working directory
$ blm init.si --express --gmax=5 --nk=4 --nit=20       #use blm tool to create actrl and site files
$ cp actrl.si ctrl.si                                  #copy actrl to recognised ctrl prefix
$ lmfa ctrl.si; cp basp0.si basp.si                    #run lmfa and copy basp file
$ lmf ctrl.si &gt; out.lmfsc                              #make self-consistent
$ lmf --rs=1,0 -vnit=1 --band~fn=syml si               #calculate and plot bands
$ rdcmd makeplot_scott; evince fplot.ps &amp;

$ band-edge -floatmn -maxit=20 -r=.1 -band=5 -q0=0.5,0,0 si  
$ band-edge -edge2=1 -maxit=20 -r=.04 -band=5 -gtol=.0001 -q0=0.82,0,0 si 
$ band-edge -mass -alat=10.26 -r=.0005,.001,.002,.003 -band=5 -q0=0.847,0,0 si
</code></pre><p></div> <strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong>_</p> <h3 id="tutorial"><em>Tutorial</em></h3> <p>The starting point is a self-consistent LDA calculation, you may want to review the <a href="/tutorial/lmf/lmf_tutorial/">lmf tutorial for Si</a>. Run the following commands to obtain a self-consistent density:</p><pre><code>$ cp lm/doc/demos/qsgw-si/{init.si,syml.si} .          #copy init and syml files to working directory
$ blm init.si --express --gmax=5 --nk=4 --nit=20       #use blm tool to create actrl and site files
$ cp actrl.si ctrl.si                                  #copy actrl to recognised ctrl prefix
$ lmfa ctrl.si; cp basp0.si basp.si                    #run lmfa and copy basp file
$ lmf ctrl.si &gt; out.lmfsc                              #make self-consistent
$ lmf --rs=1,0 -vnit=1 --band~fn=syml si               #calculate and plot bands
$ rdcmd makeplot_scott; evince fplot.ps &amp;
</code></pre><p>Take a look at the band structure plot. The valence band maximum is at the <script type="math/tex">\Gamma</script> point while the conduction band minimum is most of the way along the line between &amp;Gamma and X. We will now use the band-edge script to accurately locate the position of the conduction band minimum and to calculate the effective mass. This is done in three steps, you first do a rough search by ‘floating’ to a point near the minimum. From here, you do a more refined search by carrying out a minimisation until the gradient is negligibly small. Lastly, you calculate the effective mass around this point.</p> <h4 id="float-to-low-energy-point">1. <em>Float to low-energy point</em></h4> <p>The band-edge script has a ‘float’ option that is useful for doing a quick search to find a low-energy (or high-energy) region of k-space. You specify a starting point, then the script creates a cluster of points around it and checks what is the lowest-energy point. It then uses the lowest-energy point as the next central point, creates a new set of points around it and again moves to the lowest-energy one. This process is repeated until the central point is the lowest-energy point.</p> <p>Let’s start at the point half-way between &amp;Gamma and X (0.5, 0.0, 0.0) and float down in energy. Run the following command:</p><pre><code>$ band-edge -floatmn -maxit=20 -r=.1 -band=5 -q0=0.5,0,0 si
</code></pre><p>The ‘floatmn’ switch specifies that you are looking for a minimum-energy point (see additional exercises for a maximum-energy point example). The ‘maxit’ switch sets the number of iterations (number of times a set of points is created), ‘r’ is a range that defines how far out the points are generated, ‘band’ is for the band considered (here conduction band since 4 electrons and spin degenerate) and lastly q0 is the starting k-point.</p><pre><code>         start iteration 1 of 20
         lmf si --band~lst=5~box=.1,n=12+o,q0=0.5,0,0 &gt; out.lmf
qnow     :     0.500000     0.000000     0.000000       0.2628584
gradient :    -0.231511     0.000000     0.000046       0.231511
q*       :     0.925046     0.000000     0.001935
use      :     0.589443     0.000000     0.044721
</code></pre><p>You should get an output similar to the above. Take a look at the line beginning with lmf, this is the command that band-edge uses to run lmf to get the energy of the cluster of points. The qnow line gives the current central k-point (0.5,0,0) and its energy in Rydbergs. The ‘use’ line prints the lowest-energy k-point from the cluster of points, this will then be used as the central point in the next iteration. The cluster of 13 k-points and their energies are printed to the bnds.si file, take a look and you will see that the point (0.589443, 0.0, 0.044721) is indeed the lowest-energy point.</p> <p>Note that the qnow energies are getting smaller as we float to a low-energy region. After 5 iterations, the following is printed: ‘cluster center is extremal point … exiting loop’. The central k-point is the lowest-energy point and the float routine is finished.</p> <h4 id="gradient-minimization">2. <em>Gradient minimization</em></h4> <p>Starting from our low-energy float point, the next step is to do a more refined search using a gradient minimization approach. Band-edge creates a new cluster of points, does a quadratic fit and then traces the gradients to a minimum point. Run the following command:</p><pre><code>$ band-edge -edge2=1 -maxit=20 -r=.04 -band=5 -gtol=.0001 -q0=0.82,0,0 si 
</code></pre><p>The ‘edge2’ part specifies what gradient minimization algorithm to use (run ‘band-edge –h’ for more information), the r is the excursion range (step size in minimization), the ‘gtol’ is the tolerance in the gradient and the q0 is the starting point that we obtained from the float step.</p> <p>The output is similar to before but now we will pay attention to the gradient line which prints the x, y and z gradient components and the last column gives the magnitude. Note how the gradient magnitude is decreasing with each step until it falls below the specified tolerance (gtol). At this point, the gradients minimization is converged and the following is printed ‘gradient converged to tolerance gtol = .0001’.</p> <h4 id="calculate-effective-mass">3. <em>Calculate effective mass</em></h4> <p>Now that we have accurately determined the conduction band minimum, we can calculate the effective mass. This is done by fitting a quadratic form to a set of points around the conduction band minimum. Run the following command:</p><pre><code>$ band-edge -mass -alat=10.26 --bin -r=.0005,.001,.002,.003 -band=5 -q0=0.8458,0,0 si
</code></pre><p>The mass refers to effective mass calculation and alat is the lattice constant (this can be found in the lmf output or in the site file). The lattice constant is needed to convert to atomic units since the code reports k-points in units of 2<script type="math/tex">\pi</script>/alat. Here, the r gives the radii of the four clusters of points around the central point. The extra points improve the accuracy of the quadratic fitting.</p> <p>The last line of the output prints the three effective mass components in atomic units. So for silicon, the effective mass is anisotropic with lighter masses in two directions and a heavier effective mass in the third direction.</p> <h3 id="additional-exercises"><em>Additional Exercises</em></h3> <p>1) Find valence band maximum and calculate effective mass</p> <p>Although we know the valence band maximum for silicon is at the &amp;Gamma point, we will use it as an example for finding a maximum point. In the float step, change the floatmn (for minimum) to floatmx (for maximum) and change the band number to 4 (for valence band). Notice the energies are going up. Now do a gradient minimization from the point you floated to, remember to change the band number to 4. The valence band maximum is in a flatter region so try using a smaller excursion radius, say 0.001. Then calculate the effective mass. Your values should be around (-0.33, -0.56, -0.88). The negative signs indicate a maximum point in all three directions.</p> <p>2) More complicated example. Find extremal points for …, they do not lie on high-symmetry lines.</p> <p>Repeat…</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
