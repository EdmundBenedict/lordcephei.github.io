<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Introductory tutorial to full-potential program lmf</title> <link rel="stylesheet" href="https://lordcephei.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://lordcephei.github.io/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="KBbEPlf44q4dfL6SBHqymelMqXBSuZHSXIo-ZfkQLbE" /> <meta name="msvalidate.01" content="0FB4C028ABCF07C908C54386ABD2D97F" /> <meta name="description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <link rel="author" href="https://plus.google.com/u/0/104386739373934968982"/> <link rel="icon" sizes="32x32" href="https://lordcephei.github.io/assets/img/favicon-32x32.png"> <link rel="icon" sizes="192x192" href="https://lordcephei.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://lordcephei.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://lordcephei.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lordcephei.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://lordcephei.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://lordcephei.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://lordcephei.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://lordcephei.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://lordcephei.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://lordcephei.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Introductory tutorial to full-potential program lmf" /> <meta property="og:description" content="Questaal is a suite of programs for LMTO and GW simulations."/> <meta property="og:url" content="https://lordcephei.github.io//tutorial/lmf/lmf_tutorial/" /> <meta property="og:site_name" content="Questaal" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://lordcephei.github.io/humans.txt" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js", "AMSmath.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true }, }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <style type="text/css"> red { color:purple; /*This changes the color of your text */ font-size:24pt; /*This changes the font size of your text */ } </style> </head> <body id="top-of-page" class="page-fullwidth"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="hide-for-large-up"> <a href="https://lordcephei.github.io"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="left"> <li class ="show-for-large-up"><a href="https://lordcephei.github.io/"> <img src="https://lordcephei.github.io/images/logo.png" style="width:125px;height:40px"></a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Functionality</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/functionality/application/">By Physical Application</a></li> <li><a href="https://lordcephei.github.io/functionality/program/">By Suite Program</a></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Documentation</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/package_overview/">Package Overview</a></li> <li><a href="https://lordcephei.github.io/docs/install/">Installation</a></li> <li class="has-dropdown"><a href="#">Description by code</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/code/fpoverview/">Full Potential Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/gwoverview/">GW Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/dmftoverview/">Dynamical Mean Field Theory</a></li> <li><a href="https://lordcephei.github.io/docs/code/asaoverview/">ASA Overview</a></li> <li><a href="https://lordcephei.github.io/docs/code/lmgf/">ASA Green's function</a></li> <li><a href="https://lordcephei.github.io/docs/code/smhankels/">Smooth Hankel Functions</a></li> <li><a href="https://lordcephei.github.io/docs/code/jpos/">Jigsaw Puzzle Orbitals</a></li> <li><a href="https://lordcephei.github.io/docs/code/cpadoc/">CPA Enhancement of the Green's function package</a></li> <li><a href="https://lordcephei.github.io/docs/code/spectral-functions/">Spectral function calculations with lmgf</a></li> </ul></li> <li class="has-dropdown"><a href="#">Input Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/input/inputfile/">The Input File</a></li> <li><a href="https://lordcephei.github.io/docs/input/preprocessor/">File Preprocessor</a></li> <li><a href="https://lordcephei.github.io/docs/input/sitefile/">The Site file</a></li> <li><a href="https://lordcephei.github.io/docs/input/symfile/">Symmetry Line Files</a></li> </ul></li> <li class="has-dropdown"><a href="#">Annotated Output Files</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/outputs/lmf_output/">lmf standard output</a></li> </ul></li> <li class="has-dropdown"><a href="#">Command Line Options</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/commandline/general/">General</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lmf/">lmf</a></li> <li><a href="https://lordcephei.github.io/docs/commandline/lm/">lm</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Properties</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/properties/optics/">Optics</a></li> </ul></li> <li class="has-dropdown"><a href="#">Auxilliary tools</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/docs/misc/plbnds/">The plbnds tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pldos/">The pldos tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/fplot/">The fplot tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/mccalcdoc/">The mc calculator</a></li> <li><a href="https://lordcephei.github.io/docs/misc/pfitdoc/">The pfit tool</a></li> <li><a href="https://lordcephei.github.io/docs/misc/ccomp/">The ccomp processor</a></li> <li><a href="https://lordcephei.github.io/docs/misc/integerlists/">Integer list syntax</a></li> <li><a href="https://lordcephei.github.io/docs/misc/rotations/">Specifying rotations</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class="has-dropdown"> <a href="https://lordcephei.github.io">Tutorials</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/importing_input/">Importing Input files</a></li> <li class="has-dropdown"><a href="#">lmf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_tutorial/">Basic Tutorial for Full-Potential lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_pbte_tutorial/">Self-consistent density in PbTe</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bi2te3_tutorial/">Properties of the lmf basis set</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpnew/">Elastic constant in Al</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fpoptbas/">lmf Basis Set Optimisation</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/pdos/">Generating a Partial DOS</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/mulliken/">Performing Mulliken Analysis</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/fermisurface/">Generating a Fermi Surface</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/cls/">Performing Core Level Spectroscopy</a></li> <li><a href="https://lordcephei.github.io/tutorial/lmf/lmf_bandedge/">Extremal points and calculating effective mass</a></li> </ul></li> <li class="has-dropdown"><a href="#">ASA</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/asa/lm_pbte_tutorial/">LM Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">GW</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/gw/poscar_qsgw/">POSCAR to QSGW</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_si/">Basic QSGW Tutorial: Si</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/qsgw_fe/">QSGW Tutorial for Fe</a></li> <li><a href="https://lordcephei.github.io/tutorial/gw/gw_self_energy/">The GW Self-energy and Spectral Function</a></li> </ul></li> <li class="has-dropdown"><a href="#">lmgf</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/lmgf/lmgf">LMGF Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">qsgw + dmft</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft0/">Introduction</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft1/">Setting up the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft2/">Running the DMFT loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft3/">Issues with input and parameters</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft4/">Charge + static-magnetic contributions</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft5/">The density loop</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/maxent1/">The maximum entropy method</a></li> <li><a href="https://lordcephei.github.io/tutorial/qsgw_dmft/dmft7/">The self-energy loop and the dynamical double-counting</a></li> </ul></li> <li class="has-dropdown"><a href="#">tbe</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/tbe/tbectrl">TBE Tutorial</a></li> </ul></li> <li class="has-dropdown"><a href="#">Physical Application</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/application/optics/">Optics using lm and lmf</a></li> <li><a href="https://lordcephei.github.io/tutorial/application/fstut/">Making a Fermi surface</a></li> </ul></li> <li class="has-dropdown"><a href="#">Miscellaneous</a> <ul class="dropdown"> <li><a href="https://lordcephei.github.io/tutorial/misc/extbfield/">Adding external Zeeman field to the potential</a></li> </ul></li> </ul> </li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/formatting/">Site Contribution</a></li> <li class="divider"></li> <li class=""><a href="https://lordcephei.github.io/developers/">Developers</a></li> <li class="divider"></li> </ul> <ul class="right"> <li class="divider"></li> <li><a href="https://lordcephei.github.io/search/">Search</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/contact/">Contact</a></li> <li class="divider"></li> <li><a href="https://lordcephei.github.io/about/">About</a></li> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-12 columns"> <article> <header> <h1>Introductory tutorial to full-potential program lmf</h1> </header> <hr /> <h3 class="no_toc" id="purpose"><em>Purpose</em></h3> <p>This tutorial covers the basics for running a self consistent LDA calculation for silicon. The goal is to introduce you to the different file types and the basics of running the code.</p> <hr /> <h3 id="command-summary"><em>Command summary</em></h3> <p>The tutorial starts under the heading “Tutorial”; you can see a synopsis of the commands by clicking on the box below.</p> <div onclick="elm = document.getElementById('foobar'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';"><button type="button" class="button tiny radius">Commands - Click to show</button></div> <p><div style="display:none;margin:0px 25px 0px 25px;"id="foobar"></p><pre><code>$ mkdir si; cd si                               #create working directory and move into it
$ nano init.si                                  #copy and paste init file from box   
$ blm init.si --express                         #use blm tool to create actrl and site files
$ cp actrl.si ctrl.si                           #copy actrl to recognised ctrl prefix
$ lmfa ctrl.si                                  #use lmfa to make basp file, atm file and to get gmax
$ cp basp0.si basp.si                           #copy basp0 to recognised basp prefix   
$ nano ctrl.si                                  #set iterations number nit, k mesh nkabc and gmax
$ lmf ctrl.si &gt; out.lmfsc                       #make self-consistent
</code></pre><p></div></p> <hr /> <h3 id="preliminaries"><em>Preliminaries</em></h3> <p>Executables <strong style="color: blue">blm</strong>, <strong style="color: blue">lmfa</strong>, and <strong style="color: blue">lmf</strong> are required and are assumed to be in your path. The source code for all Questaal executables can be found <a href="https://bitbucket.org/lmto/lm">here</a>.</p> <hr /> <h3 id="tutorial"><em>Tutorial</em></h3> <p>To get started, create a new working directory and move into it; here we will call it “si”.</p><pre><code>$ mkdir si 
$ cd si
</code></pre><p>Now cut and paste the contents of the box below to <em style="color: green">init.si</em>.</p><pre><code># Init file for Silicon
LATTICE
   SPCGRP=227
   A=5.43 UNITS=A
SITE
   ATOM=Si X=0 0 0
</code></pre><p>Si forms in the diamond cubic structure, space group 227 as you can readily determine from, e.g. <a href="http://www.periodictable.com/Properties/A/SpaceGroupNumber.html">this web page</a>. Space group 227 is Fd-3m which has an underlying fcc Bravais lattice. The init file equally allows you to supply the space group as <strong>SPCGRP=Fd-3m</strong>, or supply the lattice vectors directly, with a token <strong>PLAT</strong>, <em>viz</em></p><pre><code>  PLAT=  0.0    0.5    0.5
         0.5    0.0    0.5
         0.5    0.5    0.0
</code></pre><p>Lattice vectors are given in Cartesian coordinates in units of the lattice constant <strong>A</strong>. You supply them in row format (i.e. the first row contains the x, y and z components of the first lattice vector and so forth). <strong>UNITS=A</strong> tells <strong style="color: blue">blm</strong> that <strong>A</strong> is in Å. If you do not specify the units, <strong>A</strong> is given in atomic units. (Questaal uses Atomic Rydberg units.)</p> <p>Lattice vectors, lattice constant and the position of the basis vectors place in <strong>SITE</strong> is all that is needed to fix the structural information. Atomic numbers for each atom is inferred from the symbol (Si). Token <strong>X=</strong> specifies that the coordinates are in “direct” representation, that is, as fractional multiples of lattice vectors. It doesn’t matter in this case, but you can use Cartesian coordinates : use <strong>POS=</strong> instead of <strong>X</strong> (see additional exercises below). In such a case positions are given in Cartesian coordinates in units of <strong>ALAT</strong>. So are the lattice vectors, if you supply them instead of the space group number.</p> <p>In order to run the DFT program <strong style="color: blue">lmf</strong>, you need an input file along with structural information. The <strong style="color: blue">blm</strong> tool read the init file as input and creates a template input file <em style="color: green">actrl.si</em> and structure file <em style="color: green">site.si</em>. The Questaal package recognises certain names as file types (such as “ctrl” for input file and “site” for structure file). <strong style="color: blue">blm</strong> writes <em style="color: green">actrl.si</em> rather than <em style="color: green">ctrl.si</em> to prevent overwriting of an existing ctrl file. Extension “si” labels the materials system; it is something you choose. Most files read by or generated by Questaal programs will append this extension.</p> <p>Run <strong style="color: blue">blm</strong> as shown below and then copy the template file <em style="color: green">actrl.si</em> to <em style="color: green">ctrl.si</em>, which is the name of the main input file recognised by most codes in the Questaal package. The <code>--express</code> switch tells <strong style="color: blue">blm</strong> to make a particularly simple input file; we will see more complicated examples in later tutorials. <code>--nit=1</code> causes <strong style="color: blue">blm</strong> to limit the self-consistency cycle to 1 iteration. We will return to this shortly.</p><pre><code>$ blm init.si --express --nit=1
$ cp actrl.si ctrl.si
</code></pre><p>The start of the <strong style="color: blue">blm</strong> output shows some structural and symmetry information. Further down, the “makrm0:” part gives information about creating the augmentation spheres, both silicon atoms were assigned spheres of radii 2.22 Bohr. Now open up the site file and you can see it contains the lattice constant and lattice vectors in the first line. Note that the lattice constant has been converted from Angstroms to Bohr since the code works in atomic units. The other terms in the first line are just standard settings and a full explanation can be found in the online page for the site file. The second line is a comment line and the subsequent lines contain the atomic species labels and coordinates. Note that <strong style="color: blue">blm</strong> writes Cartesian coordinates by default (they happen to be the same as fractional coordinates in this case) and that running <strong style="color: blue">blm</strong> produces a new actrl and site file each time.</p> <p>Next take a look at the input file <em style="color: green">ctrl.si</em>.</p><pre><code>$ nano ctrl.si
</code></pre><p>The first few lines are just header information, then you have a number of basic parameters for a calculation. We won’t talk about these values now but a full description is provided on the ctrl file page. Defaults are provided by <strong style="color: blue">blm</strong> for most of the variables except <strong>gmax</strong> and <strong>nkabc</strong>, which are left as “NULL”. The “nkabc” specifies the k mesh. There is no sensible way for blm to select a default value, as it depends on the bandgap or details of the Fermi surface, and also the precision needed for the physical property you need. The “gmax” value specifies how fine a real space mesh is used for the interstitial charge density and this depends on the basis set as described below.</p> <p>We now need a basis set, which will give us an estimate for <strong>gmax</strong>. This can done automatically by using the <strong style="color: blue">lmfa</strong> tool. <strong style="color: blue">lmfa</strong> also calculates free atom wavefunctions and densities. The latter will be used later to make a trial density for the crystal calculation; the free atom wavefunctions are used to fit the basis set parameters. Note that in the all electron approach, space is partitioned in two kinds of regions: an augmentation sphere part (around each atom) and an interstitial part (region between spheres). In the augmentation spheres, the basis set is composed of local atomic functions, tabulated numerically. In the interstitial regions, the basis consists of analytic, smooth-Hankel functions, characterised by their smoothing radius (<strong>RSMH</strong>) and Hankel energies (<strong>EH</strong>). The number of interstitial functions and their parameters (<strong>RSMH</strong> and <strong>EH</strong>) are defined in the basp file (the size of which is determined by parameters in the ctrl file). There are a few more subtleties to the code’s basis set but we will leave further details to the theory pages and the input file pages. Run the following command:</p><pre><code>$ lmfa ctrl.si
</code></pre><p>Again the output shows some structural information and then details about finding the free atom density, basis set fitting and, at the end an estimate of <strong>gmax</strong> is printed out. Note that the Barth-Hedin exchange-correlation functional is used, as indicated by “XC:BH”, this was specified by “<strong>xcfun</strong>=2” in the ctrl file (the default). We won’t go into more detail now, but a full description can be found on the <strong style="color: blue">lmfa</strong> page. One thing to note is a recommended value for <strong>gmax</strong> given towards the end: “GMAX=5.0”. Now that we have a gmax value, open up the ctrl file and change the default NULL value to 5.0.</p><pre><code>$ nano ctrl.si
</code></pre><p>Alternatively, you can supply the information through <strong style="color: blue">blm</strong>. We will do this here to avoid the need to edit the file. Run blm with an extra argument and compare to the original ctrl file:</p><pre><code>$ blm init.si --express --nit=1 --gmax=5
$ diff actrl.si ctrl.si
</code></pre><p>The last switch enables blm to use a value for <strong>gmax</strong>.</p> <p>Check the contents of your working directory and you will find two new files <em style="color: green">atm.si</em> and <em style="color: green">basp0.si</em> . <em style="color: green">atm.si</em> contains the free atom densities calculated by <strong style="color: blue">lmfa</strong>. File <em style="color: green">basp0.si</em> is the template basis set file; the standard basis set name is basp and the extra 0 is appended to avoid overwriting. Take a look at <em style="color: green">basp0.si</em> and you will see that it contains basis set parameters that define silicon’s smooth Hankel functions. Changing these values would change their functional form, but <strong style="color: blue">lmfa</strong> does a reasonable job (also later on parameters can be automatically optimized, if desired) so we will leave them as they are. Copy <em style="color: green">basp0.si</em> to <em style="color: green">basp.si</em>, which is the name <strong style="color: blue">lmf</strong> recognises for the basis set file</p><pre><code>$ cp basp0.si basp.si
</code></pre><p>The second unknown parameter is the k-mesh. A 4x4x4 k mesh is sufficient for Si. Set this value in your text editor by simply changing “nkabc=NULL” to “nkabc=4” (4 is automatically used for each mesh dimension, you could equivlaently use “nkabc=4 4 4”). Take a look at the last line, it contains information about the different atoms in the system (here we only have silicon) and their associated augmentation spheres.</p><pre><code>$ nano ctrl.si
</code></pre><p>You can also supply the information through <strong style="color: blue">blm</strong> with a switch. Compare the effect of this new switch:</p><pre><code>$ blm init.si --express --nit=1 --gmax=5 --nk=4
$ diff actrl.si ctrl.si
</code></pre><p>Whichever way you supply <strong>gmax</strong> and <strong>nk</strong> to the ctrl file, it should now have no NULL entries and we now have everything we need to run an all-electron, full-potential DFT calculation. This is done using the <strong style="color: blue">lmf</strong> program. Double check that you have specified the k mesh (nkabc) and a gmax value and then run the following command:</p><pre><code>$ lmf ctrl.si
</code></pre><p>The first part of the output is similar to what we’ve seen from the other programs. Look for the line beginning with “lmfp”, it should be around 60 lines down. This line tells us about what input density is used. <strong style="color: blue">lmf</strong> first looks for a restart file <em style="color: green">rst.si</em> and if it’s not found it then looks for the free atom density file <em style="color: green">atm.si</em>. <strong Style="Color: Blue">lmf</strong> then overlaps the free atom densities to form a trial density (Mattheis construction) and this is used as the input density. Next <strong style="color: blue">lmf</strong> begins the first iteration of a self-consistent cycle: calculate the potential from the input density, use this potential to solve the Kohn-Sham equations and then perform Brillouin zone integration to get the output density. Towards the end of the output, the Kohn-Sham total energy is reported along with the Harris-Foulkes total energy. These two energies will be the same at self-consistency (or very close at near self-consistency). Note that the calculation stopped here after a single iteration. This is because the number of iterations <strong>nit</strong> was set to 1 by blm, because –nit=1 was given. Now increase the number of iterations to something like 20 and run <strong style="color: blue">lmf</strong> again. A lot of text is produced so it will be easier to redirect the output to a file, here we call it <em style="color: green">out.lmfsc</em> (appending sc to indicate a self-consistent cycle).</p><pre><code>$ nano ctrl.si
$ lmf ctrl.si &gt; out.lmfsc
</code></pre><p>Now take a look at the output file <em style="color: green">out.lmfsc</em>. Look for the line beginning with “iors”, again around line 60</p><pre><code> iors  : read restart file (binary, mesh density) 
         use from  restart file: ef window, positions, pnu 
         ignore in restart file: *
</code></pre><p>This time the rst file was found and the density is used as the input density (the rst file was created after the single iteration). Now move to the end of the file. The ‘<strong>c</strong>’ in front of the Harris Foulkes <strong>ehf</strong> and Kohn-Sham <strong>ehk</strong> energies indicates that convergence was reached (note how similar the ehf and ehk energies are). A few lines up you can see that it took 8 iterations to converge: look for “<strong>it 8 of 20</strong>”. At the end of each iteration the ehf and ehk total energies are printed and a check is made for self-consistency. The two parameters <strong>conv</strong> and <strong>convc</strong> in the ctrl file specify, respectively, the self-consistency tolerances for the total energy and root mean square (RMS) change in the density. Note that by default both tolerances have to be met. To use a single tolerance you simply set the one that you don’t want to zero.</p> <p>Further up again the Fermi energy and band gap values, and other key bits of information are reported in the Brillouin zone integration section. You should find something similar to the output snippet below.</p><pre><code> BZWTS : --- Tetrahedron Integration ---
 ... only filled or empty bands encountered:  ev=0.185509  ec=0.229539
 VBmax = 0.185509  CBmin = 0.229539  gap = 0.044029 Ry = 0.59880 eV
 BZINTS: Fermi energy:      0.185518;   8.000000 electrons;  D(Ef):    0.000
         Sum occ. bands:   -1.4864297  incl. Bloechl correction:    0.000000
</code></pre><p>To see how the density and energy changes between iterations, try grepping for “DQ” and “ehk=-“</p><pre><code>$ grep 'DQ' out.lmfsc
$ grep 'ehk=-' out.lmfsc
</code></pre><p>You can also check how the bandgap changes as iterations proceed to self-consistency by grepping <em style="color: green">out.lmfsc</em> for ‘gap’.</p> <p>And that’s it! You now have a self-consistent density and have calculated some basic properties such as the band gap and total energy. Other tutorials to look at are those to generate energy band structures, and density-of-states, or calculate a mechanical property such as the optical mode frequency.</p> <hr /> <h3 id="other-resources"><em>Other Resources</em></h3> <p>This <a href="/tutorial/lmf/lmf_pbte_tutorial/">tutorial on PbTe</a> also covers the basic self-consistency cycle, in a bit more detail. It has has companion <a href="/tutorial/asa/lm_pbte_tutorial/">tutorial for the ASA</a>, allowing you to compare the FP and ASA methods. There is <a href="https://lordcephei.github.io/buildingfpinput/">a more detailed tutorial</a> with some description of important tags the <strong style="color: blue">lmf</strong> reads, and of the <strong style="color: blue">lmf</strong> basis set.</p> <p>For a tutorial showing a self-consistent calculation of ferromagnetic metal, see <a href="xx">this tutorial</a>. <a href="xxx">This tutorial</a> shows how to calculate optical properties for PbTe. See <a href="xx">this tutorial</a> for the calculation of the optical mode frequency in Si. <a href="xxx">This document</a> gives an overview of the lmf implementation; the formalism behind the method is described in this <a href="xx">book chapter</a>.</p> <hr /> <h3 id="faq"><em>FAQ</em></h3> <p>Below is a list of frequently asked questions. Please get in contact if you have other questions.</p> <p>1) How does <strong style="color: blue">blm</strong> determine the augmentation sphere radii?</p> <p>Overlaps free atom densities and looks for where potential is flat.</p> <p>2) What is the log file?</p> <p>The log file <em style="color: green">log.si</em> keeps a compact record of key outputs in the current directory. In successive runs, data is appended to the log file.</p> <p>3) What is the Harris-Foulkes energy?</p> <p>It is a functional of the input density, rather than the output density. At self-consistency it should be the same as the standard Kohn-Sham functional. The Harris-Foulkes functional tends to be more stable, and like the Kohn-Sham functional, it is stationary at the self-consistent density. But it is not necessarily a minimum there. See <a href="http://dx.doi.org/10.1103/PhysRevB.39.12520">this paper</a> by M. Foulkes and R. Haydock.</p> <hr /> <h3 id="additional-exercises"><em>Additional Exercises</em></h3> <p>1) Converting between fractional and Cartesian coordinates</p> <p>For example, try running the command “blm init.si –express –wsitex” and you will see that <strong>xpos</strong> has been added to the first line of <em style="color: green">site.si</em>; this indicates that the coordinates are now in fractional form. Note that in this case the Cartesian and fractional coordinates happen to be the same.</p> <p>2) The bandgap printed out by the code is not the actual LDA gap, but the smallest separation between the highest occupied and lowest unoccupied state it found on a discrete 4x4x4 k mesh. The actual minimum occurs near k=(1,0,0), commonly referred to as the X point. The X point is on the 4x4x4 k-mesh, but the conduction band minimum itself is not quite at X. Rerun the calculation with a very fine k mesh (not self-consistently this time) and observe that the bandgap is slightly smaller. Use your text editor to set nkabc to 12 or 16 and do:</p><pre><code>$ lmf ctrl.si --quit=rho
</code></pre><p>You should find that the gap gets smaller by about 0.13 eV, which is close to the experimentally observed splitting between the conduction minimum and the conduction band at X. There is a script that enables you to locate the position of the conduction band.</p> </article> </div><!-- /.medium-12.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> Questaal is a suite of programs for LMTO and GW simulations. <a href="https://lordcephei.github.io/info/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Services</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="services-contact" > <a href="https://lordcephei.github.io/contact/" title="Contact">Contact</a> </li> <li class="list" > <a href="https://lordcephei.github.io/developers/" title="Contact the developers">Developers</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <h5 class="shadow-black">Related websites</h5> <ul class="no-bullet shadow-black"> <li > <a href="https://lordcephei.github.io" title=""></a> </li> <li class="network-entypo" > <a href="http://lmsuite.org" target="_blank" title="">Original LM Suite</a> </li> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> </footer> <script src="https://lordcephei.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-60112281-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
